{
  "hash": "0949a0b20460072780797f0c9eebd4e1",
  "result": {
    "markdown": "\n# More Examples {#sec-more-examples}\n\n\n\n\n\n\n## Heat Exchanger Example {#sec-hxer}\n\nIn this section will discuss several parts of the statistical\nanalysis of a laboratory experiment involving a heat exchanger.\n\n\n### Apparatus and Measurements\n\n@fig-hxer shows a diagram illustrating the \nheat exchanger.  Fluids of different temperatures flow in the annulus \n($\\dot{m}_{3}$) and in the inner tube ($\\dot{m}_{1}$).\nThe entire apparatus is insulated, \nso we expect little or no heat to be exchanged with the surroundings.\n\n![Heat exchanger with statepoints.](images/HXerFig.png){#fig-hxer height=\"3.0in\"}\n\n\nMass flow rates ($\\dot{m}$) are controlled via valves.\nTwo mass flow rates ($\\dot{m}_{1}$ and $\\dot{m}_{3}$)\nare measured by rotameters.^[See \n<http://www.omega.com/prodinfo/rotameters.html>\nfor an introduction.]\nTemperatures ($T_{1}$--$T_{4}$) are measured by thermocouples.^[See \n<http://www.omega.com/techref/themointro.html> for an introduction.]\n\n\n<!-- ## Observations -->\n\nEach observation consists of four~(4) temperature measurements \nand two~(2) mass flow rate measurements. \nHere is an example data set with one set of measurements at each of 6\nexperimental conditions:\n<!-- %<<include = FALSE>>= -->\n<!-- %HeatX <- data.frame( -->\n<!-- %  trial = 1:6, -->\n<!-- %  T.cold.in = c(14.3, 14.1, 14.1, 14.2, 14.1, 14.1), -->\n<!-- %  T.cold.out = c(18.6, 18.7, 19.4, 18.4, 17.4, 16.9), -->\n<!-- %  # T.hot.in = c(38.2, 35.9, 35.9, 35.8, 35.7, 35.8), -->\n<!-- %  T.hot.in = c(38.2, 35.9, 35.9, 35.8, 35.7, 35.8), -->\n<!-- %  T.hot.out = c(33.9, 32.8, 33.4, 31.8, 30.9, 30.4), -->\n<!-- %  m.cold = c(10, 7.5, 5, 5, 7.5, 10), -->\n<!-- %  m.hot = c(10, 10, 10, 5, 5, 5) -->\n<!-- %)   -->\n<!-- %@ -->\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(fastR2)\nHeatX   \n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"trial\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"T.cold.in\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.cold.out\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.hot.in\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.hot.out\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"m.cold\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"m.hot\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"14.3\",\"3\":\"18.6\",\"4\":\"38.2\",\"5\":\"33.9\",\"6\":\"10.0\",\"7\":\"10\"},{\"1\":\"2\",\"2\":\"14.1\",\"3\":\"18.7\",\"4\":\"35.9\",\"5\":\"32.8\",\"6\":\"7.5\",\"7\":\"10\"},{\"1\":\"3\",\"2\":\"14.1\",\"3\":\"19.4\",\"4\":\"35.9\",\"5\":\"33.4\",\"6\":\"5.0\",\"7\":\"10\"},{\"1\":\"4\",\"2\":\"14.2\",\"3\":\"18.4\",\"4\":\"35.8\",\"5\":\"31.8\",\"6\":\"5.0\",\"7\":\"5\"},{\"1\":\"5\",\"2\":\"14.1\",\"3\":\"17.4\",\"4\":\"35.7\",\"5\":\"30.9\",\"6\":\"7.5\",\"7\":\"5\"},{\"1\":\"6\",\"2\":\"14.1\",\"3\":\"16.9\",\"4\":\"35.8\",\"5\":\"30.4\",\"6\":\"10.0\",\"7\":\"5\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ngf_point(m.hot ~ m.cold, data = HeatX, main = \"Experimental Configurations\", size = 3)\n```\n\n::: {.cell-output-display}\n![](10-more-examples_files/figure-html/unnamed-chunk-2-1.png){width=432}\n:::\n:::\n\n\n\n<!-- % Note: \\function{read.csv()} can read data from a file as well.  If you are using the server -->\n<!-- % version of \\RStudio\\ you first need to upload your CSV file to the server.  Look in the \\tab{Files}  -->\n<!-- % pane for the upload button to upload your own data. -->\n\n### Standardizing Units\n\nThe recorded flow rates are in L/min.  We will convert them to L/sec and use seconds as\nour standard unit of time troughout the analyses.\n\n::: {.cell}\n\n```{.r .cell-code}\nHeatX <- HeatX |>\n  mutate(\n    m.hot = m.hot / 60,\n    m.cold = m.cold / 60\n  )\n```\n:::\n\n\n\nWe could also convert temperatures to degrees Kelvin, but since temperatures only appear \nas differences between two temperatures in the expression used here, we can leave them\nin degrees Celsius.\n\n\n<!-- ### Notation -->\n\nTable @tbl-hxer-definitions contains notation and definitions of important quantities\ninvolved in the heat exchanger experiment.\n\n| Symbol           |   Definition                 | Units                       | Estimate                       |\n|------------------|------------------------------|-----------------------------|--------------------------------|\n| $\\dot{Q}$        | heat transfer rate           | $\\mathrm{W}$                |                                |\n| $\\dot{m}$        | mass flow rate               | $\\mathrm{kg}/\\mathrm{s}$    |                                |\n| $C_{p}$          | specific heat                | $\\mathrm{kJ}/(\\mathrm{kg}\\cdot\\mathrm{K})$ | $4.18 \\pm 0.1$  |\n| $T$              | temperature                  | $\\mathrm{K}$                |                                |\n| $D$              | diameter of inner tube       | $\\mathrm{m}$                | $0.0143 \\pm 0.0004$ m          |\n|                  | || ($9/16 \\pm 1/64$ inches)  |                             |                                |\n| $L$              | length of the heat exchanger | $\\mathrm{m}$                |  $1.626 \\pm 0.006$             |\n|                  |                              |                             |  ($64 \\pm 1/4$ inches)         |\n| $A$              | surface area of the inner tube ($\\pi D L$) | m$^{2}$       |                                |\n| $U$              | heat transfer coefficient    |$\\mathrm{W}/(\\mathrm{m}^{2} \\cdot \\mathrm{K})$ |              |\n| $h$\t\t           | convective heat transfer coefficient ($\\approx 2 U$) | $\\mathrm{W}/(\\mathrm{m}^2\\cdot \\mathrm{K}$) | |\n| $\\Delta T_{lm}$  | logarithmic mean temperature difference | $\\mathrm{K}$     |                                |\n| $Nu_{D}$         | Nusselt number based on $D$  | --                          |                                |\n| $Re_{D}$         | Reynolds number based on $D$ | --                          |                                |\n| $Pr$             | Prandtl number               | --                          |                                |\n| $\\mu$            | dynamic viscosity            | $\\mathrm{kg}/(\\mathrm{m} \\cdot \\mathrm{s})$ | $0.00102 \\pm 0.00001$ |\n| $k$              | water thermal conductivity   | $\\mathrm{W}/(\\mathrm{m} \\cdot \\mathrm{K})$  | $0.598 \\pm 0.004$     |\n\n: Notation for quantities involved in the heat exchanger experiment.  Note, some of the physical \"constants\" are actually temperature dependant.   In these cases, a value has been chosen that reflects the temperature range  (approx. 15--35 degrees C) seen in the data. {#tbl-hxer-definitions}\n\n\n\n\n<!-- \\iffalse -->\n<!-- \\section{Experimental plan} -->\n\n<!-- One possible experimental plan is to take data at -->\n<!-- four~(4) values of $\\dot{m_{1}}$ and two~(2) values of $\\dot{m}_{3}$, -->\n<!-- for a total of 8 observations. -->\n<!-- Repeated observations could be obtained at one combination of  -->\n<!-- $\\dot{m}_{1}$ and $\\dot{m}_{3}$. -->\n<!-- \\fi -->\n\n\n### Calculating the heat transfer, $\\dot Q$\n\nThe amount of heat exchanged between the hot and cold water can be determined\nfrom the temperature change and the mass flow rate as follows:\n\n$$\n    \\dot{Q}_{1} = \\dot{m}_{1} C_{p} (T_{2} - T_{1})\n$$ {#eq-hxer1}\n\n$$\n    \\dot{Q}_{3} = \\dot{m}_{3} C_{p} (T_{4} - T_{3})\n$$ {#eq-hxer2}\n\nWe can estimate the values of $\\dot{Q}$ from our data by direct caclulation:\n\n::: {.cell}\n\n```{.r .cell-code}\nC_p <- 4.18\nHeatX2 <- HeatX |>\n  mutate(\n    Q.cold = m.cold * C_p * (T.cold.out - T.cold.in),\n    Q.hot  = m.hot  * C_p * (T.hot.out  - T.hot.in),\n    Q.env  = Q.cold + Q.hot\n  )\nHeatX2\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"trial\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"T.cold.in\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.cold.out\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.hot.in\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.hot.out\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"m.cold\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"m.hot\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Q.cold\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Q.hot\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Q.env\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"14.3\",\"3\":\"18.6\",\"4\":\"38.2\",\"5\":\"33.9\",\"6\":\"0.16666667\",\"7\":\"0.16666667\",\"8\":\"2.995667\",\"9\":\"-2.995667\",\"10\":\"-2.220446e-15\"},{\"1\":\"2\",\"2\":\"14.1\",\"3\":\"18.7\",\"4\":\"35.9\",\"5\":\"32.8\",\"6\":\"0.12500000\",\"7\":\"0.16666667\",\"8\":\"2.403500\",\"9\":\"-2.159667\",\"10\":\"2.438333e-01\"},{\"1\":\"3\",\"2\":\"14.1\",\"3\":\"19.4\",\"4\":\"35.9\",\"5\":\"33.4\",\"6\":\"0.08333333\",\"7\":\"0.16666667\",\"8\":\"1.846167\",\"9\":\"-1.741667\",\"10\":\"1.045000e-01\"},{\"1\":\"4\",\"2\":\"14.2\",\"3\":\"18.4\",\"4\":\"35.8\",\"5\":\"31.8\",\"6\":\"0.08333333\",\"7\":\"0.08333333\",\"8\":\"1.463000\",\"9\":\"-1.393333\",\"10\":\"6.966667e-02\"},{\"1\":\"5\",\"2\":\"14.1\",\"3\":\"17.4\",\"4\":\"35.7\",\"5\":\"30.9\",\"6\":\"0.12500000\",\"7\":\"0.08333333\",\"8\":\"1.724250\",\"9\":\"-1.672000\",\"10\":\"5.225000e-02\"},{\"1\":\"6\",\"2\":\"14.1\",\"3\":\"16.9\",\"4\":\"35.8\",\"5\":\"30.4\",\"6\":\"0.16666667\",\"7\":\"0.08333333\",\"8\":\"1.950667\",\"9\":\"-1.881000\",\"10\":\"6.966667e-02\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n### Estimating heat exchanged with environment\nIf no heat were exchanged with the environment and all measurements were without error,\nthen our two estimates of $\\dot Q$ would sum to 0.  (Heat lost to one fluid is gained by the \nother.)  \n\nAssuming any loss to (or gain from) the environment is essentially constant for\nthe apparatus over the experimental conditions analysed, we can use our 6\nobservations to estimate the amount of heat exchanged with the environment:\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_stats( ~ Q.env, data = HeatX2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"response\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"min\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Q1\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"median\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Q3\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"max\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"mean\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sd\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"n\"],\"name\":[9],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"missing\"],\"name\":[10],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"Q.env\",\"2\":\"-2.220446e-15\",\"3\":\"0.05660417\",\"4\":\"0.06966667\",\"5\":\"0.09579167\",\"6\":\"0.2438333\",\"7\":\"0.08998611\",\"8\":\"0.08273681\",\"9\":\"6\",\"10\":\"0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ngf_point( \"\" ~ Q.env, data = HeatX2, alpha = .6, cex = 3, jitter.data = TRUE)\n```\n\n::: {.cell-output-display}\n![](10-more-examples_files/figure-html/unnamed-chunk-5-1.png){width=432}\n:::\n:::\n\n\nFrom this we can compute either a p-value for the hypothesis test that the mean \ndifference in heat change is 0 or create a confidence interval for the mean difference\nin heat change.\nThe information above is enough to do this \"by hand\" using the standard error \nformula $SE = \\frac{s}{\\sqrt{n}}$ and a t-distribution with $n-1 = 5$ degrees of freedom.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSE = 0.08274 /sqrt(6); SE\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.03377846\n```\n:::\n\n```{.r .cell-code}\n0.09003 + c(-1,1) * qt(0.975, df = 5) * SE       # 95<!--  CI -->\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.003199695 0.176860305\n```\n:::\n\n```{.r .cell-code}\nt <- (0.08999 - 0) / SE; t\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.664124\n```\n:::\n\n```{.r .cell-code}\n2 * pt( -abs(t), df = 5 )                        # p-value\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.04466228\n```\n:::\n:::\n\n\n\nOr we can let R do all the computations for us:\n\n<!-- %qplot( Q.env, \" \", data = HeatX2,  -->\n<!-- %       geom = \"point\", size = I(6), alpha = I(.5),  -->\n<!-- %       position = position_jitter(width = 0, height = .1)) -->\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test( ~ Q.env, data = HeatX2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne Sample t-test\n\ndata:  Q.env\nt = 2.6641, df = 5, p-value = 0.04466\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n 0.003159159 0.176813063\nsample estimates:\n mean of x \n0.08998611 \n```\n:::\n:::\n\n\nIn our example data, there is modest evidence for exchange with the environment, but\nthe estimated amount of heat gained from the environment is not very precisely \nestimated.  Even at the highest end of the confidence interval, the heat exchanged \nwith the environment is an order of magnitude smaller than the heat exchanged \nwithin in the apparatus.\n\nNotes:\n\n::: {.enumerate}\n\n#. The fact that heat is gained to the system suggests that the cold water was in the\nouter pipe and hot water in the inner pipe.\n#. This analysis assumes that the amount of heat gained/lost is constant over \nthe different set-ups.  From this small data set, there is not clear evidence \nof some other relationship between heat exchanged with the environment\nand the experimental set up:\n\n::: {.cell}\n\n```{.r .cell-code}\ngf_point(Q.env ~ m.cold, data = HeatX2, color = ~ paste(\"m.hot =\", round(m.hot,2)))\n```\n\n::: {.cell-output-display}\n![](10-more-examples_files/figure-html/unnamed-chunk-8-1.png){width=576}\n:::\n:::\n\n\n#. \nThe t-test and interval are based on the assumption that the distribution\nof deviations between the measured environment heat exchange and the actual\nis normally distributed.  The data set is too small to provide much evidence\nupon which to judge whether this is a reasonable assumption.  The largest value is \nquite a bit larger than the rest, but even if we remove that observation, our \nconclusions don't change dramatically:\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test( ~ Q.env, data = subset(HeatX2, Q.env < max(Q.env)) )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne Sample t-test\n\ndata:  Q.env\nt = 3.4701, df = 4, p-value = 0.02558\nalternative hypothesis: true mean is not equal to 0\n95 percent confidence interval:\n 0.01183725 0.10659609\nsample estimates:\n mean of x \n0.05921667 \n```\n:::\n:::\n\n\n::: \n<!-- end enumerate -->\n\n\nOverall, we conclude that there is likely some heat exchanged with the environment, but \nthe amount of heat exchange with the environment\nappears to be at most a small factor in this situation.\n\n### Estimating heat transfer between hot and cold water, $\\dot{Q}$\n\nEstimating $\\dot{Q}$ with uncertainty is not possible from this data alone since since \n$\\dot{Q}$ is not measured directly, and we have only one measurement for each experimental\ncondition (so no way to look at how variable such measurements are without additional information.\nFurthermore, the design doesn't provide a method for estimating the \nuncertainty in $\\dot{m}$ and $T$.\n\nIf, however, there are external estimates of the uncertainties for temperature\nand flow rate, and if we can assume these uncertainties are approximately\nindependent, then we can use propagation of uncertainty to estimate the\nuncertainty in our estimates for heat exchanged.  Such uncertainties might come \nfrom specifications of the equipment used or be based on past experience of the\nresearcher.\n\nFor example, suppose that the uncertainties in temperature and flow rate \nmeasurements  are approximately constant (over the range of temperatures involved): \n$u_T$, and  $u_{\\dot{m}}$.  Then the uncertainty in the difference between two\nindependent temperatures is \n$\\sqrt{ u_T^2 + u_T^2 } = \\sqrt{2} u_T$, and we can estimate the uncertainty in\n$\\dot Q$ using the delta method.\n\n::: {.itemize}\n\n* Let $\\dot{Q}(\\dot{m}, \\Delta T) = C_p \\dot{m} \\Delta T$\n* $\\displaystyle \\Partial{\\dot{Q}}{\\dot m} = C_p \\Delta T$ and \n$\\displaystyle \\Partial{\\dot{Q}}{\\Delta T} = C_p \\dot{m}$, so\n* $\\displaystyle u_{\\dot Q} \\approx C_p \\sqrt{ (\\Delta T)^2 u^2_{\\dot m}  + \\dot{m}^2 u_{\\Delta T}^2 }$\n::: \n<!-- end itemize -->\n\n\nIf we estimate the uncertainty in measured temperatures\nto be $1$ degree C and the uncertainty in flow rate to be $0.5$ liters per\nminute (i.e., 0.0083333 L/sec), then we can compute the uncertainties in \nthe $\\dot{Q}$ values as follows\n\n::: {.cell}\n\n```{.r .cell-code}\nHeatX2<- HeatX2 |>\n  mutate(\n    u.Q.cold = C_p *sqrt( (T.cold.out - T.cold.in)^2 * (0.5/60)^2  + m.cold^2 * 2),  \n    u.Q.hot =  C_p *sqrt( (T.hot.out  - T.hot.in)^2  * (0.5/60)^2  +  m.hot^2 * 2) \n  ) \nHeatX2\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"trial\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"T.cold.in\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.cold.out\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.hot.in\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.hot.out\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"m.cold\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"m.hot\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Q.cold\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Q.hot\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Q.env\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"u.Q.cold\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"u.Q.hot\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"14.3\",\"3\":\"18.6\",\"4\":\"38.2\",\"5\":\"33.9\",\"6\":\"0.16666667\",\"7\":\"0.16666667\",\"8\":\"2.995667\",\"9\":\"-2.995667\",\"10\":\"-2.220446e-15\",\"11\":\"0.9965560\",\"12\":\"0.9965560\"},{\"1\":\"2\",\"2\":\"14.1\",\"3\":\"18.7\",\"4\":\"35.9\",\"5\":\"32.8\",\"6\":\"0.12500000\",\"7\":\"0.16666667\",\"8\":\"2.403500\",\"9\":\"-2.159667\",\"10\":\"2.438333e-01\",\"11\":\"0.7561000\",\"12\":\"0.9911354\"},{\"1\":\"3\",\"2\":\"14.1\",\"3\":\"19.4\",\"4\":\"35.9\",\"5\":\"33.4\",\"6\":\"0.08333333\",\"7\":\"0.16666667\",\"8\":\"1.846167\",\"9\":\"-1.741667\",\"10\":\"1.045000e-01\",\"11\":\"0.5260756\",\"12\":\"0.9890765\"},{\"1\":\"4\",\"2\":\"14.2\",\"3\":\"18.4\",\"4\":\"35.8\",\"5\":\"31.8\",\"6\":\"0.08333333\",\"7\":\"0.08333333\",\"8\":\"1.463000\",\"9\":\"-1.393333\",\"10\":\"6.966667e-02\",\"11\":\"0.5138832\",\"12\":\"0.5119434\"},{\"1\":\"5\",\"2\":\"14.1\",\"3\":\"17.4\",\"4\":\"35.7\",\"5\":\"30.9\",\"6\":\"0.12500000\",\"7\":\"0.08333333\",\"8\":\"1.724250\",\"9\":\"-1.672000\",\"10\":\"5.225000e-02\",\"11\":\"0.7478141\",\"12\":\"0.5202192\"},{\"1\":\"6\",\"2\":\"14.1\",\"3\":\"16.9\",\"4\":\"35.8\",\"5\":\"30.4\",\"6\":\"0.16666667\",\"7\":\"0.08333333\",\"8\":\"1.950667\",\"9\":\"-1.881000\",\"10\":\"6.966667e-02\",\"11\":\"0.9900513\",\"12\":\"0.5273081\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nNote: We are using the fact that $u_{\\Delta T} = \\sqrt{2} u_T$.\n\nWe can also use `deltaMethod()` in the **`car`** package to do this\narithmetic for us.  In fact, `deltaMathod()` can even handle cases\nwhere the estimates are not independent.  To do it's job,\n`deltaMethod()` requires\n\n::: {.itemize}\n\n* A named vector of estimates,\n\n\n::: {.cell}\n\n```{.r .cell-code}\nestimates <- HeatX[1, 2:7] |> unlist()  # unlist() turns the data frame into a vector\nestimates\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n T.cold.in T.cold.out   T.hot.in  T.hot.out     m.cold      m.hot \n14.3000000 18.6000000 38.2000000 33.9000000  0.1666667  0.1666667 \n```\n:::\n:::\n\n\n* An expression for the derived quantity as a quoted string \n\t(it will do the derivatives for us!),\n\t\n\n::: {.cell}\n\n```{.r .cell-code}\nexprforQ <- \"(T.cold.out - T.cold.in) * C_p * m.cold\"\n```\n:::\n\n\n* A variance-covariance matrix.  In the simple case where things are\n\tindependent, this is just a matrix with the squared uncertainties on the\n\tdiagonal and 0 everywhere else.\n\t\n\n::: {.cell}\n\n```{.r .cell-code}\nvc <- diag( c(1,1,1,1,.5/60,.5/60)^2)\nvc\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     [,1] [,2] [,3] [,4]         [,5]         [,6]\n[1,]    1    0    0    0 0.000000e+00 0.000000e+00\n[2,]    0    1    0    0 0.000000e+00 0.000000e+00\n[3,]    0    0    1    0 0.000000e+00 0.000000e+00\n[4,]    0    0    0    1 0.000000e+00 0.000000e+00\n[5,]    0    0    0    0 6.944444e-05 0.000000e+00\n[6,]    0    0    0    0 0.000000e+00 6.944444e-05\n```\n:::\n:::\n\n\n::: \n<!-- end itemize -->\n\nLet's see how it compares to the (first row of the) results above:\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\ndeltaMethod(estimates, exprforQ, vc)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"Estimate\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SE\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2.5 %\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"97.5 %\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"2.995667\",\"2\":\"0.996556\",\"3\":\"1.042453\",\"4\":\"4.948881\",\"_rn_\":\"(T.cold.out - T.cold.in) * C_p * m.cold\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n\nThe **`deltaMethod`** package adds additional interfaces for `deltaMethod()` to \nmake this even easier.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(deltaMethod)\ndeltaMethod(HeatX, exprforQ, \n  uncertainties = c(T.cold.in = 1.0, T.cold.out = 1.0, m.cold = 0.5 / 60))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nConverting uncertainties to a covariance matrix assuming independence ...\n```\n:::\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"T.cold.in\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.cold.out\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"m.cold\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Estimate\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SE\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2.5 %\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"97.5 %\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"14.3\",\"2\":\"18.6\",\"3\":\"0.16666667\",\"4\":\"2.995667\",\"5\":\"0.9965560\",\"6\":\"1.04245272\",\"7\":\"4.948881\",\"_rn_\":\"1\"},{\"1\":\"14.1\",\"2\":\"18.7\",\"3\":\"0.12500000\",\"4\":\"2.403500\",\"5\":\"0.7561000\",\"6\":\"0.92157122\",\"7\":\"3.885429\",\"_rn_\":\"2\"},{\"1\":\"14.1\",\"2\":\"19.4\",\"3\":\"0.08333333\",\"4\":\"1.846167\",\"5\":\"0.5260756\",\"6\":\"0.81507744\",\"7\":\"2.877256\",\"_rn_\":\"3\"},{\"1\":\"14.2\",\"2\":\"18.4\",\"3\":\"0.08333333\",\"4\":\"1.463000\",\"5\":\"0.5138832\",\"6\":\"0.45580749\",\"7\":\"2.470193\",\"_rn_\":\"4\"},{\"1\":\"14.1\",\"2\":\"17.4\",\"3\":\"0.12500000\",\"4\":\"1.724250\",\"5\":\"0.7478141\",\"6\":\"0.25856120\",\"7\":\"3.189939\",\"_rn_\":\"5\"},{\"1\":\"14.1\",\"2\":\"16.9\",\"3\":\"0.16666667\",\"4\":\"1.950667\",\"5\":\"0.9900513\",\"6\":\"0.01020171\",\"7\":\"3.891132\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n#### Dealing with uncertainties that are not constant\n\nSometimes the uncertainties of a given variable are different at different values.\nIn that case, we can put the uncertainties into the data frame.  For the current \nexample, this is just extra work, but we include it here to show how it works.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHeatX3 <- HeatX |>\n  mutate(\n    u.cold.in = 1, u.cold.out = 1, u.hot.in = 1, u.hot.out = 1, \n    u.m.cold = 0.5/60, u.m.hot = 0.5/60\n  )\nHeatX3\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"trial\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"T.cold.in\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.cold.out\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.hot.in\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.hot.out\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"m.cold\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"m.hot\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"u.cold.in\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"u.cold.out\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"u.hot.in\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"u.hot.out\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"u.m.cold\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"u.m.hot\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"14.3\",\"3\":\"18.6\",\"4\":\"38.2\",\"5\":\"33.9\",\"6\":\"0.16666667\",\"7\":\"0.16666667\",\"8\":\"1\",\"9\":\"1\",\"10\":\"1\",\"11\":\"1\",\"12\":\"0.008333333\",\"13\":\"0.008333333\"},{\"1\":\"2\",\"2\":\"14.1\",\"3\":\"18.7\",\"4\":\"35.9\",\"5\":\"32.8\",\"6\":\"0.12500000\",\"7\":\"0.16666667\",\"8\":\"1\",\"9\":\"1\",\"10\":\"1\",\"11\":\"1\",\"12\":\"0.008333333\",\"13\":\"0.008333333\"},{\"1\":\"3\",\"2\":\"14.1\",\"3\":\"19.4\",\"4\":\"35.9\",\"5\":\"33.4\",\"6\":\"0.08333333\",\"7\":\"0.16666667\",\"8\":\"1\",\"9\":\"1\",\"10\":\"1\",\"11\":\"1\",\"12\":\"0.008333333\",\"13\":\"0.008333333\"},{\"1\":\"4\",\"2\":\"14.2\",\"3\":\"18.4\",\"4\":\"35.8\",\"5\":\"31.8\",\"6\":\"0.08333333\",\"7\":\"0.08333333\",\"8\":\"1\",\"9\":\"1\",\"10\":\"1\",\"11\":\"1\",\"12\":\"0.008333333\",\"13\":\"0.008333333\"},{\"1\":\"5\",\"2\":\"14.1\",\"3\":\"17.4\",\"4\":\"35.7\",\"5\":\"30.9\",\"6\":\"0.12500000\",\"7\":\"0.08333333\",\"8\":\"1\",\"9\":\"1\",\"10\":\"1\",\"11\":\"1\",\"12\":\"0.008333333\",\"13\":\"0.008333333\"},{\"1\":\"6\",\"2\":\"14.1\",\"3\":\"16.9\",\"4\":\"35.8\",\"5\":\"30.4\",\"6\":\"0.16666667\",\"7\":\"0.08333333\",\"8\":\"1\",\"9\":\"1\",\"10\":\"1\",\"11\":\"1\",\"12\":\"0.008333333\",\"13\":\"0.008333333\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ndeltaMethod(HeatX3,\n  exprforQ, \n  estimates     = c(\"T.cold.in\", \"T.cold.out\", \"m.cold\"),    # columns with estimates\n  uncertainties = c(\"u.cold.in\", \"u.cold.out\", \"u.m.cold\"))  # and uncertainties\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nConverting uncertainties to a covariance matrix assuming independence ...\n```\n:::\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"T.cold.in\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.cold.out\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"m.cold\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.cold.in\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.cold.out\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"m.cold\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Estimate\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SE\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2.5 %\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"97.5 %\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"14.3\",\"2\":\"18.6\",\"3\":\"0.16666667\",\"4\":\"14.3\",\"5\":\"18.6\",\"6\":\"0.16666667\",\"7\":\"2.995667\",\"8\":\"16.617216\",\"9\":\"-29.57348\",\"10\":\"35.56481\",\"_rn_\":\"1\"},{\"1\":\"14.1\",\"2\":\"18.7\",\"3\":\"0.12500000\",\"4\":\"14.1\",\"5\":\"18.7\",\"6\":\"0.12500000\",\"7\":\"2.403500\",\"8\":\"12.470795\",\"9\":\"-22.03881\",\"10\":\"26.84581\",\"_rn_\":\"2\"},{\"1\":\"14.1\",\"2\":\"19.4\",\"3\":\"0.08333333\",\"4\":\"14.1\",\"5\":\"19.4\",\"6\":\"0.08333333\",\"7\":\"1.846167\",\"8\":\"8.555538\",\"9\":\"-14.92238\",\"10\":\"18.61471\",\"_rn_\":\"3\"},{\"1\":\"14.2\",\"2\":\"18.4\",\"3\":\"0.08333333\",\"4\":\"14.2\",\"5\":\"18.4\",\"6\":\"0.08333333\",\"7\":\"1.463000\",\"8\":\"8.227158\",\"9\":\"-14.66193\",\"10\":\"17.58793\",\"_rn_\":\"4\"},{\"1\":\"14.1\",\"2\":\"17.4\",\"3\":\"0.12500000\",\"4\":\"14.1\",\"5\":\"17.4\",\"6\":\"0.12500000\",\"7\":\"1.724250\",\"8\":\"11.828135\",\"9\":\"-21.45847\",\"10\":\"24.90697\",\"_rn_\":\"5\"},{\"1\":\"14.1\",\"2\":\"16.9\",\"3\":\"0.16666667\",\"4\":\"14.1\",\"5\":\"16.9\",\"6\":\"0.16666667\",\"7\":\"1.950667\",\"8\":\"15.456897\",\"9\":\"-28.34429\",\"10\":\"32.24563\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nAlthough our uncertainties are the same in each row, this method allows for uncertainties \nto be specified separately for each row of the data.\n\n### Does the uncertainty in $C_p$ matter?\n\nIn the analysis above, we treated $C_p$ as a constant (with arbitrary precision).  \nBut this number is also known experimentally and has an uncertainty associated with it.\nDo our results change if we include this uncertainty in our calculations?\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndeltaMethod( HeatX |> mutate(C_p = 4.18), exprforQ,      # add in a column for C_p\n  uncertainties = c(T.cold.in = 1.0, T.cold.out = 1.0, m.cold = 0.5/60, C_p = 0.1))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nConverting uncertainties to a covariance matrix assuming independence ...\n```\n:::\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"T.cold.in\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.cold.out\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"m.cold\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"C_p\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Estimate\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SE\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2.5 %\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"97.5 %\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"14.3\",\"2\":\"18.6\",\"3\":\"0.16666667\",\"4\":\"4.18\",\"5\":\"2.995667\",\"6\":\"0.9991296\",\"7\":\"1.03740855\",\"8\":\"4.953925\",\"_rn_\":\"1\"},{\"1\":\"14.1\",\"2\":\"18.7\",\"3\":\"0.12500000\",\"4\":\"4.18\",\"5\":\"2.403500\",\"6\":\"0.7582832\",\"7\":\"0.91729216\",\"8\":\"3.889708\",\"_rn_\":\"2\"},{\"1\":\"14.1\",\"2\":\"19.4\",\"3\":\"0.08333333\",\"4\":\"4.18\",\"5\":\"1.846167\",\"6\":\"0.5279263\",\"7\":\"0.81145004\",\"8\":\"2.880883\",\"_rn_\":\"3\"},{\"1\":\"14.2\",\"2\":\"18.4\",\"3\":\"0.08333333\",\"4\":\"4.18\",\"5\":\"1.463000\",\"6\":\"0.5150737\",\"7\":\"0.45347411\",\"8\":\"2.472526\",\"_rn_\":\"4\"},{\"1\":\"14.1\",\"2\":\"17.4\",\"3\":\"0.12500000\",\"4\":\"4.18\",\"5\":\"1.724250\",\"6\":\"0.7489510\",\"7\":\"0.25633306\",\"8\":\"3.192167\",\"_rn_\":\"5\"},{\"1\":\"14.1\",\"2\":\"16.9\",\"3\":\"0.16666667\",\"4\":\"4.18\",\"5\":\"1.950667\",\"6\":\"0.9911506\",\"7\":\"0.00804728\",\"8\":\"3.893286\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\nComparing these results to the results above we see that the uncertainty\nincreases, but only by amounts that are barely visible (a few parts per\n1,000 -- not enough to affect how we report the uncertainty given our rules\nfor reporting digits).  This has no meaningful impact on our analysis.\n\nWe can often simplify propagation of uncertainty calculations by identifying which \ncomponents of the uncertainty are driving the size of the overall uncertainty.  In this case, \nthe imprecision in the estimated value of $C_p$ is unimportant.  If we want to improve our\nuncertainty, we must improve our measurements of temperature and/or flow rate.\n\n### Using relative uncertainty\n\nRecall that for products, there is a Pythagorean relationship for relative uncertainties.\n\n$$\n\\frac{u_{\\dot Q}}{\\dot Q} \\approx \n\\sqrt{ \n(\\frac{u_{\\dot m}}{\\dot{m}})^2\n+\n(\\frac{u_{\\Delta T}}{\\Delta T})^2\n+\n(\\frac{u_{C_p}}{C_p})^2\n}\n$$\nThis is useful in determining what uncertainties contribute most to the overall uncertainty.\nFor example, using the values in the first row of the data set.\n\n::: {.itemize}\n\n* $\\displaystyle \\frac{u_{\\dot{m}}}{\\dot{m}} = \\frac{0.5/60}{10/60} = 0.05$\n* $\\displaystyle \\frac{u_{\\Delta T}}{\\Delta T} = \\frac{\\sqrt{2}}{4.5} = 0.3142697$\n* $\\displaystyle \\frac{u_{C_p}}{C_p} = \\frac{0.1}{4.18} = 0.0239234$\n::: \n<!-- end itemize -->\n\nFrom this we can see that it is the imprecise temperature measurements that are our biggest\nproblem.  Even if we eliminated the other uncertainties, we would still have a relative uncertainty\nof over $30$%.   The details vary a bit from row to row, but the uncertainty in in temperature \nis our biggest obstacle.  In addition to increasing the precision of our temperature sensors, we could \nalso potentially improve things by designing a heat exchanger with more dramatic changes in \ntemperature.\n\nSuppose, for example, we could estimate temperature with an uncertainty of 0.1 degrees (ten times \nbetter than we have been assuming).  Then our uncertainties for $\\dot{Q}$ would change pretty\ndramatically.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHeatX |>\n  mutate(C_p = 4.18) |>  # add in a column for C_p\n  deltaMethod(\n    exprforQ,      \n    uncertainties = c(T.cold.in = 0.1, T.cold.out = 0.1, m.cold = 0.5/60, C_p = 0.1))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nConverting uncertainties to a covariance matrix assuming independence ...\n```\n:::\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"T.cold.in\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.cold.out\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"m.cold\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"C_p\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Estimate\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SE\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2.5 %\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"97.5 %\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"14.3\",\"2\":\"18.6\",\"3\":\"0.16666667\",\"4\":\"4.18\",\"5\":\"2.995667\",\"6\":\"0.1930752\",\"7\":\"2.617246\",\"8\":\"3.374087\",\"_rn_\":\"1\"},{\"1\":\"14.1\",\"2\":\"18.7\",\"3\":\"0.12500000\",\"4\":\"4.18\",\"5\":\"2.403500\",\"6\":\"0.1855831\",\"7\":\"2.039764\",\"8\":\"2.767236\",\"_rn_\":\"2\"},{\"1\":\"14.1\",\"2\":\"19.4\",\"3\":\"0.08333333\",\"4\":\"4.18\",\"5\":\"1.846167\",\"6\":\"0.1961141\",\"7\":\"1.461790\",\"8\":\"2.230543\",\"_rn_\":\"3\"},{\"1\":\"14.2\",\"2\":\"18.4\",\"3\":\"0.08333333\",\"4\":\"4.18\",\"5\":\"1.463000\",\"6\":\"0.1582890\",\"7\":\"1.152759\",\"8\":\"1.773241\",\"_rn_\":\"4\"},{\"1\":\"14.1\",\"2\":\"17.4\",\"3\":\"0.12500000\",\"4\":\"4.18\",\"5\":\"1.724250\",\"6\":\"0.1427417\",\"7\":\"1.444481\",\"8\":\"2.004019\",\"_rn_\":\"5\"},{\"1\":\"14.1\",\"2\":\"16.9\",\"3\":\"0.16666667\",\"4\":\"4.18\",\"5\":\"1.950667\",\"6\":\"0.1462786\",\"7\":\"1.663966\",\"8\":\"2.237367\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\nBut if we improve the uncertainty in the mass flow rate by a factor of 10, it has only a \nmodest impact on our uncertainty for $\\dot{Q}$.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHeatX |>\n  mutate(C_p = 4.18) |>  # add in a column for C_p\n  deltaMethod(\n    exprforQ,      \n    uncertainties = c(T.cold.in = 1.0, T.cold.out = 1.0, m.cold = 0.5/600, C_p = 0.1))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nConverting uncertainties to a covariance matrix assuming independence ...\n```\n:::\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"T.cold.in\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.cold.out\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"m.cold\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"C_p\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Estimate\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SE\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2.5 %\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"97.5 %\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"14.3\",\"2\":\"18.6\",\"3\":\"0.16666667\",\"4\":\"4.18\",\"5\":\"2.995667\",\"6\":\"0.9879521\",\"7\":\"1.05931613\",\"8\":\"4.932017\",\"_rn_\":\"1\"},{\"1\":\"14.1\",\"2\":\"18.7\",\"3\":\"0.12500000\",\"4\":\"4.18\",\"5\":\"2.403500\",\"6\":\"0.7413336\",\"7\":\"0.95051286\",\"8\":\"3.856487\",\"_rn_\":\"2\"},{\"1\":\"14.1\",\"2\":\"19.4\",\"3\":\"0.08333333\",\"4\":\"4.18\",\"5\":\"1.846167\",\"6\":\"0.4949381\",\"7\":\"0.87610576\",\"8\":\"2.816228\",\"_rn_\":\"3\"},{\"1\":\"14.2\",\"2\":\"18.4\",\"3\":\"0.08333333\",\"4\":\"4.18\",\"5\":\"1.463000\",\"6\":\"0.4940762\",\"7\":\"0.49462851\",\"8\":\"2.431371\",\"_rn_\":\"4\"},{\"1\":\"14.1\",\"2\":\"17.4\",\"3\":\"0.12500000\",\"4\":\"4.18\",\"5\":\"1.724250\",\"6\":\"0.7401663\",\"7\":\"0.27355065\",\"8\":\"3.174949\",\"_rn_\":\"5\"},{\"1\":\"14.1\",\"2\":\"16.9\",\"3\":\"0.16666667\",\"4\":\"4.18\",\"5\":\"1.950667\",\"6\":\"0.9863883\",\"7\":\"0.01738121\",\"8\":\"3.883952\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\n### Estimating the heat transfer coefficient, $U$\n\nNext, we estimate a heat transfer coefficient ($U$) for both streams,\n\n$$\nU = \\frac{\\dot{Q}}{A \\Delta T_{lm}},\n$$\n\nwhere \n\n$$\n\\Delta T_{lm} \\equiv \\frac{(T_{1} - T_{4}) - (T_{2} - T_{3})}{\\log\\left( \\frac{T_{1} - T_{4}}{T_{2} - T_{3}} \\right)}.\n$$\n\nWe can apply the same ideas to estimate the uncertainty in $U$.  This time,\nworking it out by hand would be considerably more tedious because of the number\nof variables involved and the form of the expression to be differentiated.\nFortunately, R is happy to take care of those details if we just specify the\ninformation needed.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexprforU <- paste(\"C_p * m.cold * (T.cold.out - T.cold.in) /\",\n                  \"( pi * D *  L  * ((T.cold.out - T.hot.in) - (T.cold.in - T.hot.out)) /\",\n                  \" log ( (T.cold.out - T.hot.in) / (T.cold.in - T.hot.out) ) )\")\nHeatX4 <- HeatX |>\n  mutate(D = 0.0143, L = 1.626, C_p = 4.18)\nHeatX4\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"trial\"],\"name\":[1],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"T.cold.in\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.cold.out\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.hot.in\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.hot.out\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"m.cold\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"m.hot\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"D\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"L\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"C_p\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"14.3\",\"3\":\"18.6\",\"4\":\"38.2\",\"5\":\"33.9\",\"6\":\"0.16666667\",\"7\":\"0.16666667\",\"8\":\"0.0143\",\"9\":\"1.626\",\"10\":\"4.18\"},{\"1\":\"2\",\"2\":\"14.1\",\"3\":\"18.7\",\"4\":\"35.9\",\"5\":\"32.8\",\"6\":\"0.12500000\",\"7\":\"0.16666667\",\"8\":\"0.0143\",\"9\":\"1.626\",\"10\":\"4.18\"},{\"1\":\"3\",\"2\":\"14.1\",\"3\":\"19.4\",\"4\":\"35.9\",\"5\":\"33.4\",\"6\":\"0.08333333\",\"7\":\"0.16666667\",\"8\":\"0.0143\",\"9\":\"1.626\",\"10\":\"4.18\"},{\"1\":\"4\",\"2\":\"14.2\",\"3\":\"18.4\",\"4\":\"35.8\",\"5\":\"31.8\",\"6\":\"0.08333333\",\"7\":\"0.08333333\",\"8\":\"0.0143\",\"9\":\"1.626\",\"10\":\"4.18\"},{\"1\":\"5\",\"2\":\"14.1\",\"3\":\"17.4\",\"4\":\"35.7\",\"5\":\"30.9\",\"6\":\"0.12500000\",\"7\":\"0.08333333\",\"8\":\"0.0143\",\"9\":\"1.626\",\"10\":\"4.18\"},{\"1\":\"6\",\"2\":\"14.1\",\"3\":\"16.9\",\"4\":\"35.8\",\"5\":\"30.4\",\"6\":\"0.16666667\",\"7\":\"0.08333333\",\"8\":\"0.0143\",\"9\":\"1.626\",\"10\":\"4.18\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\ndeltaMethod(\n  HeatX4, \n  exprforU, \n  uncertainties = c(\n    T.cold.in = 1.0, T.cold.out = 1.0, m.cold = 0.5/60, \n    T.hot.in = 1.0, T.hot.out = 1.0, m.hot = 0.5/60, \n    C_p = 0.1, D = 0.0004, L = 0.0006),\n  constants = list(pi = pi)\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nConverting uncertainties to a covariance matrix assuming independence ...\n```\n:::\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"T.cold.in\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.cold.out\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"m.cold\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.hot.in\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"T.hot.out\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"m.hot\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"C_p\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"D\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"L\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"Estimate\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"SE\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"2.5 %\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"97.5 %\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"14.3\",\"2\":\"18.6\",\"3\":\"0.16666667\",\"4\":\"38.2\",\"5\":\"33.9\",\"6\":\"0.16666667\",\"7\":\"4.18\",\"8\":\"0.0143\",\"9\":\"1.626\",\"10\":\"-2.563109\",\"11\":\"2.650228e+14\",\"12\":\"-5.194352e+14\",\"13\":\"5.194352e+14\",\"_rn_\":\"1\"},{\"1\":\"14.1\",\"2\":\"18.7\",\"3\":\"0.12500000\",\"4\":\"35.9\",\"5\":\"32.8\",\"6\":\"0.16666667\",\"7\":\"4.18\",\"8\":\"0.0143\",\"9\":\"1.626\",\"10\":\"-1.834113\",\"11\":\"5.917860e-01\",\"12\":\"-2.993993e+00\",\"13\":\"-6.742339e-01\",\"_rn_\":\"2\"},{\"1\":\"14.1\",\"2\":\"19.4\",\"3\":\"0.08333333\",\"4\":\"35.9\",\"5\":\"33.4\",\"6\":\"0.16666667\",\"7\":\"4.18\",\"8\":\"0.0143\",\"9\":\"1.626\",\"10\":\"-1.414814\",\"11\":\"4.168660e-01\",\"12\":\"-2.231856e+00\",\"13\":\"-5.977715e-01\",\"_rn_\":\"3\"},{\"1\":\"14.2\",\"2\":\"18.4\",\"3\":\"0.08333333\",\"4\":\"35.8\",\"5\":\"31.8\",\"6\":\"0.08333333\",\"7\":\"4.18\",\"8\":\"0.0143\",\"9\":\"1.626\",\"10\":\"-1.144470\",\"11\":\"4.096225e-01\",\"12\":\"-1.947316e+00\",\"13\":\"-3.416251e-01\",\"_rn_\":\"4\"},{\"1\":\"14.1\",\"2\":\"17.4\",\"3\":\"0.12500000\",\"4\":\"35.7\",\"5\":\"30.9\",\"6\":\"0.08333333\",\"7\":\"4.18\",\"8\":\"0.0143\",\"9\":\"1.626\",\"10\":\"-1.345802\",\"11\":\"5.892800e-01\",\"12\":\"-2.500770e+00\",\"13\":\"-1.908347e-01\",\"_rn_\":\"5\"},{\"1\":\"14.1\",\"2\":\"16.9\",\"3\":\"0.16666667\",\"4\":\"35.8\",\"5\":\"30.4\",\"6\":\"0.08333333\",\"7\":\"4.18\",\"8\":\"0.0143\",\"9\":\"1.626\",\"10\":\"-1.520042\",\"11\":\"7.753836e-01\",\"12\":\"-3.039766e+00\",\"13\":\"-3.181344e-04\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n\nNote the use of the `constants` argument here to specify the value of `pi`.  \nWe could also have specified $C_p$ this way if we decided to ignore the uncertainty\nin that value.  But since it is no harder to include that uncertainty, we included it.\n\n\n### Estimating the Nusselt number correlation,  $a$\n\nFinally, we can estimate\nthe parameter $a$ in a Nusselt number correlation\nfor turbulent flow ($Re_{D} > 2300$):\n\n$$\n    a = \\frac{Nu_D}{Re_{D}^{0.8} Pr^{1/3}},\n$$\n\nwhere\n\n$$\n\tNu_{D} = \\frac{h D}{k} \\approx \\frac{ 2 U D}{k}, \n$$\n\n$$\n    Re_{D} = \\frac{4 \\dot{m}}{\\pi D \\mu},\n$$\n\nand\n\n$$\n    Pr = \\frac{\\mu C_{p}}{k}.\n$$\n\nThe uncertainty in the estimates for $a$ can be estimated in a similar manner.\nFor that purpose, we assume that the exponents on $Re_{D}$ and $Pr$\n(0.8 and 1/3, respectively)\nare constant.\nThe values of $C_{p}$, $k$, and $\\mu$ are given in @tbl-hxer-definitions.\n\nTo complete our uncertainty calculation we must\n\n::: {.enumerate}\n\n#.  Create an expression for the quantity we are interested in (as a quoted string).\n#.  Create a data frame that has all of the components of this expression\n\t\tthat have uncertainties.\n#.  Create a named vector of uncertainties.  The names should correspond \n\t\tto the variables names in the data frame, the values are the uncertainties.\n\t\t(Alternatively, the uncertainties can be put inside the data frame and \n\t\tthe arguments `estimtates` and `uncertainties` can be \n\t\tused to specify which columns are the estimates and which are the\n\t\tcorresponding uncertainties.)\n#.  Create a list that contains the value of any constants (or values for which\n\t\twe are ignoring that there is uncertainty because the uncertainty is so \n\t\tsmall that it doesn't affect the analysis).\n::: \n<!-- end enumerate -->\n\n\nThis is left as an exercise for you.\n\n\n## Standard Errors in `fitdistr()` output\n\nWe had not yet learned about uncertainty and standard errors when we learned about \n`fitdistr()`, but the output from the function includes an estimated standard\nerror.\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(fastR2)\nfitdistr(Jordan8687$points, \"normal\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      mean          sd    \n  37.0853659    9.8639541 \n ( 1.0892915) ( 0.7702454)\n```\n:::\n:::\n\n\nThe parenthesized numbers are the estimated standard errors associated with each\nparameter estimate.\nIn this case, it is easy to compute the standard error for the mean ourselves\nusing $SE = s / \\sqrt{n}$.\n\n::: {.cell}\n\n```{.r .cell-code}\nsd( ~ points, data = Jordan8687) / sqrt(82)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.095995\n```\n:::\n:::\n\n\n\n\n## $R^2$ {#sec-r-squared}\n\n::: {.center}\n\n*Note: the methods in this section assume a linear model with an intercept term.*\n::: \n<!-- end center -->\n\n\nRecall that linear models are fit by minimizing the sum of the squares of the residuals:%\n\\footnote{$RSS$ stands for Residual Sum of Squares; $SSE$ stands for Error Sum of Squares.}\n$$\nRSS = SSE = \\sum_{i = 1}^{n} ( y_i - \\hat y)^2\n$$\nThis expression reminds us of^[$SST$ stands for Total Sum of Squares.]\n$$\nSST = \\sum_{i = 1}^{n} ( y_i - \\mean y)^2 \\;,\n$$\nthe numerator of the variance of $y$.  $SST$ is a measure\nof the total variation in the response variable.\n\nA little algebra shows that^[SSM stands for Model Sum of Squares.]\n$$\nSSM = SST - SSE = \n\\sum_{i = 1}^{n} ( \\hat y - \\mean y)^2 \\;,\n$$\nWe can now define $R^2$ by\n$$\nR^2 = \\frac{SSM}{SST}  = \\frac{SSM}{ SSM + SSE }\n= \\mbox{proportion of variability in the response explained by the model.}\n$$\n$R^2$ is always between 0 and 1 and is reported in the summary output\nfor linear models.  It is the square of the correlation coefficient\nthat we saw earlier.\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(sat ~ expend, data = SAT))  # how does the average SAT score depend on money spent?\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = sat ~ expend, data = SAT)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-145.074  -46.821    4.087   40.034  128.489 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 1089.294     44.390  24.539  < 2e-16 ***\nexpend       -20.892      7.328  -2.851  0.00641 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 69.91 on 48 degrees of freedom\nMultiple R-squared:  0.1448,\tAdjusted R-squared:  0.127 \nF-statistic: 8.128 on 1 and 48 DF,  p-value: 0.006408\n```\n:::\n:::\n\n\nNotice that $R^2 < 15%$ and that the coefficient on `expend` is negative -- indicating \nthat spending more is associated with *worse* scores on the SAT.\n\nOne reason for this is that in some states most college bound students take the SAT, but in \nother states, the ACT is more common so the pool of students taking the SAT is stronger.\nIf we add `frac` -- the fraction of students in a given state who took the SAT.\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(sat ~ expend + frac, data = SAT))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = sat ~ expend + frac, data = SAT)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-88.400 -22.884   1.968  19.142  68.755 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 993.8317    21.8332  45.519  < 2e-16 ***\nexpend       12.2865     4.2243   2.909  0.00553 ** \nfrac         -2.8509     0.2151 -13.253  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 32.46 on 47 degrees of freedom\nMultiple R-squared:  0.8195,\tAdjusted R-squared:  0.8118 \nF-statistic: 106.7 on 2 and 47 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\nNotice how much larger $R^2$ is now, and that the sign of the coefficient on `expend`\nis not positive -- as we would have expected.\n\nIt is important to note that adding in the additional variable `frac` gives a very\ndifferent impression of the effect of `expend` on `sat`.  Most of our examples \nhave dealt with one response to one predictor, but in many situations, this is too simplistic and\nthe inclusion of multiple predictors in the model is required to understand their impact on \nthe response.\n\n\n## Exercises\n\n::: {.problem #exr-uncertainty-nusselt}\n\nGive an estimate with uncertainty for the\nNusselt number correlation using the data in `HeatX` used\nin this chapter.\n::: \n<!-- end problem -->\n",
    "supporting": [
      "10-more-examples_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}