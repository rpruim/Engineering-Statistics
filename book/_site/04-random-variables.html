<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Statistics for the Physical Sciences and Engineering - 4&nbsp; Random Variables</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05-transformations.html" rel="next">
<link href="./03-probability.html" rel="prev">
<link href="./cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

</head><body class="nav-sidebar docked">$$
\def\reals{\mathbb{R}}
\def\card#1{| #1 |}
\def\mean{\overline}
\def\evProb#1{\operatorname{Prob}(\mbox{#1})}
\def\Prob{\operatorname{Prob}}
\def\tand{\operatorname{and}}
\def\tor{\operatorname{or}}
\def\tnot{\operatorname{not}}
\def\E{{\operatorname E}}
\def\Var{\operatorname{Var}}
\def\SD{\operatorname{SD}}
\def\union{\cup}
\def\intersect{\cap}
\def\Unif{\mathsf{Unif}}
\def\Beta{\mathsf{Beta}}
\def\Rayleigh{\mathsf{Rayleigh}}
\def\Exp{\mathsf{Exp}}
\def\Norm{\mathsf{Norm}}
\def\Tri{\mathsf{Tri}}
\def\Gamm{\mathsf{Gamma}}
\def\Pois{\mathsf{Pois}}
\def\Binom{\mathsf{Binom}}
\def\Weibull{\mathsf{Weibull}}
\def\Tdist{\mathsf{T}}
\def\Fdist{\mathsf{F}}
\def\Chisq{\mathsf{Chisq}}
\def\boolval#1{[\![ #1 ]\!]}
\def\simiid{\stackrel{\mathrm{iid}{\sim}}}

\def\sfrac#1#2{{#1}/{#2}}
\def\PartialFrac#1#2{\frac{\partial #1}{\partial #2}}
\def\Partial#1#2{\frac{\partial}{\partial #2} #1}

\def\myindex#1{\relax}
$$

<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="book.css">




<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Random Variables</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistics for the Physical Sciences and Engineering</a> 
        <div class="sidebar-tools-main">
    <a href="./Pruim-Stat-for-Phys-Sci-and-Engr.pdf" title="Download PDF" class="sidebar-tool px-1"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-chap0.html" class="sidebar-item-text sidebar-link">Where do numbers come from?</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-graphical.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Graphical Summaries of Data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-numerical.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Numerical Summaries</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-probability.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Probability</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-random-variables.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Random Variables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-transformations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Transformation and Combinations of Random Variables</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-propagation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Propagation of Uncertainty</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-simple-linear.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Linear Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-nonlinear.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Beyond Linear Regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-hypothesis-testing.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-more-examples.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">More Examples</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#discrete-random-variables" id="toc-discrete-random-variables" class="nav-link active" data-scroll-target="#discrete-random-variables"><span class="toc-section-number">4.1</span>  Discrete Random Variables</a></li>
  <li><a href="#continuous-random-variables" id="toc-continuous-random-variables" class="nav-link" data-scroll-target="#continuous-random-variables"><span class="toc-section-number">4.2</span>  Continuous Random Variables</a>
  <ul class="collapse">
  <li><a href="#density-histograms-density-plots-density-functions" id="toc-density-histograms-density-plots-density-functions" class="nav-link" data-scroll-target="#density-histograms-density-plots-density-functions"><span class="toc-section-number">4.2.1</span>  Density histograms, density plots, density functions</a></li>
  <li><a href="#kernels" id="toc-kernels" class="nav-link" data-scroll-target="#kernels"><span class="toc-section-number">4.2.2</span>  Kernels</a></li>
  <li><a href="#cumulative-distribution-functions" id="toc-cumulative-distribution-functions" class="nav-link" data-scroll-target="#cumulative-distribution-functions"><span class="toc-section-number">4.2.3</span>  Cumulative distribution functions</a></li>
  </ul></li>
  <li><a href="#mean-and-variance" id="toc-mean-and-variance" class="nav-link" data-scroll-target="#mean-and-variance"><span class="toc-section-number">4.3</span>  Mean and Variance</a>
  <ul class="collapse">
  <li><a href="#the-mean-of-a-random-variable" id="toc-the-mean-of-a-random-variable" class="nav-link" data-scroll-target="#the-mean-of-a-random-variable"><span class="toc-section-number">4.3.1</span>  The mean of a random variable</a></li>
  <li><a href="#variance" id="toc-variance" class="nav-link" data-scroll-target="#variance"><span class="toc-section-number">4.3.2</span>  Variance</a></li>
  <li><a href="#quantiles" id="toc-quantiles" class="nav-link" data-scroll-target="#quantiles"><span class="toc-section-number">4.3.3</span>  Quantiles</a></li>
  </ul></li>
  <li><a href="#some-important-families-of-distributions" id="toc-some-important-families-of-distributions" class="nav-link" data-scroll-target="#some-important-families-of-distributions"><span class="toc-section-number">4.4</span>  Some Important Families of Distributions</a>
  <ul class="collapse">
  <li><a href="#triangle-distributions" id="toc-triangle-distributions" class="nav-link" data-scroll-target="#triangle-distributions"><span class="toc-section-number">4.4.1</span>  Triangle Distributions</a></li>
  <li><a href="#uniform-distributions" id="toc-uniform-distributions" class="nav-link" data-scroll-target="#uniform-distributions"><span class="toc-section-number">4.4.2</span>  Uniform Distributions</a></li>
  <li><a href="#exponential-distributions" id="toc-exponential-distributions" class="nav-link" data-scroll-target="#exponential-distributions"><span class="toc-section-number">4.4.3</span>  Exponential Distributions</a></li>
  <li><a href="#gamma-and-weibull-distributions" id="toc-gamma-and-weibull-distributions" class="nav-link" data-scroll-target="#gamma-and-weibull-distributions"><span class="toc-section-number">4.4.4</span>  Gamma and Weibull Distributions</a></li>
  <li><a href="#normal-distributions" id="toc-normal-distributions" class="nav-link" data-scroll-target="#normal-distributions"><span class="toc-section-number">4.4.5</span>  Normal Distributions</a></li>
  <li><a href="#beta-distributions" id="toc-beta-distributions" class="nav-link" data-scroll-target="#beta-distributions"><span class="toc-section-number">4.4.6</span>  Beta Distributions</a></li>
  <li><a href="#binomial-distributions" id="toc-binomial-distributions" class="nav-link" data-scroll-target="#binomial-distributions"><span class="toc-section-number">4.4.7</span>  Binomial Distributions</a></li>
  <li><a href="#poisson-distributions" id="toc-poisson-distributions" class="nav-link" data-scroll-target="#poisson-distributions"><span class="toc-section-number">4.4.8</span>  Poisson Distributions</a></li>
  </ul></li>
  <li><a href="#fitting-distributions-to-data" id="toc-fitting-distributions-to-data" class="nav-link" data-scroll-target="#fitting-distributions-to-data"><span class="toc-section-number">4.5</span>  Fitting Distributions to Data</a>
  <ul class="collapse">
  <li><a href="#maximum-likelihood" id="toc-maximum-likelihood" class="nav-link" data-scroll-target="#maximum-likelihood"><span class="toc-section-number">4.5.1</span>  Maximum Likelihood</a></li>
  <li><a href="#the-method-of-moments" id="toc-the-method-of-moments" class="nav-link" data-scroll-target="#the-method-of-moments"><span class="toc-section-number">4.5.2</span>  The method of moments</a></li>
  </ul></li>
  <li><a href="#quantile-quantile-plots" id="toc-quantile-quantile-plots" class="nav-link" data-scroll-target="#quantile-quantile-plots"><span class="toc-section-number">4.6</span>  Quantile-Quantile Plots</a>
  <ul class="collapse">
  <li><a href="#normal-quantile-plots" id="toc-normal-quantile-plots" class="nav-link" data-scroll-target="#normal-quantile-plots"><span class="toc-section-number">4.6.1</span>  Normal-Quantile Plots</a></li>
  <li><a href="#other-distributions" id="toc-other-distributions" class="nav-link" data-scroll-target="#other-distributions"><span class="toc-section-number">4.6.2</span>  Other distributions</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="toc-section-number">4.7</span>  Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Random Variables</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="description">
<ul>
<li><strong>random variable</strong> a random process that results in a number</li>
</ul>
</div>
<!-- end description -->
<p>We have already seen notation for and a few examples of random variables. In this chapter we will learn a bit more about random variables. We will focus our attention on two types of random variables: discrete random variables and continuous random variables.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<section id="discrete-random-variables" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="discrete-random-variables"><span class="header-section-number">4.1</span> Discrete Random Variables</h2>
<p>A discrete random variable takes on values from a discrete set of possibilities, typically either a finite set or a subset of the integers. Here are some examples.</p>
<div class="enumerate">
<ol>
<li>If we roll a die and record the number, there are six possible values, so the random variable is discrete.</li>
<li>If we keep flipping a coin until we get a head and record the number of coin tosses, then the possible values of the random variable are <span class="math inline">\(1, 2, 3, \dots\)</span> This is also a discrete random variable.</li>
</ol>
</div>
<!-- end enumerate -->
<p>For each of the possible values of a discrete random variable, there is some probability of that value occurring. So to specify a discrete random variable, we need to specify those probabilities. When there are only a small number of possible value, we can do this with a table.</p>
<div class="center">
<table class="table">
<colgroup>
<col style="width: 27%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 9%">
</colgroup>
<tbody>
<tr class="odd">
<td>value of <span class="math inline">\(X\)</span></td>
<td>0</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td>probability</td>
<td>0.2</td>
<td>0.5</td>
<td>0.3</td>
</tr>
</tbody>
</table>
</div>
<p>This is really just one way of describing a function, called the <strong>probability mass function</strong> (or pmf). The pmf satisfies <span id="eq-pmf"><span class="math display">\[
f(x) = \Prob(X = x)
\tag{4.1}\]</span></span></p>
<p>Sometimes instead of providing a table, we will be able to specify the pmf using a formula. For example, we could define a pmf <span class="math inline">\(g\)</span> by</p>
<p><span class="math display">\[
g(y) = (2 - |1-y|) / 4 \mbox{ for $y \in \{0, 1, 2\}$}
\]</span> which is the same as specifying <span class="math inline">\(g\)</span> with the following table.</p>
<div class="center">
<table class="table">
<colgroup>
<col style="width: 27%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 11%">
</colgroup>
<tbody>
<tr class="odd">
<td>value of <span class="math inline">\(Y\)</span></td>
<td>0</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td>probability</td>
<td>0.25</td>
<td>0.5</td>
<td>0.25</td>
</tr>
</tbody>
</table>
</div>
<p>Here’s one more example. Let <span class="math inline">\(W\)</span> be a random variable that can take on any integer value and has pmf given by</p>
<p><span class="math display">\[
h(w) = \left(\frac{1}{2}\right)^{w+1} \mbox {for $w = 0, 1, 2, 3, \dots$}
\]</span></p>
<p>So, for example, <span class="math inline">\(\Prob(W = 2) = h(2) = \left(\frac{1}{2} \right)^3 = \frac18\)</span>.</p>
<p>Probabilities can be obtained from the pmf by adding:</p>
<ul>
<li><span class="math inline">\(\Prob( X &gt; 0 ) = 0.5 + 0.3 = 0.8\)</span></li>
<li><span class="math inline">\(\Prob( Y &gt; 0) = 0.5 + 0.25\)</span></li>
<li><span class="math inline">\(\Prob(W &gt; 0) = \frac{1}{4} + \frac{1}{8} + \frac{1}{16} + \cdots = \frac{1}{2}\)</span></li>
<li><span class="math inline">\(\Prob(W &gt; 0) = 1 - \Prob(W = 0) = 1 - \frac{1}{2} = \frac{1}{2}\)</span></li>
</ul>
<p>The only restrictions on a pmf are that</p>
<div class="enumerate">
<ol>
<li>the values must all be non-negative, and</li>
<li>the sum (over all possible values of the random variable) must be 1.</li>
</ol>
</div>
<!-- end enumerate -->
<p>That way the probabilities will behave the way probabilities should.</p>
<div id="exm-freethrow-amy" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.1 </strong></span><strong>Q.</strong> Amy is a 92% free throw shooter. We watch her take shots until she misses and let <span class="math inline">\(X\)</span> be the number of shots. What is the pmf for <span class="math inline">\(X\)</span>?</p>
<p><strong>A.</strong> This time our table would be infinite (since there is no limit to how many consecutive free throws Amy might make), so we won’t be able to write the whole table down. But we can work out the first few probabilities:</p>
<div class="itemize">
<ul>
<li><span class="math inline">\(f(1) = \Prob(X = 1) = 0.08\)</span>. (She has to miss the first shot.)</li>
<li><span class="math inline">\(f(2) = \Prob(X = 2) = (0.92)(0.08)\)</span>. (She has to make the first and miss the second.)</li>
<li><span class="math inline">\(f(3) = \Prob(X = 3) = (0.92)^2(0.08)\)</span>. (She has to make the first two, then miss the third.)</li>
</ul>
</div>
<!-- end itemize -->
<p>At this point, we see there is a general pattern that allows us to write down an algebraic form for the pmf:</p>
<p><span class="math display">\[
f(x) = \Prob(X = x) = (0.92)^{x-1}(0.08)
\]</span> where <span class="math inline">\(x\)</span> is a positive integer. (If <span class="math inline">\(x\)</span> is not an integer, or <span class="math inline">\(x &lt; 1\)</span>, then <span class="math inline">\(f(x) = 0\)</span>, since those values are not possible.)</p>
</div>
<!-- end example -->
</section>
<section id="continuous-random-variables" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="continuous-random-variables"><span class="header-section-number">4.2</span> Continuous Random Variables</h2>
<section id="density-histograms-density-plots-density-functions" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="density-histograms-density-plots-density-functions"><span class="header-section-number">4.2.1</span> Density histograms, density plots, density functions</h3>
<p>A histogram is a simple picture describing the “density” of data. Histogram bars are tall in regions where there is more data – i.e., where the data are more “dense”.</p>
<div>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(alr4)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(  <span class="sc">~</span> Duration, <span class="at">data =</span> oldfaith)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dhistogram</span>( <span class="sc">~</span> Duration, <span class="at">data =</span> oldfaith)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-oldfaith-histograms" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-oldfaith-histograms-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04-random-variables_files/figure-html/fig-oldfaith-histograms-1.png" class="img-fluid figure-img" data-ref-parent="fig-oldfaith-histograms" width="432"></p>
<p></p><figcaption class="figure-caption">(a) A frequency histogram.</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-oldfaith-histograms-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04-random-variables_files/figure-html/fig-oldfaith-histograms-2.png" class="img-fluid figure-img" data-ref-parent="fig-oldfaith-histograms" width="432"></p>
<p></p><figcaption class="figure-caption">(b) A density histogram.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.1: Two histograms of the Old Faithful eruption data.</figcaption><p></p>
</figure>
</div>
</div>
<p>The density scale is the same scale that is used by <code>gf_dens()</code> and <code>gf_density()</code>, and it is the default scale for histograms created using <code>gf_dhistogram()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(alr4)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dhistogram</span>( <span class="sc">~</span> Duration, <span class="at">data =</span> oldfaith, <span class="at">binwidth =</span> <span class="dv">20</span>, <span class="at">center =</span> <span class="dv">110</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dens</span>( <span class="sc">~</span> Duration, <span class="at">data =</span> oldfaith)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-histogram-and-density" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04-random-variables_files/figure-html/fig-histogram-and-density-1.png" class="img-fluid figure-img" width="432"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.2: A histogram with an overlaid density curve.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The density scale is chosen so that the area of each rectangular bar (width times height) is equal to the proportion of the data set represented by the rectangle.</p>
<div id="exm-old-faithful" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.2 </strong></span><strong>Q.</strong> Use the histogram of Old Faithful eruption times to estimate the proportion of eruptions that last between 100 and 120 seconds.</p>
<p><strong>A.</strong> In our histogram of Old Faithful eruption durations, the bar corresponding to the bin from 100–120 appears to have a height of about 0.09. That gives an area of 0.18 and indicates that approximately 18% of the eruptions last between 100 and 120 seconds.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tally</span>( <span class="sc">~</span> ( <span class="dv">100</span> <span class="sc">&lt;</span> Duration <span class="sc">&amp;</span> Duration <span class="sc">&lt;=</span> <span class="dv">120</span>), <span class="at">data =</span> oldfaith, <span class="at">format =</span> <span class="st">"prop"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(100 &lt; Duration &amp; Duration &lt;= 120)
     TRUE     FALSE 
0.1888889 0.8111111 </code></pre>
</div>
</div>
</div>
<!-- end example -->
<p>The key idea behind the density scale can be expressed as</p>
<div class="boxedText">
<div class="center">
<p>Probability <span class="math inline">\(=\)</span> area</p>
</div>
</div>
<!-- end center -->
<p>This association of area with probability means that the total area of all the bars will always be equal to 1 if we use the density scale.</p>
<p>It also provides us with a way to describe a distribution with a mathematical function.</p>
<div id="def-pdf" class="boxedText theorem definition">
<p><span class="theorem-title"><strong>Definition 4.1 </strong></span>Let <span class="math inline">\(f: \reals \to \reals\)</span> be a function such that</p>
<ol>
<li><span class="math inline">\(f(x) \ge 0\)</span> for all <span class="math inline">\(x\)</span>,</li>
<li><span class="math inline">\(\displaystyle \int_{-\infty}^{\infty} f(x) \; dx = 1\)</span>.</li>
</ol>
<p>Then <span class="math inline">\(f\)</span> is called a <strong>density function</strong> (or probability density function, abbreviated pdf) and describes a continuous random variable <span class="math inline">\(X\)</span> such that</p>
<p><span id="eq-integral-for-probability"><span class="math display">\[
   \Prob(a \le X \le b) = \int_a^b f(x) \; dx \;.
\tag{4.2}\]</span></span></p>
</div>
<!-- end boxedText -->
<div id="exm-triangle" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.3 </strong></span><strong>Q.</strong> Let <span class="math inline">\(f\)</span> be defined by <span class="math display">\[
    f(x) = \begin{cases}  
        1 - |x| &amp; x \in [-1,1] \\
        0 &amp; \mbox{otherwise}\\
    \end{cases}
\]</span> Show that <span class="math inline">\(f\)</span> is a density function. Let <span class="math inline">\(X\)</span> be the associated random variable, and compute the following probabilities:</p>
<ol type="1">
<li><span class="math inline">\(\Prob(X \le 0)\)</span></li>
<li><span class="math inline">\(\Prob(X \le 1)\)</span></li>
<li><span class="math inline">\(\Prob(X \le \frac{1}{2})\)</span></li>
<li><span class="math inline">\(\Prob(-\frac{1}{2} \le X \le \frac{1}{2})\)</span></li>
</ol>
<p><strong>A.</strong> While we could set up integrals for these, it is easier to solve them using geometry.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">makeFun</span>( (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">abs</span>(x)) <span class="sc">*</span> (<span class="fu">abs</span>(x) <span class="sc">&lt;=</span> <span class="dv">1</span>) <span class="sc">~</span> x )</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_fun</span>( <span class="fu">f</span>(x) <span class="sc">~</span> x, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="432"></p>
</div>
</div>
<p>The entire area under the curve can be found as the area of a triangle with base 2 and height 1. <span class="math display">\[
\int_{-\infty}^{\infty} f(x) \; dx
=
\int_{-1}^1 f(x) \; dx
=
\frac 12 \cdot 2 \cdot 1 = 1
\]</span> This implies that <span class="math inline">\(f\)</span> is a density function.</p>
<ol type="1">
<li><p><span class="math inline">\(\Prob(X \le 0) = 1/2\)</span> by symmetry or using <span class="math inline">\(\frac{1}{2} \cdot 1 \cdot 1\)</span> to compute the area of the triangle.</p></li>
<li><p><span class="math inline">\(\Prob(X \le 1) = \int_{-\infty}^{1} f(x) \; dx = \int_{-1}^{1} f(x) \; dx = 1\)</span>.</p></li>
<li><p><span class="math inline">\(\Prob(X \le \frac{1}{2}) = \int_{-\infty}^{1/2} f(x) \; dx = \int_{-1}^{1/2} f(x) \; dx = 1 - \frac{1}{2} \cdot \frac{1}{2} \cdot \frac{1}{2} = \frac78\)</span>.</p></li>
<li><p><span class="math inline">\(\Prob( -\frac{1}{2} \le X \le \frac 12 ) = \int_{-1/2}^{1/2} f(x) \; dx =  1 - \frac{2}{8} = \frac{3}{4}\)</span>.</p></li>
</ol>
<p>We can also let R do (numerical) integration for us. There are two ways to do this. The first method uses the <code>integrate()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>( f, <span class="sc">-</span><span class="cn">Inf</span>, <span class="dv">1</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 with absolute error &lt; 9.2e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this will be more accurate since we aren't asking R to approximate</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># something that we already know is exactly 0</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>( f, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 with absolute error &lt; 1.1e-14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>( f, <span class="sc">-</span>.<span class="dv">5</span>, .<span class="dv">5</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.75 with absolute error &lt; 8.3e-15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># if you just want the value without the text saying how accurate the approximation is</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># here are two equivalent ways to get it</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">value</span>(<span class="fu">integrate</span>( f, <span class="sc">-</span>.<span class="dv">5</span>, .<span class="dv">5</span> ))        <span class="co"># extract the value using val()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.75</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>( f, <span class="sc">-</span>.<span class="dv">5</span>, .<span class="dv">5</span> ) <span class="sc">|&gt;</span> <span class="fu">value</span>()   <span class="co"># |&gt; is the "then" operator</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.75</code></pre>
</div>
</div>
<p>An alternative approach uses <code>antiD()</code> from the <strong><code>mosaicCalc</code></strong> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaicCalc)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fu">antiD</span>( <span class="fu">f</span>(x) <span class="sc">~</span> x)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">F</span>(<span class="dv">1</span>) <span class="sc">-</span> <span class="fu">F</span>(<span class="sc">-</span><span class="dv">1</span>)        <span class="co"># total probability -- better be 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">F</span>(.<span class="dv">5</span>) <span class="sc">-</span> <span class="fu">F</span>(<span class="sc">-</span><span class="dv">1</span>)       <span class="co"># P( -1 &lt;= X &lt;= 0.5 )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.875</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">F</span>(.<span class="dv">5</span>) <span class="sc">-</span> <span class="fu">F</span>(<span class="sc">-</span>.<span class="dv">5</span>)      <span class="co"># P( -.5 &lt;= X &lt;= .5 )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.75</code></pre>
</div>
</div>
</div>
<!-- end example -->
</section>
<section id="kernels" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="kernels"><span class="header-section-number">4.2.2</span> Kernels</h3>
<p>The <strong>kernel</strong> of a continuous random variable is a function that is a constant multiple of the pdf. The reason that these are interesting is that any kernel can be converted into a pdf by dividing by this constant. In particular, if</p>
<p><span class="math display">\[
\int_{-\infty}^{\infty} k(x) \; dx = A \;,
\]</span> then <span class="math inline">\(k\)</span> is the kernel of a random variable with pdf <span class="math display">\[
f(x) = \frac{k(x)}{A} \;.
\]</span></p>
<div id="exm-kernel" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.4 </strong></span><strong>Q.</strong> The kernel of a random variable is given by</p>
<p><span class="math display">\[
k(x) = x^2 \; \boolval{ x \in [0,2] } \; .
\]</span> Determine the pdf.</p>
<p><strong>A.</strong> First we determine the value of the integral <span class="math display">\[
\int_{-\infty}^{\infty} k(x) \; dx \;.
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">makeFun</span>( x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> ( <span class="dv">0</span> <span class="sc">&lt;=</span> x <span class="sc">&amp;</span> x <span class="sc">&lt;=</span> <span class="dv">2</span>) <span class="sc">~</span> x )</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>( k, <span class="dv">0</span>, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2.666667 with absolute error &lt; 3e-14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">antiD</span>(<span class="fu">k</span>(x) <span class="sc">~</span> x, <span class="at">lower.bound =</span> <span class="dv">0</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">K</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.666667</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-kernel-x-squared" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04-random-variables_files/figure-html/fig-kernel-x-squared-1.png" class="img-fluid figure-img" width="432"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.3: A kernel function.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Since the total area is <span class="math inline">\(8/3\)</span>, if <span class="math inline">\(\frac{k(x)}{8/3}\)</span> is the pdf.</p>
</div>
</section>
<section id="cumulative-distribution-functions" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="cumulative-distribution-functions"><span class="header-section-number">4.2.3</span> Cumulative distribution functions</h3>
<!-- % The \textbf{cumulative distribution function} (cdf) returns the probability of being -->
<!-- % less than or equal to some value.  We generally use a capital letter ($F$, $G$, etc.) -->
<!-- % to denote a cdf. -->
<!-- % $$ -->
<!-- % F_X(x) = \Prob( X \le x)  \; . -->
<!-- % $$ -->
<!-- % If we help R choose the anti-derivative, we get a useful function called  -->
<!-- % the \term{cumulative distribution function}, abbreviated cdf. -->
<div class="boxedText">
<p>If <span class="math inline">\(X\)</span> is a random variable, then the <strong>cumulative distribution function</strong> (cdf) for <span class="math inline">\(X\)</span>, often denoted <span class="math inline">\(F_X\)</span>, is the function defined by <span class="math display">\[
F_X(x)  = \Prob(X \le  x)
\]</span> That is, the output of the cdf reports the probability of being below a particular value.</p>
</div>
<!-- end boxedText -->
<p>For a continuous random variable, the cdf is a particular anti-derivative of the pdf. The derivative of the cdf is the pdf.</p>
<div id="exm-kernel-continued" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.5 </strong></span>Continuing with our previous example, if we choose -1 as our lower endpoint, then the anti-derivative will be the cdf.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">makeFun</span>((<span class="dv">1</span> <span class="sc">-</span> <span class="fu">abs</span>(x)) <span class="sc">*</span> (<span class="fu">abs</span>(x) <span class="sc">&lt;=</span> <span class="dv">1</span>) <span class="sc">~</span> x)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fu">antiD</span>( <span class="fu">f</span>(x) <span class="sc">~</span> x, <span class="at">lower.bound =</span> <span class="sc">-</span><span class="dv">1</span>)   <span class="co"># We can use -1 instead of -Inf here.</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">F</span>(<span class="sc">-</span><span class="dv">1</span>)               <span class="co"># this should be 0 since we chose -1 as the lower bound.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">F</span>(<span class="dv">1</span>)                <span class="co"># P(X &lt;= 1); should be 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">F</span>(.<span class="dv">5</span>)               <span class="co"># P(X &lt;= 0.5)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.875</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">F</span>(.<span class="dv">5</span>) <span class="sc">-</span> <span class="fu">F</span>(<span class="sc">-</span>.<span class="dv">5</span>)      <span class="co"># P( -0.5 &lt;= X &lt;= 0.5 )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.75</code></pre>
</div>
</div>
</div>
<!-- end example -->
<!-- ## Working with Probability Density Functions -->
<p>We have already seen that we can use a pdf <span class="math inline">\(f\)</span> to calculate probabilities via integration, and that there is a special anti-derivative of <span class="math inline">\(f\)</span> called the cdf such that the cdf <span class="math inline">\(F\)</span> satisfies <span class="math display">\[
F(x) = \Prob(X \le x)
\]</span> This function can also be used to compute probabilities, since <span class="math display">\[
\Prob(a \le X \le b) = \int_a^b f(x) \; dx = F(b) - F(a)
\]</span> Indeed, once we learn how to get the cdf function in R this will be our primary way to calculate probabilities in applications.</p>
</section>
</section>
<section id="mean-and-variance" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="mean-and-variance"><span class="header-section-number">4.3</span> Mean and Variance</h2>
<section id="the-mean-of-a-random-variable" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="the-mean-of-a-random-variable"><span class="header-section-number">4.3.1</span> The mean of a random variable</h3>
<p>The definition for the mean of a random variable will be motivated by the calculation of a mean of some data.</p>
<div id="exm-gpa" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.6 </strong></span><strong>Q.</strong> Suppose a student has taken <span class="math inline">\(10\)</span> courses and received <span class="math inline">\(5\)</span> A’s, <span class="math inline">\(4\)</span> B’s, and <span class="math inline">\(1\)</span> C. Using the traditional numerical scale where an A is worth <span class="math inline">\(4\)</span>, a B is worth <span class="math inline">\(3\)</span>, and a C is worth <span class="math inline">\(2\)</span>, what is this student’s GPA (grade point average)?</p>
<p><strong>A.</strong> The first thing to notice is that <span class="math inline">\(\frac{4 + 3 + 2}{3} = 3\)</span> is <em>not</em> correct. We cannot simply add up the values and divide by the number of values. Clearly this student should have a GPA that is higher than <span class="math inline">\(3.0\)</span>, since there were more A’s than C’s.</p>
<p>Consider now a correct way to do this calculation:</p>
<p><span class="math display">\[
\begin{aligned}
    \mbox{GPA} &amp;= \frac{4 + 4 + 4 + 4 + 4 + 3 + 3 + 3 + 3 + 2}{10}
    \\[2mm]
    &amp; = \frac{5\cdot 4 + 4\cdot 3 + 1 \cdot 2}{10} \\[1mm]
    &amp; = \frac{5}{10} \cdot 4 + \frac{4}{10}\cdot 3 + \frac{1}{10} \cdot 2 \\
    &amp; = 4 \cdot \frac{5}{10} + 3 \cdot \frac{4}{10} + 2 \cdot \frac{1}{10} \\
    &amp; =  3.4 \;.
\end{aligned}
\]</span></p>
</div>
<p>The key idea here is that the mean is a <strong>sum of values times probabilities</strong>.</p>
<p><span class="math display">\[
\mbox{mean} = \sum \mbox{value} \cdot \mbox{probability}
\]</span> For a discrete random variable this translates to <span class="math display">\[
\E(X) = \sum x f(x)
\]</span> where the sum is taken over all possible values of <span class="math inline">\(X\)</span>.</p>
<p>The mean of a random variable also goes by another name: <strong>expected value</strong>. We can denote the mean of <span class="math inline">\(X\)</span> by either <span class="math inline">\(\mu_X\)</span> or <span class="math inline">\(\E(X)\)</span>.</p>
<div id="exm-mean-exp-value-1" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.7 </strong></span>Let <span class="math inline">\(X\)</span> be discrete random variable with probabilities given in the table below.</p>
<div class="center">
<table class="table">
<colgroup>
<col style="width: 29%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<tbody>
<tr class="odd">
<td rowspan="2">value of <span class="math inline">\(X\)</span></td>
<td rowspan="2">0</td>
<td rowspan="2">1</td>
<td rowspan="2">2</td>
</tr>
<tr class="even">
</tr>
<tr class="odd">
<td rowspan="2">probability</td>
<td rowspan="2">0.2</td>
<td rowspan="2">0.5</td>
<td rowspan="2">0.3</td>
</tr>
<tr class="even">
</tr>
</tbody>
</table>
</div>
<!-- end center -->
<p><strong>Q.</strong> What is the mean (expected value) of <span class="math inline">\(X\)</span>?</p>
<p><strong>A.</strong> <span class="math inline">\(E(X) = 0 \cdot 0.2 + 1 \cdot 0.5 + 2 \cdot 0.3 = 0.5 + 0.6 = 1.1\)</span> This value reflects the fact that the random variable is larger than 1 a bit more often than it is less than 1.</p>
</div>
<!-- end example -->
<div id="exm-raffle" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.8 </strong></span>A local charity is holding a raffle. They are selling <span class="math inline">\(1000\)</span> raffle tickets for $<span class="math inline">\(5\)</span> each. The owners of five of the raffle tickets will win a prize. The five prizes are valued at $<span class="math inline">\(25\)</span>, $<span class="math inline">\(50\)</span>, $<span class="math inline">\(100\)</span>, $<span class="math inline">\(1000\)</span>, and $<span class="math inline">\(2000\)</span>. Let <span class="math inline">\(X\)</span> be the value of the prize associated with a random raffle ticket (<span class="math inline">\(0\)</span> for non-winning tickets). Then:</p>
<div class="itemize">
<ul>
<li><span class="math inline">\(\evProb{the ticket wins a prize} = \Prob(X &gt; 0) = 5/1000\)</span>.</li>
<li><span class="math inline">\(\evProb{the ticket wins the grand prize} = \Prob(X = 2000) = 1/1000\)</span>.</li>
<li><span class="math inline">\(\evProb{the ticket wins a prize worth more than \$75} = \Prob(X &gt; 75) = 3/1000\)</span>.</li>
</ul>
</div>
<!-- end itemize -->
<p>The expected value of a ticket is</p>
<p><span class="math display">\[
  0 \cdot\frac{995}{1000}
  + 25 \cdot\frac{1}{1000}
  + 50 \cdot\frac{1}{1000}
  + 100 \cdot\frac{1}{1000}
  + 1000 \cdot\frac{1}{1000}
  + 2000 \cdot\frac{1}{1000}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="dv">25</span> <span class="sc">*</span> .<span class="dv">001</span> <span class="sc">+</span> <span class="dv">50</span> <span class="sc">*</span> <span class="fl">0.001</span> <span class="sc">+</span> <span class="dv">100</span> <span class="sc">*</span> <span class="fl">0.001</span> <span class="sc">+</span> <span class="dv">1000</span> <span class="sc">*</span> <span class="fl">0.001</span> <span class="sc">+</span> <span class="dv">2000</span> <span class="sc">*</span> <span class="fl">0.001</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.175</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># R can help us set up this sum:</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">1000</span>, <span class="dv">2000</span>) <span class="sc">*</span> <span class="fl">0.001</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.175</code></pre>
</div>
</div>
</div>
<!-- end example -->
<p>When working with a continuous random variable, we replace the sum with an integral and replace the probabilities with our density function to get the following definition:</p>
<p><span class="math display">\[
\E(X) = \mu_X = \int_{-\infty}^{\infty} x f(x) \; dx
\]</span></p>
<p>If you recall doing center of mass problems you may recognize this integral as the first moment. (For pdfs, we don’t need to divide by the “mass” because the total “mass” is the area under the curve, which will always be 1 for a random variable).</p>
<p>Note: It is possible that the integral used to define the mean will fail to converge. In that case, we say that the random variable has no mean or that the mean fails to exist.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<div id="exm-mean-triangle" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.9 </strong></span><strong>Q.</strong> Compute the mean of our triangle distribution from <a href="#exm-triangle-in-R">Example&nbsp;<span>4.13</span></a>.</p>
<p><strong>A.</strong> We simply compute the integral from the definition.</p>
<p><span class="math display">\[
\begin{aligned}
\E(X) &amp; = \int_{-1}^{1} x f(x) \; dx
\\
    &amp; = \int_{-1}^{0} x (x-1) \; dx + \int_{0}^1 x ( 1-x ) \; dx
    \\
    &amp; = \int_{-1}^{0} x^2-x \; dx + \int_{0}^1 x-x^2  \; dx  
    \\
    &amp; = \left. \frac{x^3}{3} - \frac{x^2}{2} \right|_{-1}^0
    + \left. \frac{x^2}{2} - \frac{x^3}{3} \right|_{0}^1
    \\
    &amp; = \frac13 - \frac{1}{2} + \frac{1}{2} - \frac13 = 0
\end{aligned}
\]</span></p>
<p>This isn’t surprising, by symmetry we would expect this result.</p>
<p>We could also calculate this numerically in R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">makeFun</span>( (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">abs</span>(x)) <span class="sc">*</span> (<span class="fu">abs</span>(x) <span class="sc">&lt;=</span> <span class="dv">1</span>) <span class="sc">~</span> x)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>xf <span class="ot">&lt;-</span> <span class="fu">makeFun</span>( x <span class="sc">*</span> <span class="fu">f</span>(x) <span class="sc">~</span> x )</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(xf, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0 with absolute error &lt; 3.7e-15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fu">antiD</span>( x <span class="sc">*</span> <span class="fu">f</span>(x) <span class="sc">~</span> x, <span class="at">lower.bound =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">F</span>(<span class="sc">-</span><span class="dv">1</span>)  <span class="co"># should be 0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">F</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</div>
<!-- end example -->
</section>
<section id="variance" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="variance"><span class="header-section-number">4.3.2</span> Variance</h3>
<p>Arguing similarly, we can compute the variance of a discrete or continuous random variable using</p>
<div class="itemize">
<ul>
<li><p>discrete: <span class="math inline">\(\Var(X) = \sigma^2_X = \sum_x (x-\mu_X)^2\)</span></p></li>
<li><p>continuous: <span class="math inline">\(\Var(X) = \sigma^2_X = \int_{-\infty}^{\infty} (x-\mu_X)^2 f(x) \; dx\)</span></p></li>
</ul>
</div>
<!-- end itemize -->
<p>These can be combined into a single definition by writing <span class="math display">\[
\Var(X) = \E((X - \mu_X)^2) \;.
\]</span></p>
<p>Note: It is possible that the sum or integral used to define the mean (or the variance) will fail to converge. In that case, we say that the random variable has no mean (or variance) or that the mean (or variance) fails to exist.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<div id="exm-var-triangle" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.10 </strong></span><strong>Q.</strong> Compute the variance of the triangle random variable from the <a href="#exm-triangle">Example&nbsp;<span>4.3</span></a>.</p>
<p><strong>A.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">makeFun</span>( (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">abs</span>(x)) <span class="sc">*</span> (<span class="fu">abs</span>(x) <span class="sc">&lt;=</span> <span class="dv">1</span>) <span class="sc">~</span> x)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>xxf <span class="ot">&lt;-</span> <span class="fu">makeFun</span>( (x<span class="dv">-0</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">f</span>(x) <span class="sc">~</span> x )</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(xxf, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.1666667 with absolute error &lt; 1.9e-15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>G <span class="ot">&lt;-</span> <span class="fu">antiD</span>( (x<span class="dv">-0</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">f</span>(x) <span class="sc">~</span> x)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">G</span>(<span class="dv">1</span>) <span class="sc">-</span> <span class="fu">G</span>(<span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1666667</code></pre>
</div>
</div>
</div>
<!-- end example -->
<p>Some simple algebraic manipulations of the sum or integral above shows that</p>
<p><span id="eq-var-shortcut"><span class="math display">\[
\begin{aligned}
\Var(X) &amp;= \E(X^2) - \E(X)^2
\end{aligned}
\tag{4.3}\]</span></span></p>
<div id="exm-compute-mean-var" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.11 </strong></span><strong>Q.</strong> Compute the mean and variance of the random variable with pdf given by</p>
<p><span class="math display">\[
g(x) = \frac{3x^2}{8} \boolval{x \in[0,2]} \;.
\]</span></p>
<p>This is the pdf computed in <a href="#exm-kernel">Example&nbsp;<span>4.4</span></a>.</p>
<p><strong>A.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">makeFun</span>( (<span class="dv">3</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">8</span> ) <span class="sc">*</span> (<span class="dv">0</span> <span class="sc">&lt;=</span> x <span class="sc">&amp;</span> x <span class="sc">&lt;=</span> <span class="dv">2</span>) <span class="sc">~</span> x )</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">antiD</span>( x <span class="sc">*</span> <span class="fu">g</span>(x) <span class="sc">~</span> x, <span class="at">lower.bound =</span> <span class="dv">0</span>)(<span class="dv">2</span>)  <span class="co"># all in one step instead of defining F or G</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">antiD</span>( (x <span class="sc">-</span> m)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">g</span>(x) <span class="sc">~</span> x, <span class="at">m =</span> m, <span class="at">lower.bound =</span> <span class="dv">0</span>)(<span class="dv">2</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>v</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># here's the alternate computation</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">antiD</span>( x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">g</span>(x) <span class="sc">~</span> x, <span class="at">lower.bound =</span> <span class="dv">0</span>)(<span class="dv">2</span>) <span class="sc">-</span> m<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.15</code></pre>
</div>
</div>
</div>
<!-- end example -->
<p>As with data, the standard deviation is the square root of the variance.</p>
</section>
<section id="quantiles" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="quantiles"><span class="header-section-number">4.3.3</span> Quantiles</h3>
<p>Quantiles solve equations of the form</p>
<p><span class="math display">\[
\int_{-\infty}^x f(t) \; dt = F(x) = \Prob(X \le x) = q
\]</span></p>
<p>where <span class="math inline">\(q\)</span> is known and <span class="math inline">\(x\)</span> is unknown. So the 50th percentile (which is the 0.5-quantile or the median) is the number such that</p>
<p><span class="math display">\[
\Prob(X \le x) = 0.5 \;.
\]</span></p>
<div id="exm-triangle-quantiles" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.12 </strong></span><strong>Q.</strong> What is the 25th percentile of the triangle distribution in <a href="#exm-triangle">Example&nbsp;<span>4.3</span></a>?</p>
<p><strong>A.</strong> We need to solve for <span class="math inline">\(x\)</span> in the following equation:</p>
<p><span class="math display">\[
0.25 = \Prob(X \le x)  \; .
\]</span> We can do this by working out the integral involved:</p>
<p><span class="math display">\[
\begin{aligned}
0.25 &amp;= \int_{-1}^{x} 1 - |t| \; dt
    \\
     &amp;= \int_{-1}^{x} 1 + t \; dt
     \\
     &amp;=  \left( t + t^2/2 \right) |_{-1}^{x}
     \\
     &amp;=   x + x^2/2 + 1 - 1^2/2  
     \\
     &amp;=  x + x^2/2 + 1/2
     \\
     0 &amp; =  x^2/2 + x + 1/4
     \\
     0 &amp; =  2x^2 + 4x + 1
\end{aligned}
\]</span></p>
<p>So by the quadratic formula, <span class="math inline">\(x = \frac{1}{2} \sqrt{2} - 1 = -0.2928932\)</span>.</p>
<p>We can check this by evaluating the cdf.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">makeFun</span>( (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">abs</span>(x)) <span class="sc">*</span> (<span class="fu">abs</span>(x) <span class="sc">&lt;=</span> <span class="dv">1</span>) <span class="sc">~</span> x )</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fu">antiD</span>(<span class="fu">f</span>(x) <span class="sc">~</span> x, <span class="at">lower.bound =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">2</span>) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">F</span>(x) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.25</code></pre>
</div>
</div>
<p>This could also be done geometrically by solving <span class="math inline">\(\frac{1}{2} y^2 = \frac14\)</span> and letting <span class="math inline">\(x = -1 + y\)</span>.</p>
</div>
<!-- end example -->
</section>
</section>
<section id="some-important-families-of-distributions" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="some-important-families-of-distributions"><span class="header-section-number">4.4</span> Some Important Families of Distributions</h2>
<p>For now, we will consider only distributions of continuous random variables (probability density functions). We will leave set aside discrete random variables (probability mass function) until quite a bit later in the course.</p>
<p>A family of distributions is a collection of distributions that share some common features. Typically, these are described by giving a pdf that has one or more <strong>parameters</strong>. A parameter is simply a number that describes (a feature of) a distribution that distinguishes between members of the family. In this section we describe briefly some of the important distributions and how to work with them in R</p>
<section id="triangle-distributions" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="triangle-distributions"><span class="header-section-number">4.4.1</span> Triangle Distributions</h3>
<p>The example distribution in the previous section is usually referred to as a triangle distribution (or triangular distribution) because of the shape of its pdf. There are, of course, many triangle distributions. A triangle distribution is specified with three numbers: <span class="math inline">\(a\)</span>, the minimum; <span class="math inline">\(b\)</span>, the maximum, and <span class="math inline">\(c\)</span>, the location of the peak. A triangle distribution is symmetric if the peak is halfway between the minimum and maximum (<span class="math inline">\(c = \frac{a+b}{2}\)</span>).</p>
<p>When <span class="math inline">\(X\)</span> is a random variable with a triangle distribution, we will write <span class="math inline">\(X \sim\Tri(a,b,c)\)</span>. For many of the most common distributions, R has several functions that facilitate computation with those distributions. The triangle distributions are not in the base R distribution, but they can be added by requiring the <strong><code>triangle</code></strong> package.</p>
<p>For each distribution, there are four functions in R that always start with a single letter followed by a name for the distribution. In the case of the triangle distributions, these functions are</p>
<div id="tbl-triangle-in-R" class="anchored">
<table class="table">
<caption>Table&nbsp;4.1: Triangle distributions in R</caption>
<colgroup>
<col style="width: 21%">
<col style="width: 78%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>What it does</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>dtriangle(x, a, b, c)</code></td>
<td>Computes value of the pdf at <code>x</code>.</td>
</tr>
<tr class="even">
<td><code>ptriangle(q, a, b, c)</code></td>
<td>Computes value of the cdf at <code>x</code>, i.e., <span class="math inline">\(\Prob(X \le \texttt{q})\)</span>.</td>
</tr>
<tr class="odd">
<td><code>qtriangle(p, a, b, c)</code></td>
<td>Computes quantiles, that is a value <span class="math inline">\(q\)</span> so that <span class="math inline">\(\Prob(X \le \texttt{q}) = \texttt{p}\)</span>.</td>
</tr>
<tr class="even">
<td><code>rtriangle(n, a, b, c)</code></td>
<td>Randomly samples <code>n</code> values from the <span class="math inline">\(\Tri(\texttt{a},\texttt{b},\texttt{c})\)</span> distribution.</td>
</tr>
</tbody>
</table>
</div>
<div id="exm-triangle-in-R" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.13 </strong></span><strong>Q.</strong> Let <span class="math inline">\(X \sim\Tri(0,4,1)\)</span>. Use R to answer the following questions.</p>
<div class="enumerate">
<ol type="a">
<li>Plot the pdf for <span class="math inline">\(X\)</span>.</li>
<li>What is <span class="math inline">\(\Prob(X \le 1)\)</span>?</li>
<li>What is <span class="math inline">\(\Prob(X \le 2)\)</span>?</li>
<li>What is the median of <span class="math inline">\(X\)</span>?</li>
<li>What is the mean of <span class="math inline">\(X\)</span>?</li>
</ol>
</div>
<!-- end enumerate -->
<p><strong>A.</strong> The <code>gf_dist()</code> function in the <strong>ggformula</strong> package allows us to graph the pdf for any function R knows how to work with in the standard way. For example, here is a plot of the pdf of a <span class="math inline">\(\Tri(0, 4, 1)\)</span>-distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(triangle)      <span class="co"># a package that knows about triangle distributions</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"triangle"</span>, <span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">4</span>, <span class="at">c =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="432"></p>
</div>
</div>
<p>Here is the R code to answer the remaining questions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ptriangle</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">1</span>)   <span class="co"># P(X &lt;= 1); notice that his is NOT 1/2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ptriangle</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">1</span>)   <span class="co"># P(X &lt;= 2); also NOT 1/2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6666667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtriangle</span>(<span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">1</span>) <span class="co"># median is the 0.5-quantile</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.55051</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>T <span class="ot">&lt;-</span> <span class="fu">antiD</span>( x <span class="sc">*</span> <span class="fu">dtriangle</span>(x, <span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">1</span>) <span class="sc">~</span> x, <span class="at">lower.bound =</span> <span class="dv">0</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">T</span>(<span class="dv">4</span>)                    <span class="co"># mean of X</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.666667</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>( <span class="fu">makeFun</span>( x <span class="sc">*</span> <span class="fu">dtriangle</span>(x, <span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">1</span>) <span class="sc">~</span> x) , <span class="dv">0</span>, <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.666667 with absolute error &lt; 1.9e-14</code></pre>
</div>
</div>
</div>
<!-- end example -->
</section>
<section id="uniform-distributions" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="uniform-distributions"><span class="header-section-number">4.4.2</span> Uniform Distributions</h3>
<p>A uniform distribution is a described by a constant function over some interval. Its shape is a rectangle. This makes it particularly easy to calculate probabilities for a uniform distribution. Despite its simplicity, the family of uniform distributions has many applications.</p>
<p>We will let <span class="math inline">\(X \sim \Unif(a,b)\)</span> denote that <span class="math inline">\(X\)</span> is a uniform random variable on the interval from <span class="math inline">\(a\)</span> to <span class="math inline">\(b\)</span>. In R, the parameters <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are given more meaningful names: <code>min</code> and <code>max</code>. We can use the following code to graph the <span class="math inline">\(\Unif (1,4)\)</span> distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"unif"</span>, <span class="at">min =</span> <span class="dv">1</span>, <span class="at">max =</span> <span class="dv">4</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">6</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="432"></p>
</div>
</div>
<p>Notice that the width of the non-zero portion of the pdf is 3, so the height must be <span class="math inline">\(1/3\)</span>.</p>
<p>Probabilities involving uniform distributions are easily calculated using simple geometry, but R also provides several functions for working with uniform probability distributions.</p>
<div id="tbl-unif" class="anchored">
<table class="table">
<caption>Table&nbsp;4.2: Uniform distributions in R</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 80%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>What it does</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>dunif(x, min, max)</code></td>
<td>Computes value of the pdf at <code>x</code>.</td>
</tr>
<tr class="even">
<td><code>punif(q, min, max)</code></td>
<td>Computes value of the cdf at <code>x</code>, i.e., <span class="math inline">\(\Prob(X \le \texttt{q})\)</span>.</td>
</tr>
<tr class="odd">
<td><code>qunif(p, min, max)</code></td>
<td>Computes quantiles, that is a value <span class="math inline">\(q\)</span> so that <span class="math inline">\(\Prob(X \le \texttt{q}) = \texttt{p}\)</span>.</td>
</tr>
<tr class="even">
<td><code>runif(n, min, max)</code></td>
<td>Randomly samples <code>n</code> values from the <span class="math inline">\(\Unif(\texttt{min},\texttt{max})\)</span> distribution.</td>
</tr>
</tbody>
</table>
</div>
<p>Notice the pattern to these names. They start with the same letters as the functions for the triangle distributions, but replace <code>triangle</code> with <code>unif</code>. <em>There are similar functions for all of the distributions in this chapter.</em></p>
<div id="exm-unif-in-R" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.14 </strong></span><strong>Q.</strong> Let <span class="math inline">\(X \sim \Unif(1,4)\)</span>. Use R to calculate the following values and check the values using geometry:</p>
<div class="enumerate">
<ol type="a">
<li><span class="math inline">\(\Prob(X \le 2)\)</span></li>
<li>the 80th percentile of the distribution</li>
</ol>
</div>
<!-- end enumerate -->
<p><strong>A.</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">punif</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">4</span>)   <span class="co"># P(X &lt;= 2 )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3333333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">2-1</span>) <span class="sc">*</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>    <span class="co"># P(X &lt;= 2 ) using area</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3333333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qunif</span>(.<span class="dv">8</span>, <span class="dv">1</span>,<span class="dv">4</span>) <span class="co"># 80th percentile</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.4</code></pre>
</div>
</div>
<p>We could also get the 80th percentile by solving the equation <span class="math inline">\(\frac{x-1}{3} = 0.8\)</span>. From this we get <span class="math inline">\(\frac{x}{3} = 0.8 + 1/3\)</span>, so <span class="math inline">\(x = 3 ( 0.8 + 1/3) = 2.4 + 1 = 3.4\)</span>.</p>
</div>
<!-- end example -->
</section>
<section id="exponential-distributions" class="level3" data-number="4.4.3">
<h3 data-number="4.4.3" class="anchored" data-anchor-id="exponential-distributions"><span class="header-section-number">4.4.3</span> Exponential Distributions</h3>
<p>The exponential distributions are useful for modeling the time until some “event” occurs. The model is based on the assumptions that</p>
<div class="enumerate">
<ol type="a">
<li><p>The probability of an event occurring in any small interval of time is proportional to the length of the time interval. The constant of proportionality is the rate parameter, usually denoted by <span class="math inline">\(\lambda\)</span>.</p></li>
<li><p>The probabilities of events occurring in two small non-overlapping intervals are independent.</p></li>
</ol>
</div>
<!-- end enumerate -->
<div id="exm-exponential-dist" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.15 </strong></span>Here are some situations that might be well modeled by an exponential distribution:</p>
<div class="enumerate">
<ol type="a">
<li><p>The time until the next radioactive decay event is detected on a Geiger counter</p></li>
<li><p>The time until a space satellite is struck by a meteor (or some other space junk) and disabled.</p>
<p>The model would be good if (over some time span of interest) the chances of getting struck are always the same. It would not be such a good model if the satellite moves through time periods of relatively higher and then relatively lower chances of being struck (perhaps because we pass through regions of more or less space debris at different times of the year.)</p></li>
<li><p>The lifetime of some manufactured device.</p>
<p>This is a pretty simple model (we’ll learn better ones later) and most often is <em>too</em> simple to describe the interesting features of the lifetime of a device. In this model, failure is due to some external thing “happening to” the device; the device itself does not wear (or improve) over time.</p></li>
</ol>
</div>
<!-- end enumerate -->
</div>
<!-- end example -->
<p>We will let <span class="math inline">\(X \sim \Exp(\lambda)\)</span> denote that <span class="math inline">\(X\)</span> has an exponential distribution with rate parameter <span class="math inline">\(\lambda\)</span>. The kernel of such a distribution is <span class="math display">\[
k(x; \lambda) = e^{-\lambda x} \; \boolval{x \ge 0}
\]</span> Notice that the function describing this distribution is defined only for x-values that are real numbers greater than or equal to zero (in mathematical notation, the interval <span class="math inline">\([0, \infty)\)</span>.) This interval is sometimes called the ``support” of the distribution. When using probability distributions to model data, it’s important to think about whether the support of the distribution matches well with the range of possible values observed in the data.</p>
<p>The exponential distribution function is a pretty easy function to integrate, but R provides the now familiar functions to make things even easier.</p>
<div id="tbl-exp" class="anchored">
<table class="table">
<caption>Table&nbsp;4.3: Exponential distributions in R</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 79%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>What it does</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>dexp(x, rate)</code></td>
<td>Computes value of the pdf at <code>x</code>.</td>
</tr>
<tr class="even">
<td><code>pexp(q, rate)</code></td>
<td>Computes value of the cdf at <code>q</code>, i.e., <span class="math inline">\(\Prob(X \le \texttt{q})\)</span>.</td>
</tr>
<tr class="odd">
<td><code>qexp(p, rate)</code></td>
<td>Computes quantiles, that is a value <span class="math inline">\(q\)</span> so that <span class="math inline">\(\Prob(X \le \texttt{q}) = \texttt{p}\)</span>.</td>
</tr>
<tr class="even">
<td><code>rexp(n, rate)</code></td>
<td>Randomly samples <code>n</code> values from the <span class="math inline">\(\Exp(\lambda)\)</span> distribution where <span class="math inline">\(\lambda\)</span> = <code>rate</code>.</td>
</tr>
</tbody>
</table>
</div>
<!-- \iffalse -->
<!-- \begin{boxedText} -->
<!--    We will write $X \sim \Exp(\lambda)$ to indicate that the random variable $X$ has  -->
<!--    an exponential distribution with rate parameter $\lambda$. -->
<!--    \begin{center} -->
<!--        \begin{tabular}{lll} -->
<!--            \hline  -->
<!--            parameter & $\lambda$ & \texttt{rate} -->
<!--            \\ -->
<!--            kernel & $e^{-\lambda x}$ -->
<!--            \\ -->
<!--            pdf & $f(x; \lambda) = \lambda e^{-\lambda x} \boolval{x\ge 0}$  -->
<!--            & \texttt{dexp(x,rate)} -->
<!--            \\ -->
<!-- %          mean & $\frac{1}{\lambda}$ -->
<!-- %          \\ -->
<!-- %          variance & $\frac{1}{\lambda^2}$ -->
<!-- %          \\  -->
<!-- %          \hline -->
<!--        \end{tabular} -->
<!--    \end{center} -->
<!-- \end{boxedText} -->
<!-- \fi -->
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"exp"</span>, <span class="at">rate =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-exponential-4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04-random-variables_files/figure-html/fig-exponential-4-1.png" class="img-fluid figure-img" width="432"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.4: An exponential distribution with rate = 4.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="gamma-and-weibull-distributions" class="level3" data-number="4.4.4">
<h3 data-number="4.4.4" class="anchored" data-anchor-id="gamma-and-weibull-distributions"><span class="header-section-number">4.4.4</span> Gamma and Weibull Distributions</h3>
<p>The Gamma and Weibull families of distributions are generalizations of the exponential distribution. Each family has two parameters, a rate parameter as in the exponential distribution, and an additional parameter called the shape parameter (denoted by <span class="math inline">\(\alpha\)</span> below). The reciprocal of the rate parameter is called the scale parameter. For the Gamma distribution, R lets us use either rate or scale (and the default is rate). For the Weibull, we must use the scale.</p>
<table class="table">
<caption>Kernels for Gamma and Weibull distributions.</caption>
<colgroup>
<col style="width: 41%">
<col style="width: 59%">
</colgroup>
<thead>
<tr class="header">
<th rowspan="2">distribution</th>
<th rowspan="2">kernel</th>
</tr>
<tr class="odd">
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\Gamm(\alpha, \lambda)\)</span></td>
<td><span class="math inline">\(k(x) = x^{\alpha} e^{-\lambda x}\)</span> for <span class="math inline">\(x \ge 0\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\Weibull(\alpha, \lambda)\)</span></td>
<td><span class="math inline">\(k(x) = x^{\alpha} e^{-\lambda x^{\alpha}}\)</span> for <span class="math inline">\(x &gt; 0\)</span></td>
</tr>
</tbody>
</table>
<p>Both families of distributions are supported on the interval <span class="math inline">\([0, \infty\)</span>.) For the most part, we won’t use these formulas in calculations, preferring to let R do the work for us. However, notice that each of these distributions has a pdf that allows for relatively simple integration. For the Gamma distributions, we need to use integration by parts (<span class="math inline">\(\alpha- 1\)</span> times). For the Weibull distributions we can use a substitution: <span class="math inline">\(u = x^{\alpha}\)</span>. In each case, when <span class="math inline">\(\alpha= 1\)</span> we get an exponential distribution.</p>
<p>The now familiar functions are available for each of these distributions.</p>
<table class="table">
<caption>Gamma distributions in R.</caption>
<colgroup>
<col style="width: 17%">
<col style="width: 82%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>What it does</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>dgamma(x, shape, rate = 1, scale = 1/rate)</code></td>
<td>Computes value of the pdf at <code>x</code>.</td>
</tr>
<tr class="even">
<td><code>pgamma(q, shape, rate = 1, scale = 1/rate)</code></td>
<td>Computes value of the cdf at <code>q</code>, i.e., <span class="math inline">\(\Prob(X \le \texttt{q})\)</span>.</td>
</tr>
<tr class="odd">
<td><code>qgamma(p, shape, rate = 1, scale = 1/rate)</code></td>
<td>Computes quantiles, that is a value <span class="math inline">\(q\)</span> so that <span class="math inline">\(\Prob(X \le \texttt{q}) = \texttt{p}\)</span>.</td>
</tr>
<tr class="even">
<td><code>rgamma(n, shape, rate, scale = 1/rate)</code></td>
<td>Randomly samples <code>n</code> values from the Gamma distribution.</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>Weibull distributions in R.</caption>
<colgroup>
<col style="width: 33%">
<col style="width: 66%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>What it does</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>dweibull(x, shape, scale = 1)</code></td>
<td>Computes value of the pdf at <code>x</code>.</td>
</tr>
<tr class="even">
<td><code>pweibull(q, shape, scale = 1)</code></td>
<td>Computes value of the cdf at <code>q</code>, i.e., <span class="math inline">\(\Prob(X \le \texttt{q})\)</span>.</td>
</tr>
<tr class="odd">
<td><code>qweibull(p, shape, scale = 1)</code></td>
<td>Computes quantiles, that is a value <span class="math inline">\(q\)</span> so that <span class="math inline">\(\Prob(X \le \texttt{q}) = \texttt{p}\)</span>.</td>
</tr>
<tr class="even">
<td><code>rweibull(n, shape, scale = 1)</code></td>
<td>Randomly samples <code>n</code> values from the Weibull distribution.</td>
</tr>
</tbody>
</table>
<!-- $\Gamm(\alpha, \lambda)$ or                               | -->
<!-- |                                               | $\Weibull(\alpha, \beta)$ distribution where.             | -->
<!-- |                                               |   $\alpha$ = `shape`, $\lambda$ = `rate`,                 | -->
<!-- |                                               |   and $\beta$ = `scale`                                   | -->
<!-- +-----------------------------------------------+-----------------------------------------------------------+ -->
<p>Like the exponential distributions, these distributions are skewed and only take on positive values.<br>
These distributions arise in many applications, including as more general models for lifetime. As the pictures below indicate, the shape and scale parameters are aptly named.</p>
<div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"gamma"</span>, <span class="at">params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">2</span>, <span class="at">rate =</span> <span class="dv">1</span>), <span class="at">title =</span> <span class="st">"Gamma(2,1)"</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"gamma"</span>, <span class="at">params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">5</span>, <span class="at">rate =</span> <span class="dv">1</span>), <span class="at">title =</span> <span class="st">"Gamma(5,1)"</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"gamma"</span>, <span class="at">params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="dv">10</span>), <span class="at">title =</span> <span class="st">"Gamma(2,10)"</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"gamma"</span>, <span class="at">params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">5</span>, <span class="at">scale =</span> <span class="dv">10</span>), <span class="at">title =</span> <span class="st">"Gamma(5,10)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-gamma-dists" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-gamma-dists-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04-random-variables_files/figure-html/fig-gamma-dists-1.png" class="img-fluid figure-img" data-ref-parent="fig-gamma-dists" width="432"></p>
<p></p><figcaption class="figure-caption">(a)</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-gamma-dists-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04-random-variables_files/figure-html/fig-gamma-dists-2.png" class="img-fluid figure-img" data-ref-parent="fig-gamma-dists" width="432"></p>
<p></p><figcaption class="figure-caption">(b)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-gamma-dists-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04-random-variables_files/figure-html/fig-gamma-dists-3.png" class="img-fluid figure-img" data-ref-parent="fig-gamma-dists" width="432"></p>
<p></p><figcaption class="figure-caption">(c)</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-gamma-dists-4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04-random-variables_files/figure-html/fig-gamma-dists-4.png" class="img-fluid figure-img" data-ref-parent="fig-gamma-dists" width="432"></p>
<p></p><figcaption class="figure-caption">(d)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.5: Some example gamma distributions.</figcaption><p></p>
</figure>
</div>
</div>
<div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"weibull"</span>, <span class="at">params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="dv">1</span>),<span class="at">title =</span> <span class="st">"Weibull(2,1)"</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"weibull"</span>, <span class="at">params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">5</span>, <span class="at">scale =</span> <span class="dv">1</span>),<span class="at">title =</span> <span class="st">"Weibull(5,1)"</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"weibull"</span>, <span class="at">params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="dv">10</span>),<span class="at">title =</span> <span class="st">"Weibull(2,10)"</span>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"weibull"</span>, <span class="at">params =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">5</span>, <span class="at">scale =</span> <span class="dv">10</span>),<span class="at">title =</span> <span class="st">"Weibull(5,10)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-weibull-dists" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-weibull-dists-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04-random-variables_files/figure-html/fig-weibull-dists-1.png" class="img-fluid figure-img" data-ref-parent="fig-weibull-dists" width="432"></p>
<p></p><figcaption class="figure-caption">(a)</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-weibull-dists-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04-random-variables_files/figure-html/fig-weibull-dists-2.png" class="img-fluid figure-img" data-ref-parent="fig-weibull-dists" width="432"></p>
<p></p><figcaption class="figure-caption">(b)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-weibull-dists-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04-random-variables_files/figure-html/fig-weibull-dists-3.png" class="img-fluid figure-img" data-ref-parent="fig-weibull-dists" width="432"></p>
<p></p><figcaption class="figure-caption">(c)</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-weibull-dists-4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04-random-variables_files/figure-html/fig-weibull-dists-4.png" class="img-fluid figure-img" data-ref-parent="fig-weibull-dists" width="432"></p>
<p></p><figcaption class="figure-caption">(d)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.6: Some example Weibull distributions.</figcaption><p></p>
</figure>
</div>
</div>
</section>
<section id="normal-distributions" class="level3" data-number="4.4.5">
<h3 data-number="4.4.5" class="anchored" data-anchor-id="normal-distributions"><span class="header-section-number">4.4.5</span> Normal Distributions</h3>
<p>We come now to the most famous family of distributions – the normal distributions (also called Gaussian distributions). These symmetric distributions have the famous “bell shape” and are described by two parameters, the mean <span class="math inline">\(\mu\)</span> and the standard deviation <span class="math inline">\(\sigma\)</span>. The pdf for a <span class="math inline">\(\Norm(\mu, \sigma)\)</span> distribution is</p>
<p><span id="eq-normal-pdf"><span class="math display">\[
f(x) = \frac{ 1}{\sigma\sqrt{2\pi}} e^{-\frac{1}{2}\left(\frac{x-\mu}{\sigma}\right)^2}
\tag{4.4}\]</span></span></p>
<!-- +---------------------------------------+--------------------------------------------------------+ -->
<!-- | distribution                          | pdf                                                    | -->
<!-- +=======================================+========================================================+ -->
<!-- |  $\displaystyle \Norm(\mu, \sigma)$    | $\displaystyle f(x) =$                                 | -->
<!-- |                                       | $\frac{ 1}{\sigma\sqrt{2\pi}} e^{-(x-\mu)^2/2\sigma^2}$| -->
<!-- +---------------------------------------+--------------------------------------------------------+ -->
<!-- : The normal pdf. {#tbl-normal-pdf} -->
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The inflection points of the normal distributions are always at <span class="math inline">\(\mu -\sigma\)</span> and <span class="math inline">\(\mu+\sigma\)</span>.</p>
<p>Among the normal distributions is one special distribution – the <strong>standard normal distribution</strong> – which has mean 0 and standard deviation 1. All other normal distributions are simply linear transformations of the standard normal distribution. That is, If <span class="math inline">\(Z \sim \Norm(0,1)\)</span> and <span class="math inline">\(Y = a + b X\)</span> , then <span class="math inline">\(Y \sim \Norm(a, b)\)</span>. Conversely, if <span class="math inline">\(Y \sim \Norm(\mu,\sigma)\)</span>, then <span class="math inline">\(Z = \frac{Y - \mu}{\sigma} \sim \Norm(0,1)\)</span>.</p>
<p>As with the other distributions we have encountered, we have four functions that allow us to work with normal distributions in R</p>
<div id="tbl-normal-in-R" class="anchored">
<table class="table">
<caption>Table&nbsp;4.4: Normal distributions in R.</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 79%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>What it does</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>dnorm(x, mean = 0, sd = 1)</code></td>
<td>Computes value of the pdf at <code>x</code>.</td>
</tr>
<tr class="even">
<td><code>pnorm(q, mean = 0, sd = 1)</code></td>
<td>Computes value of the cdf at <code>x</code>, i.e., <span class="math inline">\(\Prob(X \le \texttt{q})\)</span>.</td>
</tr>
<tr class="odd">
<td><code>qnorm(p, mean = 0, sd = 1)</code></td>
<td>Computes quantiles, that is a value <span class="math inline">\(q\)</span> so that <span class="math inline">\(\Prob(X \le \texttt{q}) = \texttt{p}\)</span>.</td>
</tr>
<tr class="even">
<td><code>rnorm(n, mean = 0, sd = 1)</code></td>
<td>Randomly samples <code>n</code> values from the <span class="math inline">\(\Norm(\mu, \sigma)\)</span> distribution where <span class="math inline">\(\mu\)</span> = <code>mean</code> and <span class="math inline">\(\sigma\)</span> = <code>sd</code>.</td>
</tr>
</tbody>
</table>
</div>
<section id="the-68-95-99.7-rule" class="level4" data-number="4.4.5.1">
<h4 data-number="4.4.5.1" class="anchored" data-anchor-id="the-68-95-99.7-rule"><span class="header-section-number">4.4.5.1</span> The 68-95-99.7 Rule</h4>
<p>Also known as the “Empirical Rule”, the 68-95-99.7 Rule provides a set of probability benchmarks for the normal distributions because for any normal distribution:</p>
<ul>
<li><span class="math inline">\(\approx 68\)</span>% of the normal distribution is between <span class="math inline">\(\mu - \sigma\)</span> and <span class="math inline">\(\mu + \sigma\)</span>.</li>
<li><span class="math inline">\(\approx 95\)</span>% of the normal distribution is between <span class="math inline">\(\mu - 2\sigma\)</span> and <span class="math inline">\(\mu + 2\sigma\)</span>.</li>
<li><span class="math inline">\(\approx 99.7\)</span>% of the normal distribution is between <span class="math inline">\(\mu - 3\sigma\)</span> and <span class="math inline">\(\mu + 3\sigma\)</span>.</li>
</ul>
<div id="exm-SAT" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.16 </strong></span><strong>Q.</strong> Before they were rescaled, SAT scores used to be approximately normally distributed with a mean of 500 and a standard deviation of 100.</p>
<ol type="1">
<li>Approximately what percent of test takers scored between 400 and 600?</li>
<li>Approximately what percent of test takers scored above 600?</li>
<li>Approximately what percent of test takers scored below 300?</li>
<li>Approximately what percent of test takers scored between 400 and 700?</li>
</ol>
<p><strong>A.</strong></p>
<ol type="1">
<li>68%</li>
<li>Since 68% are between 400 and 600, the other 32% must be outside that range, half above and half below. So 16% are above 600.</li>
<li>Since 95% are between 300 and 700, the other 5% must be outside that range, half above and half below. So 2.5% are below 300.</li>
<li>16% are below 400 and 2.5% are above 700, so the remaining 81.5% must be between 400 and 700.</li>
</ol>
<p>Of course, we can get more accurate results using R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>( <span class="dv">600</span>, <span class="dv">500</span>, <span class="dv">100</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="dv">400</span>, <span class="dv">500</span>, <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6826895</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>( <span class="dv">700</span>, <span class="dv">500</span>, <span class="dv">100</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="dv">300</span>, <span class="dv">500</span>, <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9544997</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>( <span class="dv">300</span>, <span class="dv">500</span>, <span class="dv">100</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02275013</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>( <span class="dv">700</span>, <span class="dv">500</span>, <span class="dv">100</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="dv">400</span>, <span class="dv">500</span>, <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8185946</code></pre>
</div>
</div>
<p>The <code>xpnorm()</code> function will additionally draw pictures of the normal distribution with a portion of the distribution shaded in.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xpnorm</span>(<span class="dv">700</span>,<span class="dv">500</span>,<span class="dv">100</span>) <span class="sc">-</span> <span class="fu">xpnorm</span>(<span class="dv">400</span>, <span class="dv">500</span>, <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>If X ~ N(500, 100), then </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>    P(X &lt;= 700) = P(Z &lt;= 2) = 0.9772</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>    P(X &gt;  700) = P(Z &gt;  2) = 0.02275</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>If X ~ N(500, 100), then </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>    P(X &lt;= 400) = P(Z &lt;= -1) = 0.1587</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>    P(X &gt;  400) = P(Z &gt;  -1) = 0.8413</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="432"></p>
</div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid" width="432"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8185946</code></pre>
</div>
</div>
</div>
<!-- end example -->
<div id="exm-qnorm-SAT" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.17 </strong></span>We can use <code>qnorm()</code> to compute percentiles. For example, let’s calculate the 75th percentile for SAT distributions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(.<span class="dv">75</span>, <span class="dv">500</span>, <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 567.449</code></pre>
</div>
</div>
</div>
<!-- end example -->
</section>
</section>
<section id="beta-distributions" class="level3" data-number="4.4.6">
<h3 data-number="4.4.6" class="anchored" data-anchor-id="beta-distributions"><span class="header-section-number">4.4.6</span> Beta Distributions</h3>
<p>The Beta distributions have support on the interval <span class="math inline">\((0,1)\)</span>, so they can provide a model for proportions or other quantities that are bounded between 0 and 1.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> The Beta distributions have two parameters, imaginatively called <code>shape1</code> and <code>shape2</code>. The kernel of the Beta distributions is a product of a power of <span class="math inline">\(x\)</span> and a power of <span class="math inline">\((1-x)\)</span>: <span class="math display">\[
k(x; \alpha, \beta) = x^{\alpha-1} (1-x)^{\beta -1} \; \boolval{ x \in [0,1] }
\]</span> When <span class="math inline">\(\alpha = \beta\)</span>, the distribution is symmetric, and when <span class="math inline">\(\alpha = \beta =1\)</span>, we have the <span class="math inline">\(\Unif(0,1)\)</span>-distribution.</p>
<p>The two shape parameters provide a wide variety of shapes.</p>
<div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"beta"</span>, <span class="at">params =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="dv">2</span>, <span class="at">shape2 =</span> <span class="dv">2</span>), <span class="at">title =</span> <span class="st">"Beta(2,2)"</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"beta"</span>, <span class="at">params =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="dv">2</span>, <span class="at">shape2 =</span> <span class="fl">0.9</span>), <span class="at">title =</span> <span class="st">"Beta(2,0.9)"</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"beta"</span>, <span class="at">params =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="dv">4</span>, <span class="at">shape2 =</span> <span class="dv">2</span>), <span class="at">title =</span> <span class="st">"Beta(4,2)"</span>)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"beta"</span>, <span class="at">params =</span> <span class="fu">list</span>(<span class="at">shape1 =</span> <span class="fl">0.9</span>, <span class="at">shape2 =</span> <span class="fl">0.85</span>), <span class="at">title =</span> <span class="st">"Beta(0.9,0.85)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-beta-dists" class="cell quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-beta-dists-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04-random-variables_files/figure-html/fig-beta-dists-1.png" class="img-fluid figure-img" data-ref-parent="fig-beta-dists" width="432"></p>
<p></p><figcaption class="figure-caption">(a)</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-beta-dists-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04-random-variables_files/figure-html/fig-beta-dists-2.png" class="img-fluid figure-img" data-ref-parent="fig-beta-dists" width="432"></p>
<p></p><figcaption class="figure-caption">(b)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-beta-dists-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04-random-variables_files/figure-html/fig-beta-dists-3.png" class="img-fluid figure-img" data-ref-parent="fig-beta-dists" width="432"></p>
<p></p><figcaption class="figure-caption">(c)</figcaption><p></p>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-beta-dists-4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="04-random-variables_files/figure-html/fig-beta-dists-4.png" class="img-fluid figure-img" data-ref-parent="fig-beta-dists" width="432"></p>
<p></p><figcaption class="figure-caption">(d)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;4.7: Some example gamma distributions.</figcaption><p></p>
</figure>
</div>
</div>
<table class="table">
<caption>Beta distributions in R</caption>
<colgroup>
<col style="width: 18%">
<col style="width: 81%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>What it does</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>dbeta(x, shape1, shape2)</code></td>
<td>Computes value of the pdf at <code>x</code>.</td>
</tr>
<tr class="even">
<td><code>pbeta(q, shape1, shape2)</code></td>
<td>Computes value of the cdf at <code>x</code>, i.e., <span class="math inline">\(\Prob(X \le \texttt{q})\)</span>.</td>
</tr>
<tr class="odd">
<td><code>qbeta(p, shape1, shape2)</code></td>
<td>Computes quantiles, that is a value <span class="math inline">\(q\)</span> so that <span class="math inline">\(\Prob(X \le \texttt{q}) = \texttt{p}\)</span>.</td>
</tr>
<tr class="even">
<td><code>rbeta(n, shape1, shape2)</code></td>
<td>Randomly samples <code>n</code> values from the <span class="math inline">\(\Beta(\alpha, \beta)\)</span> distribution where <span class="math inline">\(\alpha\)</span> = <code>shape1</code> and <span class="math inline">\(\beta\)</span> = <code>shape2</code>.</td>
</tr>
</tbody>
</table>
</section>
<section id="binomial-distributions" class="level3" data-number="4.4.7">
<h3 data-number="4.4.7" class="anchored" data-anchor-id="binomial-distributions"><span class="header-section-number">4.4.7</span> Binomial Distributions</h3>
<p>A binomial distribution is a discrete distribution with two parameters (<span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span>, or as R calls them <code>size</code> and <code>prob</code> describing a situation in which</p>
<ol type="1">
<li>Our random process consists of <span class="math inline">\(n\)</span> identical sub-processes (called trials).</li>
<li>Each trial has one of two outcomes (traditionally called success and failure).</li>
<li>The probability of success is <span class="math inline">\(p\)</span> for each trial.</li>
<li>The outcome of each trial is independent of the others.</li>
</ol>
<p>The binomial random variable counts the number of successes.</p>
<div id="exm-freethrow-amy" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.18 </strong></span>&nbsp;</p>
<div class="enumerate">
<ol type="a">
<li>If we flip a coin 100 times and let <span class="math inline">\(X\)</span> be the number of heads, then <span class="math inline">\(X \sim \Binom( 100, 0.5)\)</span>.</li>
<li>Amy is a 92% free throw shooter. If she attempts 50 free throws and we let –&gt; <span class="math inline">\(Y\)</span> be the number that she makes, then <span class="math inline">\(Y \sim \Binom(50, 0.92)\)</span> (assuming that each shot is independent of the others.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>)</li>
</ol>
</div>
<!-- end enumerate -->
<p>Here are some example binomial distributions. The distributions are symmetric when <span class="math inline">\(p = 0.5\)</span>. For a fixed size <span class="math inline">\(n\)</span>, the distributions become more and more skewed as <span class="math inline">\(p\)</span> gets closer to 0 or 1. For a fixed probability <span class="math inline">\(p\)</span>, the distributions become more and more symmetric as <span class="math inline">\(n\)</span> gets larger.</p>
<div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"binom"</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.5</span>, <span class="at">title =</span> <span class="st">"Binom(10, 0.5)"</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"binom"</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">prob =</span> <span class="fl">0.05</span>, <span class="at">title =</span> <span class="st">"Binom(10, 0.05)"</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"binom"</span>, <span class="at">size =</span> <span class="dv">100</span>, <span class="at">prob =</span> <span class="fl">0.5</span>, <span class="at">title =</span> <span class="st">"Binom(100, 0.5)"</span>)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"binom"</span>, <span class="at">size =</span> <span class="dv">100</span>, <span class="at">prob =</span> <span class="fl">0.05</span>, <span class="at">title =</span> <span class="st">"Binom(100, 0.05)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="432"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid" width="432"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-25-3.png" class="img-fluid" width="432"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-25-4.png" class="img-fluid" width="432"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p>Some example binomial distributions.</p>
</div>
</div>
</div>
</div>
<p>The pmf for a binomial distribution is given by <span class="math display">\[
f(x) = \binom{n}{x} p^x (1-p)^{n-x}
\]</span> where <span class="math inline">\(\binom{n}{x} = \frac{n!}{x!(n-x)!}\)</span> is the binomial coefficient. As with the continuous distributions, we have our usual functions available.</p>
<table class="table">
<colgroup>
<col style="width: 21%">
<col style="width: 78%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>What it does</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>dbinom(x, size, prob)</code></td>
<td>Computes value of the pmf at <code>x</code>.</td>
</tr>
<tr class="even">
<td><code>pbinom(q, size, prob)</code></td>
<td>Computes value of the cdf at <code>q</code>, i.e., <span class="math inline">\(\Prob(X \le \texttt{q})\)</span>.</td>
</tr>
<tr class="odd">
<td><code>qbinom(p, size, prob)</code></td>
<td>Computes quantiles, that is a value <span class="math inline">\(q\)</span> so that <span class="math inline">\(\Prob(X \le \texttt{q}) = \texttt{p}\)</span>.</td>
</tr>
<tr class="even">
<td><code>rbinom(n, size, prob)</code></td>
<td>Randomly samples <code>n</code> values from the <span class="math inline">\(\Binom(n, \pi)\)</span> distribution where <span class="math inline">\(n\)</span> = <code>size</code> and <span class="math inline">\(\pi\)</span> = <code>prob</code>.</td>
</tr>
</tbody>
</table>
</div>
<!-- end example -->
</section>
<section id="poisson-distributions" class="level3" data-number="4.4.8">
<h3 data-number="4.4.8" class="anchored" data-anchor-id="poisson-distributions"><span class="header-section-number">4.4.8</span> Poisson Distributions</h3>
<p>The Poisson distributions are generally used as models for counting “events” that happen in a specified amount of time or space. If the probability of an event happening at any moment is the same and independent of events happening at other moments, then the count of events in a fixed amount of time will be a Poisson random variable. The Poisson family has one parameter – often denoted <span class="math inline">\(\lambda\)</span> and called the <em>rate parameter</em> – which is the average number of events that happen over the fixed amount of time or space we are observing.</p>
<div id="exm-geiger" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.19 </strong></span>&nbsp;</p>
<div class="enumerate">
<ol type="a">
<li><p>Let <span class="math inline">\(X\)</span> be the number of clicks of a Geiger counter in a 1 second interval. Since each click corresponds to a radioactive decay event which we generally assume occur “at random” but according to some average rate, a Poisson random variable would be a good model for this. The rate parameter would be the average number of decay events per second.</p></li>
<li><p>If you stand on along a busy highway and count the number of red cars that go by in 30 minutes, a Poisson random variable might be a good model. Sometimes you will get bunches of red cars or periods of time with few or no red cars, that is just as a Poisson model predicts.</p></li>
</ol>
</div>
<!-- end enumerate -->
</div>
<!-- end example -->
<p>The Poisson distributions are skewed right, but become less and less skewed as the rate parameter increases. Here are a few example plots.</p>
<div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"pois"</span>, <span class="at">lambda =</span> <span class="dv">1</span>, <span class="at">title =</span> <span class="st">"Pois(1)"</span>)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"pois"</span>, <span class="at">lambda =</span> <span class="dv">5</span>, <span class="at">title =</span> <span class="st">"Pois(5)"</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"pois"</span>, <span class="at">lambda =</span> <span class="dv">15</span>, <span class="at">title =</span> <span class="st">"Pois(15)"</span>)</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dist</span>(<span class="st">"pois"</span>, <span class="at">lambda =</span> <span class="dv">50</span>, <span class="at">title =</span> <span class="st">"Pois(50)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="432"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid" width="432"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-26-3.png" class="img-fluid" width="432"></p>
</div>
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-26-4.png" class="img-fluid" width="432"></p>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p>Some example Poisson distributions.</p>
</div>
</div>
</div>
</div>
<p>The pmf for a <span class="math inline">\(\Pois(\lambda)\)</span> random variable is <span class="math display">\[
f(x) = \frac{ e^{-\lambda} \lambda^x}{x!}
\]</span> and the functions in R for working with Poisson distributions are the following:</p>
<table class="table">
<caption>Poisson distributions in R.</caption>
<colgroup>
<col style="width: 17%">
<col style="width: 82%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>What it does</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>dpois(x, lambda)</code></td>
<td>Computes value of the pmf at <code>x</code>.</td>
</tr>
<tr class="even">
<td><code>ppois(q, lambda)</code></td>
<td>Computes value of the cdf at <code>q</code>, i.e., <span class="math inline">\(\Prob(X \le \texttt{q})\)</span>.</td>
</tr>
<tr class="odd">
<td><code>qpois(p, lambda)</code></td>
<td>Computes quantiles, that is a value <span class="math inline">\(q\)</span> so that <span class="math inline">\(\Prob(X \le \texttt{q}) = \texttt{p}\)</span>.</td>
</tr>
<tr class="even">
<td><code>rpois(n, lambda)</code></td>
<td>Randomly samples <code>n</code> values from the <span class="math inline">\(\Pois(\lambda)\)</span> distribution where <span class="math inline">\(\lambda\)</span> = <code>lambda</code>.</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="fitting-distributions-to-data" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="fitting-distributions-to-data"><span class="header-section-number">4.5</span> Fitting Distributions to Data</h2>
<p>Suppose we think a family of distributions would make a good model for some situation. How do we decide which member of the family to use? The simple answer is that we should choose the one that fits “best.” The trick is deciding what it means to fit well. In fact there is more than one way to measure how well a distribution fits a data set.</p>
<div id="exm-windspeed" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.20 </strong></span>We can use the following code to load a data set that contains three year’s worth of mean hourly wind speeds (mph) in Twin Falls, ID. This kind of data is often used to estimate how much power could be generated from a windmill placed in a given location.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>Wind <span class="ot">&lt;-</span> </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read.csv</span>(<span class="st">"https://rpruim.github.io/Engineering-Statistics/data/stob/TwinfallsWind.csv"</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Wind, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["date"],"name":[1],"type":["chr"],"align":["left"]},{"label":["time"],"name":[2],"type":["chr"],"align":["left"]},{"label":["speed"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1/1/2010","2":"0:00","3":"2.24","_rn_":"1"},{"1":"1/1/2010","2":"1:00","3":"2.42","_rn_":"2"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(Wind, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["date"],"name":[1],"type":["chr"],"align":["left"]},{"label":["time"],"name":[2],"type":["chr"],"align":["left"]},{"label":["speed"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"12/31/2012","2":"22:00","3":"3.88","_rn_":"26272"},{"1":"12/31/2012","2":"23:00","3":"5.04","_rn_":"26273"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>( <span class="sc">~</span> speed, <span class="at">data =</span> Wind, <span class="at">binwidth =</span> <span class="dv">1</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="432"></p>
</div>
</div>
<p>As we can see, the distribution is skewed, but it doesn’t look like an exponential distribution would be a good fit. Of the distributions we have seen, it seems like a Weibull or Gamma distribution would be a potentially good choice. A Weibull model has often been used as a model for mean hourly wind speed, and the shape of our histogram indicates that this is a reasonable family of distributions.</p>
<p><strong>Q.</strong> Which Weibull distribution is the best model for our data?</p>
<p><strong>A.</strong> The <code>fitdistr()</code> in the <strong><code>MASS</code></strong> package uses the method of <strong>maximum likelihood</strong> to fit univariate (one variable) distributions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>( Wind<span class="sc">$</span>speed, <span class="st">"weibull"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in fitdistr(Wind$speed, "weibull"): Weibull values must be &gt; 0</code></pre>
</div>
</div>
<p>For <code>fitdistr()</code> to fit a Weibull distribution, all of the data must be positive, but our data includes some 0’s.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tally</span>( <span class="sc">~</span> (speed <span class="sc">==</span> <span class="dv">0</span>), <span class="at">data =</span> Wind)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(speed == 0)
 TRUE FALSE 
   48 26225 </code></pre>
</div>
</div>
<p>Let’s see how small the smallest non-zero measurements are.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>( <span class="sc">~</span> speed, <span class="at">data =</span> Wind <span class="sc">|&gt;</span> <span class="fu">filter</span>(speed <span class="sc">&gt;</span> <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01</code></pre>
</div>
</div>
<p>This may well be a simple rounding issue, since the wind speeds are recorded to the nearest 0.01 and 0.01 is the smallest positive value. Let’s create a new variable that moves each value of 0 to 0.0025 and try again. Why 0.0025? If we think that 0.01 represents anything in the range 0.005 to 0.015, which would round to 0.01, then 0 represents anything in the range 0 to 0.005.<br>
0.0025 is the middle of that range.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>Wind <span class="ot">&lt;-</span> Wind <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">speed2 =</span> <span class="fu">ifelse</span>( speed <span class="sc">&gt;</span> <span class="dv">0</span>, speed, <span class="fl">0.0025</span>))</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>( Wind<span class="sc">$</span>speed2, <span class="st">"weibull"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      shape         scale   
  1.694422851   6.650586935 
 (0.007957624) (0.025551827)</code></pre>
</div>
</div>
<p>This says that the best fitting (in the sense of maximum likelihood) Weibull distribution is the <span class="math inline">\(\Weibull(1.69, 6.65)\)</span>-distribution.</p>
<p>The <code>gf_histogram()</code> function has an option to overlay the distribution fit by <code>fitdistr()</code> so we can see how good the fit is graphically.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dhistogram</span>( <span class="sc">~</span> speed2, <span class="at">data =</span> Wind) <span class="sc">|&gt;</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_fitdistr</span>( <span class="sc">~</span> speed2, <span class="at">data =</span> Wind, <span class="at">dist =</span> <span class="st">"weibull"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/xhistogram-Wind-1.png" class="img-fluid" width="432"></p>
</div>
</div>
<p>This can be abbreviated a bit:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dhistogram</span>( <span class="sc">~</span> speed2, <span class="at">data =</span> Wind) <span class="sc">|&gt;</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_fitdistr</span>(<span class="at">dist =</span> <span class="st">"weibull"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/xhistogram-Wind-2-1.png" class="img-fluid" width="432"></p>
</div>
</div>
<p><code>gf_fitdistr()</code> is inheriting the formula and data from <code>gf_dhistogram()</code>.</p>
</div>
<!-- end example -->
<div id="exm-windspeed-gamma" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.21 </strong></span>As an alternative, we could fit a Gamma distribution to the wind speed data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(Wind<span class="sc">$</span>speed2, <span class="st">"gamma"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      shape         rate    
  2.495582854   0.421178362 
 (0.020485581) (0.003828652)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dhistogram</span>( <span class="sc">~</span> speed2, <span class="at">data =</span> Wind) <span class="sc">|&gt;</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_fitdistr</span>(<span class="at">dist =</span> <span class="st">"gamma"</span> , <span class="at">color =</span> <span class="sc">~</span> <span class="st">"Gamma"</span>) <span class="sc">|&gt;</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_fitdistr</span>(<span class="at">dist =</span> <span class="st">"weibull"</span> , <span class="at">color =</span> <span class="sc">~</span> <span class="st">"Weibull"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="432"></p>
</div>
</div>
<p>By eye, it appears that the Gamma distribution fits this data set slightly better, but there may be other reasons to prefer the Weibull distribution. In fact, there has been a good deal of research done regarding which distributions to use for wind speed data fitting. The answer to the question of which distributions should be used seems to be that it depends on the purpose for your modeling:<br>
``The fact that different distributions excel under different applications motivates further research on model selection based upon the engineering parameter of interest.” <span class="citation" data-cites="Morgan2011:WindSpeed">Morgan et al. (<a href="references.html#ref-Morgan2011:WindSpeed" role="doc-biblioref">2011</a>)</span></p>
</div>
<!-- end example -->
<div id="exm-jordan" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.22 </strong></span>1986–87 was a good season for Michael Jordan, a famous former NBA basketball player. Possible models for the points scored each game that season are normal, Weibull, and Gamma distributions. The normal distributions might be a good choice if we think that the distributions is roughly symmetric (very good games are about the same amount above average as the very poor games are below average). Weibull and Gamma distributions have the built in feature that scores cannot be negative and would allow for a skewed distribution. The <code>fitdistr()</code> function in the <strong><code>MASS</code></strong> package can fit each of these.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fastR2)     <span class="co"># the Jordan8687 data set is in this package</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(Jordan8687<span class="sc">$</span>points, <span class="st">"normal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      mean          sd    
  37.0853659    9.8639541 
 ( 1.0892915) ( 0.7702454)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(Jordan8687<span class="sc">$</span>points, <span class="st">"weibull"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     shape        scale   
   4.1227692   40.7746012 
 ( 0.3454908) ( 1.1516943)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(Jordan8687<span class="sc">$</span>points, <span class="st">"gamma"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      shape         rate    
  12.42843002    0.33513033 
 ( 1.91535288) ( 0.05270279)</code></pre>
</div>
</div>
<p>We can use a histogram with overlaid density curve to see how well these fits compare to the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dhistogram</span>(<span class="sc">~</span> points, <span class="at">data =</span> Jordan8687, <span class="at">binwidth =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_fitdistr</span>(<span class="at">dist =</span> <span class="st">"norm"</span>, <span class="at">color =</span> <span class="sc">~</span><span class="st">"normal"</span>) <span class="sc">|&gt;</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_fitdistr</span>(<span class="at">dist =</span> <span class="st">"weibull"</span>, <span class="at">color =</span> <span class="sc">~</span> <span class="st">"Weibull"</span>) <span class="sc">|&gt;</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_fitdistr</span>(<span class="at">dist =</span> <span class="st">"gamma"</span>, <span class="at">color =</span> <span class="sc">~</span> <span class="st">"Gamma"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/jordan2-1.png" class="img-fluid" width="432"></p>
</div>
</div>
<p>The three fits are similar, but not identical.</p>
</div>
<!-- end example -->
<section id="maximum-likelihood" class="level3" data-number="4.5.1">
<h3 data-number="4.5.1" class="anchored" data-anchor-id="maximum-likelihood"><span class="header-section-number">4.5.1</span> Maximum Likelihood</h3>
<p>The <code>fitdistr()</code> function uses the maximum likelihood method to estimate distribution parameters. The maximum likelihood method is one of the most commonly used estimation methods in all of statistics because (1) it can be used in a wide range of applications, and (2) the resulting estimators have some some desirable properties. Maximum likelihood estimation tries to choose the parameter values that <em>maximize</em> the <em>likelihood</em> of the observed data.</p>
<p>First, let’s think about the “likelihood” of an individual observed data-point. The likelihood of the data-point is just the probability density function (or probability mass function) for the distribution of interest, evaluated at the value observed in the data. The likelihood gives some indication of how frequently we’d expect to observe this value, but it is <em>not</em> a probability (for one thing, likelihoods can exceed 1). The figure below illustrates that the likelihood of observing a person 80 inches (6 feet, 8 inches) tall, if the person comes from a population whose heights are Normally distributed with a mean of 68 inches and a standard deviation of 6 inches is about 0.009:</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/likelihood-1.png" class="img-fluid" width="432"></p>
</div>
</div>
<p>Given a set of specific parameter values, the likelihood of an entire observed data-set can be calculated by obtaining the value of the likelihood of each observed data-point, and summing these over all the observed data points. Then, we can find the maximum likelihood parameter estimates by trying many candidate parameter values until satisfied that we have found the ones that maximize the likelihood. (The numerical methods used are usually a bit more sophisticated than ``guessing lots of random candidate values”, but we won’t get into the details here. In some cases, it is also possible to write down a mathematical expression for the likelihood of the data given the parameters, and maximize it analytically.)</p>
<p>We’ll illustrate the main ideas of maximum likelihood with a simple example.</p>
<div id="exm-michael-3-dice" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.23 </strong></span>Michael has three dice in his pocket. One is a standard die with six sides, another has four sides, and the third has ten sides. He challenges you to a game. Without showing you which die he is using, Michael is going to roll a die 10 times and report to you how many times the resulting number is a <span class="math inline">\(1\)</span> or a <span class="math inline">\(2\)</span>. Your challenge is to guess which die he is using.</p>
<p><strong>Q.</strong> Michael reports that <span class="math inline">\(3\)</span> of the <span class="math inline">\(10\)</span> rolls resulted in a <span class="math inline">\(1\)</span> or a <span class="math inline">\(2\)</span>. Which die do you think he was using?</p>
<p><strong>A.</strong> The probability of obtaining a <span class="math inline">\(1\)</span> or a <span class="math inline">\(2\)</span> is one of <span class="math inline">\(\frac{1}{2}\)</span>, <span class="math inline">\(\frac13\)</span>, or <span class="math inline">\(\frac15\)</span>, depending on which die is being used. Our data are possible with any of the three dice, but let’s see how likely they are in each case.</p>
<div class="itemize">
<ul>
<li>If <span class="math inline">\(\evProb{roll 1 or 2} = \frac15\)</span>, then the probability of obtaining exactly Micheal’s data is <span class="math display">\[
\left(\frac15\right)^3 \left(\frac45\right)^7  =  0.0016777
\;.
\]</span></li>
</ul>
<p>(Whatever the order, there will be 3 events with probability <span class="math inline">\(1/5\)</span> and 7 with probability <span class="math inline">\(4/5\)</span>. Since the events are independent, we can multiply all of these probabilities.)</p>
<ul>
<li><p>If <span class="math inline">\(\evProb{roll 1 or 2} = \frac13\)</span>, then the probability of obtaining exactly Micheal’s data is <span class="math display">\[
\left(\frac13\right)^3 \left(\frac23\right)^7
=  0.0021677
\;.
\]</span></p></li>
<li><p>If <span class="math inline">\(\evProb{roll 1 or 2} = \frac{1}{2}\)</span>, then the probability of obtaining exactly Micheal’s data is <span class="math display">\[
\left(\frac{1}{2}\right)^3 \left(\frac{1}{2}\right)^7 = 0.0016777
\;.
\]</span></p></li>
</ul>
</div>
<!-- end itemize -->
<p>Of these, the largest likelihood is for the case that <span class="math inline">\(\evProb{roll 1 or 2} = \frac13\)</span>, i.e., for the standard, six-sided die. Our data would be more likely to occur with that die than with either of the other two – it is the maximum likelihood die.</p>
</div>
<!-- end example -->
<p>In general, maximum likelihood calculations are harder because instead of having only 3 choices, there will be infinitely many choices, and instead of having only one parameter, there may be multiple parameters. So techniques from (multi-variable) calculus or numerical approximation methods are often used to maximize the likelihood function. The <code>fitdistr()</code> function uses pre-derived formulas for some distributions and numerical approximation methods for others. In some cases, you will get warning messages about attempts to apply a function to values that don’t make sense (trying to take logs or square roots of negative numbers, zero in the denominator, etc.) as the numerical approximation algorithm explores options in an attempt to find the best fit. The help documentation for <code>fitdistr()</code> explains which distributions it can handle and what method is used for each.</p>
</section>
<section id="the-method-of-moments" class="level3" data-number="4.5.2">
<h3 data-number="4.5.2" class="anchored" data-anchor-id="the-method-of-moments"><span class="header-section-number">4.5.2</span> The method of moments</h3>
<p>An easy (but sometimes fairly crude) way to estimate the parameters of a distribution is the method of moments. You will often see this method used in engineering textbooks, especially if they do not rely on software that implements other methods (like the maximum likelihood method).</p>
<p>The basic idea is to set up a system of equations where we set the mean of the data equal to the mean of the distribution, the variance of the data equal to the variance of the distribution, etc.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<p>To employ this method, we need to know the means and variances of our favorite families of distributions (in terms of the parameters of the distributions). For all of the distributions we have seen, one can work out formulas for the means and variances in terms of the parameters involved. These are listed in <a href="#tbl-distributions">Table&nbsp;<span>4.5</span></a></p>
<div id="exm-windspeed-2" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.24 </strong></span>Let’s return to the wind speeds in <a href="#exm-windspeed">Example&nbsp;<span>4.20</span></a>. The formulas for the mean and variance of a Weibull distribution involve the gamma function <span class="math inline">\(\Gamma()\)</span>, which might be unfamiliar to you. So let’s simplify things.</p>
<p>Theoretical properties and observations of wind speeds at other locations suggest that using a shape parameter of <span class="math inline">\(\alpha = 2\)</span> is often a good choice (but shape does differ from location to location depending on how consistent or variable the wind speeds are). The Weibull distributions with <span class="math inline">\(\alpha = 2\)</span> have a special name, they are called the <strong>Rayleigh</strong> distributions.<br>
So <span class="math inline">\(\Rayleigh(\beta) = \Weibull(\alpha = 2, \beta)\)</span>. In this case, from <a href="#tbl-distributions">Table&nbsp;<span>4.5</span></a>, we see that to calculate the mean we need the value of <span class="math inline">\(\Gamma(1 + \frac{1}{2}) = \Gamma(1.5) = \sqrt{\pi}/2\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gamma</span>(<span class="fl">1.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8862269</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(pi)<span class="sc">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8862269</code></pre>
</div>
</div>
<p>From <a href="#tbl-distributions">Table&nbsp;<span>4.5</span></a> we see that the mean of a <span class="math inline">\(\Rayleigh(\beta)\)</span>-distribution is <span class="math display">\[
\E(X) = \beta \frac{\sqrt{\pi}}{2}
\]</span></p>
<p>Now we can choose our estimate <span class="math inline">\(\hat \beta\)</span> for <span class="math inline">\(\beta\)</span> so that <span class="math display">\[
    \hat \beta \frac{\sqrt{\pi}}{2} = \overline x  ;.
\]</span> That is, <span class="math display">\[
    \hat\beta = \frac{2 \overline x }{\sqrt{\pi}}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>x.bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="sc">~</span>speed, <span class="at">data =</span> Wind) </span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>x.bar</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.925238</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>beta.hat <span class="ot">&lt;-</span> x.bar <span class="sc">*</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(pi)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>beta.hat </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.685915</code></pre>
</div>
</div>
<p>So our method of moments fit for the data is a <span class="math inline">\(\Rayleigh(6.69) = \Weibull(2, 6.69)\)</span></p>
<p>Although the Rayleigh distributions are not as flexible as the Weibull or Gamma distributions, and although maximum likelihood is generally preferred over the method of moments, the method of moments fit of a Rayleigh distribution does have one advantage: it can be computed even if all you know is the mean of some sample data. Sometimes, that is all you can easily get your hands on (because the people who collected the raw data only report numerical summaries). You can find average wind speeds for many locations online, for example here: <a href="http://www.wrcc.dri.edu/htmlfiles/westwind.final.html" class="uri">http://www.wrcc.dri.edu/htmlfiles/westwind.final.html</a></p>
</div>
<!-- end example -->
<div id="exm-mom-2-params" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.25 </strong></span>For distributions with two parameters, we solve a system of two equations with two unknowns. For the normal distributions this is particularly easy since the parameters are the mean and standard deviation, so we get</p>
<p><span class="math display">\[
\begin{aligned}
\hat\mu &amp;= \mean x\\
\hat\sigma^2 &amp;= s_x^2\\
\end{aligned}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>x.bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="sc">~</span>speed, <span class="at">data =</span> Wind); x.bar</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.925238</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="sc">~</span>speed, <span class="at">data =</span> Wind); v</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13.34635</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(v)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.653265</code></pre>
</div>
</div>
<p>So the method of moments suggests a <span class="math inline">\(\Norm(5.93, 3.65)\)</span> distribution. In this case, the method of moments and maximum likelihood methods give the same results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(Wind<span class="sc">$</span>speed, <span class="st">"normal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      mean          sd    
  5.92523770   3.65319577 
 (0.02253814) (0.01593687)</code></pre>
</div>
</div>
<p>But this doesn’t mean that the fit is particularly good. Indeed, a normal distribution is not a good choice for this data. We know that wind speeds can’t be negative and we have other distributions (exponential, Weibull, and Gamma, for example) that are also never negative. So choosing one of those seems like a better idea. The following plot shows, as we expected, that the normal distribution is not a particularly good fit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_histogram</span>(<span class="sc">~</span>speed, <span class="at">data =</span> Wind, <span class="at">fit =</span> <span class="st">"normal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="432"></p>
</div>
</div>
<p>It is important to remember that the best fit using a poor choice for the family of distributions might not be a useful fit.<br>
The choice of distributions is made based on a combination of theoretical considerations, experience from previous data sets, and the quality of the fit for the data set at hand.</p>
</div>
<!-- end example -->
<p>Standard names for parameters that appear in several distributions in <a href="#tbl-distributions">Table&nbsp;<span>4.5</span></a> include (<span class="math inline">\(\lambda\)</span>), (<span class="math inline">\(\alpha\)</span>), and (<span class="math inline">\(\beta\)</span>). In the normal distributions, <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are called <code>mean</code> and in R, and in the uniform distributions, <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are called and . The function <span class="math inline">\(\Gamma(x)\)</span> that appears in the formulas for the Weibull and Beta distributions is a kind of continuous extrapolation from the factorial function. The function will calculate these values in R.”</p>
<div class="cell">
<div class="cell-output-display">
<div id="tbl-distributions" class="anchored">
<table class="table table-sm table-striped">
<caption>Table&nbsp;4.5: Some common (families of) distributions</caption>
<colgroup>
<col style="width: 10%">
<col style="width: 15%">
<col style="width: 35%">
<col style="width: 19%">
<col style="width: 19%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">distribution</th>
<th style="text-align: center;">notation</th>
<th style="text-align: center;">pdf or pmf</th>
<th style="text-align: center;">mean</th>
<th style="text-align: center;">variance</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Uniform</td>
<td style="text-align: center;"><span class="math inline">\(\Unif(a, b)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \frac{1}{b-a}\)</span> for <span class="math inline">\(x in [a, b]\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \frac{b+a}{2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \frac{(b-a)^2}{12}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Standard normal</td>
<td style="text-align: center;"><span class="math inline">\(\Norm(0,1)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \frac{1}{\sqrt{2\pi}} {e^{-\frac{1}{2} z^2}}\)</span></td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Normal</td>
<td style="text-align: center;"><span class="math inline">\(\Norm(\mu,\sigma)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \frac{1}{\sigma\sqrt{2\pi}} \cdot e^{-\frac{1}{2} (\frac{x-\mu} {\sigma})^2}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\mu\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\sigma\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Exponential</td>
<td style="text-align: center;"><span class="math inline">\(\Exp(\lambda)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\lambda e^{-\lambda x}\)</span> for <span class="math inline">\(x &gt; 0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(1/\lambda\)</span></td>
<td style="text-align: center;"><span class="math inline">\(1/\lambda^2\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Gamma</td>
<td style="text-align: center;"><span class="math inline">\(\Gamm(\alpha, \lambda = \frac{1}{\beta})\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \frac{\lambda^\alpha}{\Gamma(\alpha)} x^{\alpha-1} e^{-\lambda x}\)</span> for <span class="math inline">\(x &gt; 0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\alpha/\lambda = \alpha \beta\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\alpha/\lambda^2 = \alpha \beta^2\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Weibull</td>
<td style="text-align: center;"><span class="math inline">\(\Weibull(\alpha,\beta = \frac{1}{\lambda})\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \frac{\alpha}{\beta^\alpha} x^{\alpha-1} e^{-(x/\beta)^\alpha}\)</span> for <span class="math inline">\(x &gt; 0\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\beta \Gamma(1 + \frac1{\alpha})\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\beta^2 \left[ \Gamma(1 + \frac{2}{\alpha}) - \left[ \Gamma(1 + \frac{1}{\alpha}) \right]^2 \right]\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Beta</td>
<td style="text-align: center;"><span class="math inline">\(\Beta(\alpha, \beta)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)} x^{\alpha-1}(1-x)^{\beta-1}\)</span> for <span class="math inline">\(x \in (0,1)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \frac{\alpha}{\alpha + \beta}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \frac{\alpha \beta }{(\alpha + \beta)^2(\alpha + \beta + 1)}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Binomial</td>
<td style="text-align: center;"><span class="math inline">\(\Binom(n, p)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \binom{n}{x} p^x (1-p)^{n-x}\)</span> for integer <span class="math inline">\(x\)</span> with <span class="math inline">\(0 \le x \le n\)</span></td>
<td style="text-align: center;"><span class="math inline">\(np\)</span></td>
<td style="text-align: center;"><span class="math inline">\(np(1-p)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Poisson</td>
<td style="text-align: center;"><span class="math inline">\(\Pois(\lambda)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\displaystyle \frac{e^{-\lambda} \lambda^x} {x!}\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\lambda\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\lambda\)</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>: Some (families of) continuous distributions. {#tbl-distributions}</p>

<!-- \begin{table} -->
<!-- \begin{center} -->
<!-- \small -->
<!-- \begin{tabular}{|p{5mm}p{40mm}p{25mm}p{45mm}|} -->
<!-- \hline -->
<!-- \multicolumn{2}{|l}{\textbf{\sf distribution} } -->
<!-- && -->
<!-- \\ -->
<!--   & \textbf{\sf pdf or pmf}  -->
<!--   & \textbf{\sf mean}  -->
<!--   & \textbf{\sf variance}  -->
<!-- \\[.5mm] \hline -->
<!-- &&& \\[-2mm] -->
<!-- \multicolumn{2}{|l}{  Triangle: $\Tri(a,b,c)$} && \\ -->
<!--   &  -->
<!--   $\displaystyle  -->
<!--     \begin{cases} -->
<!--         \frac{2(x-a)}{(b-a)(c-a)}  &  \mbox{if $x \in [a,c]$} \;,  \\ -->
<!--         \frac{2(b-x)}{(b-a)(b-c)}  &  \mbox{if $x \in [c,b]$} \;,  \\ -->
<!--        0 & \mbox{otherwise} \\ -->
<!--      \end{cases}$ -->
<!--      & $\displaystyle \frac{a + b + c}{3}$  -->
<!--      & $\displaystyle \frac{a^2 + b^2 + c^2 - ab -ac -bc}{18}$ -->
<!--      \\[5.2mm] -->
<!--      \multicolumn{2}{|l}{  Uniform: $\Unif(a,b)$} && \\ -->
<!--   &  -->
<!--   $\displaystyle  -->
<!--     \begin{cases} -->
<!--        \frac{1}{b-a}  &  \mbox{if $x \in [a,b]$} \;,  \\ -->
<!--        0 & \mbox{otherwise} \\ -->
<!--      \end{cases}$ -->
<!--      & $\displaystyle \frac{b+a}{2}$  -->
<!--      & $\displaystyle \frac{(b-a)^2}{12}$ -->
<!--      \\[5.2mm] -->
<!-- \multicolumn{2}{|l}{  Standard normal: $\Norm(0,1)$ } && \\ -->
<!--   &  -->
<!--   $\displaystyle \frac{1}{\sqrt{2\pi}} {e^{-\frac{1}{2} z^2}}$ -->
<!--    & $0$ & $1$ -->
<!-- \\[4.2mm] -->
<!-- \multicolumn{2}{|l}{  Normal: $\Norm(\mu,\sigma)$ } && \\ -->
<!--   & $ -->
<!--     \displaystyle \frac{1}{\sigma\sqrt{2\pi}} \cdot  -->
<!--            e^{-\frac{1}{2} (\frac{x-\mu} -->
<!--            {\sigma})^2}$ -->
<!--    & $\mu$ & $\sigma^2$ -->
<!-- \\[5.2mm] -->
<!-- \multicolumn{2}{|l}{  Exponential: $\Exp(\lambda)$ }  && \\ -->
<!-- %      & $\lambda$ -->
<!--    & $\lambda e^{-\lambda x}$ -->
<!--    & $1/\lambda$ & $1/\lambda^2$ -->
<!-- \\[4.2mm] -->
<!-- \multicolumn{2}{|l}{  Gamma: $\Gamm(\alpha, \lambda = \frac{1}{\beta})$ } && \\ -->
<!-- %      & $\lambda$ -->
<!--    & $\displaystyle \frac{\lambda^\alpha}{\Gamma(\alpha)} x^{\alpha-1} e^{-\lambda x}$ -->
<!--    & $\alpha/\lambda = \alpha \beta$  -->
<!--    & $\alpha/\lambda^2 = \alpha \beta^2$ -->
<!-- \\[4.2mm] -->
<!-- \multicolumn{2}{|l}{Weibull: $\Weibull(\alpha,\beta = \frac{1}{\lambda})$} && \\ -->
<!-- & -->
<!--      $\displaystyle \frac{\alpha}{\beta^\alpha} x^{\alpha-1} e^{-(x/\beta)^\alpha}$ -->
<!--    &  -->
<!--      $\beta \Gamma(1 + \frac1{\alpha})$ -->
<!--    & -->
<!--      $\beta^2 \left[ \Gamma(1 + \frac{2}{\alpha})  -->
<!--      - \left[ \Gamma(1 + \frac{1}{\alpha}) \right]^2 \right] -->
<!--      $  -->
<!-- \\[4.0mm] -->
<!-- \multicolumn{2}{|l}{  Beta: $\Beta(\alpha, \beta)$ } && \\ -->
<!--    &  -->
<!--   $\frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)}  -->
<!--        x^{\alpha-1}(1-x)^{\beta-1}$ -->
<!--    &  -->
<!--      $\displaystyle \frac{\alpha}{\alpha + \beta}$ -->
<!--      & -->
<!--      $\displaystyle \frac{\alpha \beta }{(\alpha + \beta)^2(\alpha + \beta + 1)}$ -->
<!-- \\[4mm] -->
<!-- \hline -->
<!-- \multicolumn{2}{|l}{  Binomial: $\Binom(n, p)$ } && \\ -->
<!--    &  -->
<!--    $\displaystyle \binom{n}{x} p^x (1-p)^{n-x}$ -->
<!--    & -->
<!--    $np$ -->
<!--    & -->
<!--    $np(1-p)$ -->
<!-- \\[4mm] -->
<!-- \multicolumn{2}{|l}{  Poisson: $\Pois(\lambda)$ } && \\ -->
<!--    &  -->
<!--    $\displaystyle \frac{e^{-\lambda} \lambda^x} {x!}$ -->
<!--    & -->
<!--    $\lambda$ -->
<!--    & -->
<!--    $\lambda$ -->
<!-- \\[4mm] -->
<!-- \hline -->
<!-- \end{tabular} -->
<!-- \end{center} -->
<!-- \caption{Some common continuous distributions. -->
<!-- Standard names for parameters that appear in several distributions -->
<!-- include \texttt{rate} ($\lambda$), \texttt{shape} ($\alpha$), and \texttt{scale} ($\beta$). -->
<!-- In the normal distributions, $\mu$ and $\sigma$ are called \texttt{mean} and \texttt{sd} -->
<!-- in \R, and in the uniform distributions, $a$ and $b$ are called \texttt{min} and \texttt{max}. -->
<!-- The function $\Gamma(x)$ that appears in the formulas for the Weibull and Beta -->
<!-- distributions is a kind of continuous extrapolation from the factorial function. -->
<!-- The \texttt{gamma()} function will calculate these values.} -->
<!-- \label{tbl-distributions} -->

<!-- \end{table} -->
</section>
</section>
<section id="quantile-quantile-plots" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="quantile-quantile-plots"><span class="header-section-number">4.6</span> Quantile-Quantile Plots</h2>
<p>To this point we have looked at how well a distribution fits the data by overlaying a density curve on a histogram. While this is instructive, it is not the easiest way to make a graphical comparison between a data set and a theoretical distribution. Our eyes are much better at judging whether something is linear than they are at judging whether shapes have a particular kind of curve. Furthermore, certain optical misperceptions tend to cause people to exaggerate some kinds of differences and underestimate others.</p>
<p>Quantile-quantile plots offer an alternative approach. As the name suggests, the idea is to compare the quantiles of our data to the quantiles of a theoretical distribution. These are then plotted as a scatter plot. Let’s go through those steps with a small data set so we can see all the moving parts, then we’ll learn how to automate the whole process using <code>gf_qq()</code>.</p>
<section id="normal-quantile-plots" class="level3" data-number="4.6.1">
<h3 data-number="4.6.1" class="anchored" data-anchor-id="normal-quantile-plots"><span class="header-section-number">4.6.1</span> Normal-Quantile Plots</h3>
<p>The normal distributions are especially important for statistics, so normal-quantile plots will be our most important example of quantile-quantiles plots. Also, special properties of the normal distributions make normal-quantile plots especially easy and useful. We will illustrate the construction of these plots using a data set containing Michael Jordan’s game by game scoring output from the 1986–87 basketball season.</p>
<div id="exm-jordan-qq" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.26 </strong></span>Let’s begin by forming a randomly selected sample of 10 basketball games.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)              <span class="co"># so you can get the same sample if you like.</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>SmallJordan <span class="ot">&lt;-</span> <span class="fu">sample</span>(Jordan8687, <span class="dv">10</span>)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>SmallJordan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["game"],"name":[1],"type":["int"],"align":["right"]},{"label":["points"],"name":[2],"type":["int"],"align":["right"]},{"label":["orig.id"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"31","2":"27","3":"31","_rn_":"31"},{"1":"79","2":"53","3":"79","_rn_":"79"},{"1":"51","2":"43","3":"51","_rn_":"51"},{"1":"14","2":"40","3":"14","_rn_":"14"},{"1":"67","2":"40","3":"67","_rn_":"67"},{"1":"42","2":"49","3":"42","_rn_":"42"},{"1":"50","2":"33","3":"50","_rn_":"50"},{"1":"43","2":"38","3":"43","_rn_":"43"},{"1":"81","2":"61","3":"81","_rn_":"81"},{"1":"25","2":"43","3":"25","_rn_":"25"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>probs <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="at">by =</span> <span class="fl">0.10</span>)</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>probs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.05 0.15 0.25 0.35 0.45 0.55 0.65 0.75 0.85 0.95</code></pre>
</div>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>observed <span class="ot">&lt;-</span> <span class="fu">sort</span>(SmallJordan<span class="sc">$</span>points)                                    <span class="co"># sorted observations</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>theoretical <span class="ot">&lt;-</span> <span class="fu">qnorm</span>( probs, <span class="at">mean =</span> <span class="fu">mean</span>(observed), <span class="at">sd =</span> <span class="fu">sd</span>(observed) ) <span class="co"># theoretical quantiles</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>QQData <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">observed =</span> observed, <span class="at">theoretical =</span> theoretical)</span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>QQData</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["observed"],"name":[1],"type":["int"],"align":["right"]},{"label":["theoretical"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"27","2":"26.63891"},{"1":"33","2":"32.57980"},{"1":"38","2":"36.11398"},{"1":"40","2":"38.93756"},{"1":"40","2":"41.47299"},{"1":"43","2":"43.92701"},{"1":"43","2":"46.46244"},{"1":"49","2":"49.28602"},{"1":"53","2":"52.82020"},{"1":"61","2":"58.76109"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>If the observed data matched the theoretical quantiles perfectly, a scatter plot would place all the points on the line with slope 1 passing through the origin.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>( observed <span class="sc">~</span> theoretical, <span class="at">data =</span> QQData, <span class="at">title =</span> <span class="st">"Hand made QQ-plot"</span> ) <span class="sc">|&gt;</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_fun</span>( x <span class="sc">~</span> x, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/hand-qqplot-1.png" class="img-fluid" width="432"></p>
</div>
</div>
<p>Even better, we don’t need to know the mean and standard deviation in advance, because all normal distributions are linear transformations of the <span class="math inline">\(\Norm(0,1)\)</span>-distribution. So our standard practice will be to compare our data to the <span class="math inline">\(\Norm(0,1)\)</span>-distribution. If <span class="math inline">\(X \sim \Norm(\mu,\sigma)\)</span>, then <span class="math inline">\(X = \mu + \sigma Z\)</span> where <span class="math inline">\(Z \sim \Norm(0,1)\)</span>, so a plot of <span class="math inline">\(X\)</span> vs.&nbsp;<span class="math inline">\(Z\)</span> will have slope <span class="math inline">\(\sigma\)</span> and intercept <span class="math inline">\(\mu\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>theoretical2 <span class="ot">&lt;-</span> <span class="fu">qnorm</span>( probs, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span> ) <span class="co"># theoretical quantiles from Norm(0,1)</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>QQData2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">observed =</span> observed, <span class="at">theoretical =</span> theoretical2)</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_point</span>(observed <span class="sc">~</span> theoretical, <span class="at">data =</span> QQData2, <span class="at">title =</span> <span class="st">"Hand made QQ-plot"</span>, <span class="at">xlab =</span> <span class="st">"theoretical (z)"</span> ) <span class="sc">|&gt;</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_abline</span>(<span class="at">intercept =</span> <span class="sc">~</span> <span class="fu">mean</span>(SmallJordan<span class="sc">$</span>points), <span class="at">slope =</span> <span class="sc">~</span> <span class="fu">sd</span>(SmallJordan<span class="sc">$</span>points), </span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"navy"</span>, <span class="at">data =</span> <span class="cn">NA</span>) <span class="sc">|&gt;</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_hline</span>(<span class="at">yintercept =</span> <span class="sc">~</span> <span class="fu">mean</span>(SmallJordan<span class="sc">$</span>points), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">|&gt;</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_vline</span>(<span class="at">xintercept =</span> <span class="sc">~</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="432"></p>
</div>
</div>
<p>This whole process is automated by the <code>gf_qq()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_qq</span>( <span class="sc">~</span> points, <span class="at">data =</span> SmallJordan, <span class="at">title =</span> <span class="st">"Sub-sample"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="432"></p>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_qq</span>( <span class="sc">~</span> points, <span class="at">data =</span> Jordan8687, <span class="at">title =</span> <span class="st">"Full data set"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-41-2.png" class="img-fluid" width="432"></p>
</div>
</div>
</div>
<!-- end example -->
</section>
<section id="other-distributions" class="level3" data-number="4.6.2">
<h3 data-number="4.6.2" class="anchored" data-anchor-id="other-distributions"><span class="header-section-number">4.6.2</span> Other distributions</h3>
<p>Working with other distributions is similar, but most families of distributions don’t have a single “master example” to which we can make all comparisons, so we need to pick a particular member of the family (either by fitting or for some theoretical reason).<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p>
<div id="exm-windspeed-qq" class="example theorem example">
<p><span class="theorem-title"><strong>Example 4.27 </strong></span>&nbsp;</p>
<pre><code>Let's build a quantile-quantile plot for our wind speed data comparing 
to normal, gamma and Weibull distributions.</code></pre>
<!-- \iffalse -->
<!--    As in the previous section, we'll begin by creating it manually using  -->
<!--    a small subset of the data and then show how to automate the process  -->
<!--    using \function{gf_qq()}. -->
<!-- <<>>= -->
<!-- SmallWind <- sample(Wind, 10) -->
<!-- SmallWind -->
<!-- @ -->
<!-- Now we need to compute the quantiles of our data and the quantiles of our  -->
<!-- theoretical distribution.  We start by selecting 10 evenly spaces  -->
<!-- proportions. -->
<!-- <<>>= -->
<!-- probs <- seq(0.05, 0.95, by = 0.10) -->
<!-- probs -->
<!-- @ -->
<!-- Now we compute the quantiles for these probabilities using the parameters -->
<!-- we fit previously. -->
<!-- <<tidy = FALSE>>= -->
<!-- y <- qdata( probs, SmallWind$speed2)                     # quantiles from data -->
<!-- x.gamma <- qgamma( probs, shape = 2.496, rate = 0.421 )      # quantiles from Gamma dist -->
<!-- x.weibull <- qweibull( probs, shape = 1.694, scale = 6.651 ) # quantiles from Weibull dist -->
<!-- x.normal <- qnorm( probs, mean = 5.925 , sd = 3.653  )       # quantiles from Normal dist -->
<!-- @ -->
<!-- Finally, we create the scatter plot -->
<!-- <<>>= -->
<!-- gf_point(y ~ x.gamma) -->
<!-- gf_point(y ~ x.weibull) -->
<!-- gf_point(y ~ x.normal) -->
<!-- @ -->
<!-- \fi -->
<p>We can automate this, but we need to tell <code>gf_qq()</code> how to calculate the quantiles.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_qq</span>( <span class="sc">~</span> speed2, <span class="at">data =</span> Wind)  <span class="co"># normal-quantile plot; normal is not a good model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="432"></p>
</div>
</div>
<p>The normal model does not fit well, but both Gamma and Weibull are reasonable models:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(Wind<span class="sc">$</span>speed2, <span class="st">"gamma"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      shape         rate    
  2.495582854   0.421178362 
 (0.020485581) (0.003828652)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(Wind<span class="sc">$</span>speed2, <span class="st">"Weibull"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      shape         scale   
  1.694422851   6.650586935 
 (0.007957624) (0.025551827)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>fittedqgamma <span class="ot">&lt;-</span> <span class="fu">makeFun</span>( <span class="fu">qgamma</span>(p, <span class="at">shape =</span> <span class="fl">2.496</span>, <span class="at">rate =</span> <span class="fl">0.421</span> ) <span class="sc">~</span> p )</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>fittedqweibull <span class="ot">&lt;-</span> <span class="fu">makeFun</span>( <span class="fu">qweibull</span>(p, <span class="at">shape =</span> <span class="fl">1.694</span>, <span class="at">scale =</span> <span class="fl">6.651</span>) <span class="sc">~</span> p ) </span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_qq</span>( <span class="sc">~</span>speed2, <span class="at">data =</span> Wind, <span class="at">distribution =</span> fittedqgamma )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="432"></p>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_qq</span>( <span class="sc">~</span>speed2, <span class="at">data =</span> Wind, <span class="at">distribution =</span> fittedqweibull )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-43-2.png" class="img-fluid" width="432"></p>
</div>
</div>
</div>
<!-- end example -->
<div style="page-break-after: always;"></div>
</section>
</section>
<section id="exercises" class="level2" data-number="4.7">
<h2 data-number="4.7" class="anchored" data-anchor-id="exercises"><span class="header-section-number">4.7</span> Exercises</h2>
<div id="exr-show-pdf" class="problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.1 </strong></span>Let <span class="math inline">\(f(x) = 5/4 - x^3\)</span> on <span class="math inline">\([0,1]\)</span>.</p>
<ol type="1">
<li>Show that <span class="math inline">\(f\)</span> is a pdf.</li>
<li>Calculate <span class="math inline">\(\Prob(X \le\frac{1}{2})\)</span>.</li>
<li>Calculate <span class="math inline">\(\Prob(X \ge\frac{1}{2})\)</span>.</li>
<li>Calculate <span class="math inline">\(\Prob(X = \frac{1}{2})\)</span>.</li>
</ol>
</div>
<!-- end problem -->
<div class="solution proof">
<div class="cell">
<span class="proof-title"><em>Solution</em>. </span>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">makeFun</span>( (<span class="dv">5</span><span class="sc">/</span><span class="dv">4</span> <span class="sc">-</span> x<span class="sc">^</span><span class="dv">3</span>) <span class="sc">*</span> ( <span class="fu">abs</span>(x<span class="fl">-.5</span>) <span class="sc">&lt;=</span> .<span class="dv">5</span> ) <span class="sc">~</span> x )</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotFun</span>(<span class="fu">f</span>(x) <span class="sc">~</span> x, <span class="at">x.lim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">2</span>))  <span class="co"># quick plot to make sure things look correct.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="432"></p>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fu">antiD</span>(<span class="fu">f</span>(x) <span class="sc">~</span>x)  </span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="co"># part a:  f(x) &gt;=0, so we just need to check that the total area is 1</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="fu">F</span>(<span class="dv">1</span>) <span class="sc">-</span> <span class="fu">F</span>(<span class="dv">0</span>) <span class="sc">==</span> <span class="dv">1</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">F</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">F</span>(<span class="dv">0</span>)     <span class="co"># part b</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.609375</code></pre>
</div>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">F</span>(<span class="dv">1</span>) <span class="sc">-</span> <span class="fu">F</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)     <span class="co"># part c</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.390625</code></pre>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">F</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">F</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)   <span class="co"># part d</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</div>
<!-- end solution -->
<div id="exr-triangle-with-geometry" class="problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.2 </strong></span>Repeat parts (2) – (4) of <a href="#exm-triangle-in-R">Example&nbsp;<span>4.13</span></a> using geometry rather than R</p>
</div>
<!-- end problem -->
<div class="solution proof">
<div class="itemize">
<span class="proof-title"><em>Solution</em>. </span>
<ul>
<li><span class="math inline">\(\Prob(X \le 1) = \frac 12 \cdot 1 \cdot \frac{1}{2} = \frac 14\)</span></li>
<li><span class="math inline">\(\Prob(X \le 2) = 1 - \Prob(X \ge 2) = 1 - \frac{1}{2} \cdot 2 \cdot \frac13 = 1 - \frac 13 = \frac23\)</span>.</li>
<li>The median <span class="math inline">\(m\)</span> is a number between 1 and 2 and satisfies <span class="math inline">\(\frac 12 = \Prob(X \ge m) = \frac{1}{2} (4-m) \frac{4-m}{6}\)</span>.<br>
Solving for <span class="math inline">\(m\)</span> we get <span class="math inline">\(m = 4 - \sqrt{6} = 1.5505103\)</span>.</li>
</ul>
</div>
<!-- end itemize -->
</div>
<!-- end solution -->
<div id="exr-pdf-from-kernel" class="problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.3 </strong></span>Let <span class="math display">\[
\displaystyle k(x) = (1 - x^2) \cdot\boolval{ x \in[-1,1] } =
\begin{cases}
        1-x^2 &amp; x \in[-1,1] \\
        0 &amp; \mbox{otherwise}
\end{cases}
\]</span></p>
<p>be the kernel of a continuous distribution.</p>
<div class="enumerate">
<ol type="a">
<li><pre><code>     Determine the pdf for this distribution.</code></pre></li>
<li><pre><code>     Compute the mean and variance for this distribution</code></pre></li>
</ol>
</div>
<!-- end enumerate -->
</div>
<!-- end problem -->
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span></p>
<pre><code>The integrals are easy enough to do by hand, but here is the R code 
to compute them.</code></pre>
<!-- TODO: originally had area as an argument, but changes to mosaicCalc seem to break this -->
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">makeFun</span>( <span class="dv">1</span> <span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span> <span class="sc">~</span> x )</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">antiD</span>( <span class="fu">k</span>(x) <span class="sc">~</span> x )</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>area <span class="ot">&lt;-</span> <span class="fu">K</span>(<span class="dv">1</span>) <span class="sc">-</span> <span class="fu">K</span>(<span class="sc">-</span><span class="dv">1</span>); area </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.333333</code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">makeFun</span>( (<span class="dv">1</span> <span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>area <span class="sc">~</span> x)</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fu">antiD</span>(<span class="fu">f</span>(x) <span class="sc">~</span> x)</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="fu">F</span>(<span class="dv">1</span>) <span class="sc">-</span> <span class="fu">F</span>(<span class="sc">-</span><span class="dv">1</span>)    <span class="co"># this should be 1 if we have done things right</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>G <span class="ot">&lt;-</span> <span class="fu">antiD</span>( x <span class="sc">*</span> <span class="fu">f</span>(x) <span class="sc">~</span> x )</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>H <span class="ot">&lt;-</span> <span class="fu">antiD</span>( x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">f</span>(x) <span class="sc">~</span> x )</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">G</span>(<span class="dv">1</span>) <span class="sc">-</span> <span class="fu">G</span>(<span class="sc">-</span><span class="dv">1</span>); m               <span class="co"># E(X)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">H</span>(<span class="dv">1</span>) <span class="sc">-</span> <span class="fu">H</span>(<span class="sc">-</span><span class="dv">1</span>)                       <span class="co"># E(X^2)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">H</span>(<span class="dv">1</span>) <span class="sc">-</span> <span class="fu">H</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="sc">-</span> m<span class="sc">^</span><span class="dv">2</span>                 <span class="co"># Var(X)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2</code></pre>
</div>
</div>
</div>
<!-- end solution -->
<div id="exr-mean-median-triangle" class="problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.4 </strong></span>Let <span class="math inline">\(Y \sim\Tri(0,10,4)\)</span>. Compute <span class="math inline">\(\E(Y)\)</span> and the median of <span class="math inline">\(Y\)</span>.</p>
</div>
<!-- end problem -->
<div class="solution proof">
<div class="cell">
<span class="proof-title"><em>Solution</em>. </span>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mean:</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">antiD</span>( x <span class="sc">*</span> <span class="fu">dtriangle</span>(x,<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">4</span>) <span class="sc">~</span> x, <span class="at">lower.bound =</span> <span class="dv">0</span>)(<span class="dv">10</span>)</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.666665</code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># variance:</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">antiD</span>( x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">dtriangle</span>(x,<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">4</span>) <span class="sc">~</span> x, <span class="at">lower.bound =</span> <span class="dv">0</span>)(<span class="dv">10</span>) <span class="sc">-</span> m<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.222229</code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># median</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qtriangle</span>( <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">4</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.522774</code></pre>
</div>
</div>
</div>
<!-- end solution -->
<div id="exr-exp-var-unif" class="problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.5 </strong></span>Let <span class="math inline">\(W \sim \Unif(0,10)\)</span>. Compute <span class="math inline">\(\E(W)\)</span> and <span class="math inline">\(\Var(W)\)</span>.</p>
</div>
<!-- end problem -->
<div class="solution proof">
<div class="cell">
<span class="proof-title"><em>Solution</em>. </span>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mean:</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">antiD</span>( x <span class="sc">*</span> <span class="fu">dunif</span>(x,<span class="dv">0</span>,<span class="dv">10</span>) <span class="sc">~</span> x, <span class="at">lower.bound =</span> <span class="dv">0</span>)(<span class="dv">10</span>)</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># variance:</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">antiD</span>( x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">dunif</span>(x,<span class="dv">0</span>,<span class="dv">10</span>) <span class="sc">~</span> x, <span class="at">lower.bound =</span> <span class="dv">0</span>)(<span class="dv">10</span>) <span class="sc">-</span> m<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.333333</code></pre>
</div>
</div>
</div>
<!-- end solution -->
<div id="exr-exp-of-exponential" class="problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.6 </strong></span>&nbsp;</p>
<div class="enumerate">
<ol type="a">
<li>Let <span class="math inline">\(X \sim \Exp(4)\)</span>. Use R to compute <span class="math inline">\(\E(X)\)</span>.</li>
<li>Let <span class="math inline">\(X \sim \Exp(10)\)</span>. Use R to compute <span class="math inline">\(\E(X)\)</span>.</li>
<li>Let <span class="math inline">\(X \sim \Exp(1/5)\)</span>. Use R to compute <span class="math inline">\(\E(X)\)</span>.</li>
<li>What pattern do you notice. Explain in terms of the definition of the exponential distribution why this makes sense.</li>
</ol>
</div>
<!-- end enumerate -->
</div>
<!-- end problem -->
<div class="solution proof">
<div class="cell">
<span class="proof-title"><em>Solution</em>. </span>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">antiD</span>( x <span class="sc">*</span> <span class="fu">dexp</span>(x, <span class="dv">4</span>) <span class="sc">~</span> x, <span class="at">lower.bound =</span> <span class="dv">0</span>)(<span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">antiD</span>( x <span class="sc">*</span> <span class="fu">dexp</span>(x, <span class="dv">10</span>) <span class="sc">~</span> x, <span class="at">lower.bound =</span> <span class="dv">0</span>)(<span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">antiD</span>( x <span class="sc">*</span> <span class="fu">dexp</span>(x, <span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>) <span class="sc">~</span> x, <span class="at">lower.bound =</span> <span class="dv">0</span>)(<span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
</div>
<p>It appears that the mean of an <span class="math inline">\(\Exp(\lambda)\)</span>-distribution is <span class="math inline">\(1/\lambda\)</span>. This makes sense. If events have at a rate of <span class="math inline">\(30\)</span> per hour, we would expect to wait <span class="math inline">\(1/30\)</span> of an hour (on average) for the first event to happen.</p>
</div>
<!-- end solution -->
<div id="exr-plot-pdf-and-compute-mean-var" class="problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.7 </strong></span>Use R to plot the pdf and compute the mean and variance of each of the following distributions.</p>
<div class="enumerate">
<ol type="a">
<li><span class="math inline">\(\Beta(2,3)\)</span></li>
<li><span class="math inline">\(\Beta(20,30)\)</span></li>
<li><span class="math inline">\(\Gamm(\texttt{shape} = 2, \texttt{scale} = 3)\)</span></li>
<li><span class="math inline">\(\Weibull(\texttt{shape} = 2, \texttt{scale} = 3)\)</span></li>
</ol>
</div>
<!-- end enumerate -->
</div>
<!-- end problem -->
<div class="solution proof">
<div class="cell">
<span class="proof-title"><em>Solution</em>. </span>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Beta(2,3)</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">antiD</span>( x <span class="sc">*</span> <span class="fu">dbeta</span>(x,<span class="dv">2</span>,<span class="dv">3</span>) <span class="sc">~</span> x, <span class="at">lower.bound =</span> <span class="dv">0</span>)(<span class="dv">1</span>)</span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="fu">antiD</span>( x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">dbeta</span>(x,<span class="dv">2</span>,<span class="dv">3</span>) <span class="sc">~</span> x, <span class="at">lower.bound =</span> <span class="dv">0</span> )(<span class="dv">1</span>) <span class="sc">-</span> m<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Beta(20,30)</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">antiD</span>( x <span class="sc">*</span> <span class="fu">dbeta</span>(x,<span class="dv">20</span>,<span class="dv">30</span>) <span class="sc">~</span> x, <span class="at">lower.bound =</span> <span class="dv">0</span>)(<span class="dv">1</span>)</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">antiD</span>( x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">dbeta</span>(x,<span class="dv">20</span>,<span class="dv">30</span>) <span class="sc">~</span> x, <span class="at">lower.bound =</span> <span class="dv">0</span> )(<span class="dv">1</span>) <span class="sc">-</span> m<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.004705882</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gamma(2,scale = 3)</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">antiD</span>( x <span class="sc">*</span> <span class="fu">dgamma</span>(x,<span class="dv">2</span>,<span class="at">scale =</span> <span class="dv">3</span>) <span class="sc">~</span> x, <span class="at">lower.bound =</span> <span class="dv">0</span>)(<span class="cn">Inf</span>)</span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">antiD</span>( x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">dgamma</span>(x,<span class="dv">2</span>,<span class="at">scale =</span> <span class="dv">3</span>) <span class="sc">~</span> x, <span class="at">lower.bound =</span> <span class="dv">0</span> )(<span class="cn">Inf</span>) <span class="sc">-</span> m<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 18</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Weibull(2,scale = 3)</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">antiD</span>( x <span class="sc">*</span> <span class="fu">dweibull</span>(x,<span class="dv">2</span>,<span class="at">scale =</span> <span class="dv">3</span>) <span class="sc">~</span> x, <span class="at">lower.bound =</span> <span class="dv">0</span>)(<span class="cn">Inf</span>)</span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.658681</code></pre>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">antiD</span>( x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">dweibull</span>(x,<span class="dv">2</span>,<span class="at">scale =</span> <span class="dv">3</span>) <span class="sc">~</span> x, <span class="at">lower.bound =</span> <span class="dv">0</span> )(<span class="cn">Inf</span>) <span class="sc">-</span> m<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.931417</code></pre>
</div>
</div>
</div>
<!-- end solution -->
<div id="exr-proportion-between" class="problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.8 </strong></span>For each of the following distributions, determine the proportion of the distribution that lies between 0.5 and 1.</p>
<div class="enumerate">
<ol type="a">
<li><span class="math inline">\(\Exp(\texttt{rate} = 2)\)</span></li>
<li><span class="math inline">\(\Beta(\texttt{shape1} = 3, \texttt{shape2} = 2)\)</span></li>
<li><span class="math inline">\(\Norm(\texttt{mean} = 1, \texttt{sd} = 2)\)</span></li>
<li><span class="math inline">\(\Weibull(\texttt{shape} = 2, \texttt{scale} = 1/2)\)</span></li>
<li><span class="math inline">\(\Gamm(\texttt{shape} = 2, \texttt{scale} = 1/2)\)</span></li>
</ol>
</div>
<!-- end enumerate -->
</div>
<!-- end problem -->
<div class="solution proof">
<div class="cell">
<span class="proof-title"><em>Solution</em>. </span>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pexp</span>(<span class="dv">1</span>, <span class="dv">2</span>) <span class="sc">-</span> <span class="fu">pexp</span>(<span class="fl">0.5</span>, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2325442</code></pre>
</div>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbeta</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>) <span class="sc">-</span> <span class="fu">pbeta</span>(<span class="fl">0.5</span>, <span class="dv">3</span>, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6875</code></pre>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09870633</code></pre>
</div>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pweibull</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="at">scale =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">pweibull</span>(<span class="fl">0.5</span>, <span class="dv">2</span>, <span class="at">scale =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3495638</code></pre>
</div>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pgamma</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="at">scale =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)   <span class="sc">-</span> <span class="fu">pgamma</span>(<span class="fl">0.5</span>, <span class="dv">2</span>, <span class="at">scale =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.329753</code></pre>
</div>
</div>
</div>
<!-- end solution -->
<div id="exr-twin-falls" class="problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.9 </strong></span>&nbsp;</p>
<div class="enumerate">
<ol type="a">
<li>Using <a href="#tbl-distributions">Table&nbsp;<span>4.5</span></a> and the method of moments, fit an exponential distribution to the Twin Falls wind speed data.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>Wind <span class="ot">&lt;-</span> </span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read.csv</span>(<span class="st">"https://rpruim.github.io/Engineering-Statistics/data/stob/TwinfallsWind.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What is the estimated value of the rate parameter?</p>
<ol start="2" type="a">
<li><p>Now use <code>fitdistr()</code> to fit an exponential distribution using maximum likelihood.</p></li>
<li><p>How do the two estimates for the rate parameter compare?</p></li>
<li><p>How well does an exponential distribution fit this data?</p></li>
</ol>
</div>
<!-- end enumerate -->
</div>
<!-- end problem -->
<div class="solution proof">
<div class="enumerate">
<span class="proof-title"><em>Solution</em>. </span>
<ol type="a">
<li>The method of moments fit for <span class="math inline">\(\lambda\)</span> comes from solving <span class="math inline">\(\frac{1}{\lambda} = \mean x\)</span> for <span class="math inline">\(\lambda\)</span>, so <span class="math inline">\(\hat \lambda = \frac{1}{\mean x}\)</span></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>lambda.hat <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span> <span class="fu">mean</span>(<span class="sc">~</span>speed, <span class="at">data =</span> Wind)</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>lambda.hat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1687696</code></pre>
</div>
</div>
<ol start="2" type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(Wind<span class="sc">$</span>speed, <span class="st">"exponential"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      rate    
  0.168769601 
 (0.001041213)</code></pre>
</div>
</div>
<ol start="3" type="a">
<li><p>They are the same in this case.</p></li>
<li><p>This fit is not that great.</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dhistogram</span>(<span class="sc">~</span>speed, <span class="at">data =</span> Wind, <span class="at">fit =</span> <span class="st">"exponential"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="432"></p>
</div>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_qq</span>( <span class="sc">~</span> speed, <span class="at">data =</span> Wind, <span class="at">distribution =</span> qexp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-57-2.png" class="img-fluid" width="432"></p>
</div>
</div>
</div>
<!-- end enumerate -->
</div>
<!-- end solution -->
<div id="exr-gamma-mom" class="problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.10 </strong></span>&nbsp;</p>
<pre><code>A Gamma distribution can also be fit using the method of moments.
Because there are two parameters (shape and rate or shape and scale),
you will need to solve a system of two equations with two unknowns.</code></pre>
<div class="enumerate">
<ol type="a">
<li>Using <a href="#tbl-distributions">Table&nbsp;<span>4.5</span></a> and the method of moments, fit a Gamma distribution to the Twin Falls wind speed data. What are the estimated values of the shape and rate parameters?</li>
<li>How do the method of moments estimates for the parameters compare to the maximum likelihood estimates from <code>fitdistr()</code>?</li>
</ol>
</div>
<!-- end enumerate -->
</div>
<!-- end problem -->
<div class="solution proof">
<div class="cell">
<span class="proof-title"><em>Solution</em>. </span>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>Wind <span class="ot">&lt;-</span> Wind <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">speed2 =</span> <span class="fu">ifelse</span>( speed <span class="sc">&gt;</span> <span class="dv">0</span>, speed, <span class="fl">0.0025</span>))</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="sc">~</span>speed2, <span class="at">data =</span> Wind); m</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.925242</code></pre>
</div>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">var</span>(<span class="sc">~</span>speed2, <span class="at">data =</span> Wind); v</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13.34629</code></pre>
</div>
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(Wind<span class="sc">$</span>speed2, <span class="st">"gamma"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      shape         rate    
  2.495582854   0.421178362 
 (0.020485581) (0.003828652)</code></pre>
</div>
</div>
<p>Now we solve</p>
<p><span class="math display">\[
\begin{aligned}
\alpha \beta &amp; = \mean x  = 5.9252423
\\
\alpha \beta^2 &amp; = s^2 = 13.3462932
\end{aligned}
\]</span></p>
<p>Dividing the second by the first gives <span class="math inline">\(\hat \beta = \sfrac{s^2}{\mean x}\)</span>. From this we obtain <span class="math inline">\(\hat \alpha = \mean{x} / \hat \beta = \sfrac{ \mean x^2}{s^2}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>beta.hat <span class="ot">&lt;-</span> v<span class="sc">/</span>m; beta.hat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.252447</code></pre>
</div>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>alpha.hat <span class="ot">&lt;-</span> m <span class="sc">/</span> beta.hat ; alpha.hat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.63058</code></pre>
</div>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>lambda.hat <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span> beta.hat ; lambda.hat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4439616</code></pre>
</div>
</div>
<p>The fitted values are similar to but not identical to the maximum likelihood estimates.</p>
</div>
<!-- end solution -->
<div id="exr-windspeed-sam" class="problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.11 </strong></span>Sam has found some information about wind speed at a location he is interested in online. Unfortunately, the web site only provides the mean and standard deviation of wind speed.</p>
<div class="center">
<table class="table">
<colgroup>
<col style="width: 30%">
<col style="width: 15%">
</colgroup>
<tbody>
<tr class="odd">
<td>mean:</td>
<td>10.2 mph</td>
</tr>
<tr class="even">
<td>standard deviation:</td>
<td>5.1 mph</td>
</tr>
</tbody>
</table>
</div>
<!-- end center -->
<div class="enumerate">
<ol type="a">
<li>Use this information and the method of moments to estimate the shape and rate parameters of a Gamma distribution.</li>
<li>In principal, we could do the same for a Weibull distribution, but the formulas aren’t as easy to work with. Fit a Rayleigh distribution instead (i.e., a Weibull distribution with shape parameter equal to 2).</li>
</ol>
</div>
<!-- end enumerate -->
</div>
<!-- end problem -->
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>We can recycle some work from the previous problem to quickly obtain the method of moments fit for the Gamma distribution:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">10.2</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fl">5.1</span><span class="sc">^</span><span class="dv">2</span> </span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a>beta.hat <span class="ot">&lt;-</span> v<span class="sc">/</span>m; beta.hat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.55</code></pre>
</div>
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>alpha.hat <span class="ot">&lt;-</span> m <span class="sc">/</span> beta.hat ; alpha.hat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>lambda.hat <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span> beta.hat ; lambda.hat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3921569</code></pre>
</div>
</div>
<p>For the Rayleigh distribution we solve <span class="math inline">\(\hat \beta \frac{\sqrt{\pi}}{2} = \mean x\)</span> for <span class="math inline">\(\hat \beta\)</span> and get <span class="math display">\[
    \hat\beta = \frac{2 \mean x }{\sqrt{\pi}}
    = \frac{2 \cdot 10.2 }{\sqrt{\pi}}
    = 11.5094675
\]</span></p>
</div>
<!-- end solution -->
<div id="exr-iq" class="problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.12 </strong></span>In 1964, a study was undertaken to see if IQ at 3 years of age is associated with amount of crying at newborn age. In the study, 38 newborns were made to cry after being tapped on the foot, and the number of distinct cry vocalizations within 20 seconds was counted. The subjects were followed up at 3 years of age and their IQs were measured. <!--    The data from this study are in the `Baby` data frame.   --> You can load this data using</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a>Baby <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://rpruim.github.io/Engineering-Statistics/data/BabyCryIQ.csv"</span>)</span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Baby)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["cry.count"],"name":[1],"type":["int"],"align":["right"]},{"label":["IQ"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"10","2":"87","_rn_":"1"},{"1":"20","2":"90","_rn_":"2"},{"1":"17","2":"94","_rn_":"3"},{"1":"12","2":"94","_rn_":"4"},{"1":"12","2":"97","_rn_":"5"},{"1":"15","2":"100","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<pre><code>The `cry.count` variable records the number of distinct cry vocalizations 
within 20 seconds.  Choose a family of distributions to fit to this data
and do the fit using `fitdistr()`. Also include a plot showing 
a histogram and your fitted density curve.</code></pre>
</div>
<!-- end problem -->
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span></p>
<pre><code>The distribution is skewed and non-negative, so a gamma or Weibull seems like 
a good thing to try.  </code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(Baby<span class="sc">$</span>cry.count, <span class="st">"gamma"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     shape         rate   
  12.6338200    0.7329544 
 ( 2.8608824) ( 0.1693120)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(Baby<span class="sc">$</span>cry.count, <span class="st">"Weibull"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     shape        scale   
   3.5842275   19.1020465 
 ( 0.4245079) ( 0.9177923)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dhistogram</span>( <span class="sc">~</span> cry.count, <span class="at">data =</span> Baby, <span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_fitdistr</span>( <span class="sc">~</span> cry.count, <span class="at">data =</span> Baby, <span class="st">"gamma"</span>, <span class="at">title =</span> <span class="st">"Gamma"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid" width="432"></p>
</div>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dhistogram</span>(<span class="sc">~</span>cry.count, <span class="at">data =</span> Baby, <span class="at">title =</span> <span class="st">"Weibull"</span>) <span class="sc">|&gt;</span></span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gf_fitdistr</span>(<span class="sc">~</span> cry.count, <span class="at">data =</span> Baby, <span class="st">"weibull"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-61-2.png" class="img-fluid" width="432"></p>
</div>
</div>
</div>
<!-- end solution -->
<!-- \iffalse -->
<!-- \begin{problem} -->
<!--    For each of the following, give a family of distributions -->
<!--    that might make a reasonable model and say briefly why you chose that family -->
<!--    \begin{enumerate} -->
<!--        \item -->
<!--            Batting averages of MIAA base ball players.  (A batting average is roughly -->
<!--            the proportion of at bats where the batter gets a hit.) -->
<!--    \end{enumerate} -->
<!-- \end{problem} -->
<!-- \fi -->
<div id="exr-HELPrct-substance-qq" class="problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.13 </strong></span>Create normal quantile plots for the ages of patients in the <code>HELPrct</code> data set separated by <code>substance</code>. (Getting separate or overlaid plots using <code>gf_qq()</code> works just like it does for other <strong><code>ggformula</code></strong> plots).</p>
<pre><code>Comment on the plots.</code></pre>
<div style="page-break-after: always;"></div>
</div>
<!-- end problem -->
<div class="solution proof">
<div class="cell">
<span class="proof-title"><em>Solution</em>. </span>
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_qq</span>( <span class="sc">~</span> age <span class="sc">|</span> substance, <span class="at">data =</span> HELPrct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" width="432"></p>
</div>
</div>
<p>The qq-plot for the alcohol group looks good. The other two (especially cocaine) show signs of skew – indicated by the curve to the qq plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gf_dens</span>( <span class="sc">~</span> age <span class="sc">|</span> substance, <span class="at">data =</span> HELPrct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="432"></p>
</div>
</div>
</div>
<!-- end solution -->
<div id="exr-qq-matching" class="problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.14 </strong></span>Match the normal-quantile plots to the histograms.</p>
<div class="cell">

</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/compareplots1-1.png" class="img-fluid" width="432"></p>
</div>
<div class="cell-output-display">
<p><img src="04-random-variables_files/figure-html/compareplots1-2.png" class="img-fluid" width="432"></p>
</div>
</div>
</div>
<!-- end problem -->
<div class="solution proof">
<ol type="a">
<li><span class="proof-title"><em>Solution</em>. </span></li>
<li>Y b) V c) Z d) W e) X f) U</li>
</ol>
</div>
<!-- end solution -->
<div id="exr-var-shortcut" class="problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.15 </strong></span>Show that <span class="math inline">\(\Var(X) = \E(X^2) - \E(X)^2\)</span> by showing that <span class="math display">\[
    \int_{-\infty}^{\infty} (x - \mu_X) ^2 f(x) \; dx
    =
    \int_{-\infty}^{\infty} x^2 f(x) \; dx  -  \mu_X^2
\]</span> whenever <span class="math inline">\(f\)</span> is a pdf and all the integrals involved converge.</p>
</div>
<!-- end problem -->
<div class="solution proof">
<p><span class="proof-title"><em>Solution</em>. </span>Some algebra and properties of integrals are all we need:</p>
<p><span class="math display">\[
\begin{aligned}
\int_{-\infty}^{\infty} (x - \mu_X) ^2 f(x) \; dx
    &amp;=
    \int_{-\infty}^{\infty} (x^2 - 2\mu_X x + \mu_X^2) f(x) \; dx
    \\
    &amp;=
    \int_{-\infty}^{\infty} x^2 f(x) \; dx
    - 2 \mu_X \int_{-\infty}^{\infty} x f(x) \; dx
    + \mu_X^2 \int_{-\infty}^{\infty} f(x) \; dx
    \\
    &amp;=
    \Var(X) - 2 \mu_X^2 + \mu_X^2
    \\
    &amp;=
    \Var(X) - \E(X)^2
\end{aligned}
\]</span></p>
</div>
<!-- end solution -->
<div id="exr-heights" class="problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.16 </strong></span>The heights of 18–22 year olds in the US follow approximately normal distributions within each sex. Estimated means and standard deviations appear in the table below.</p>
<div class="center">
<table class="table">
<colgroup>
<col style="width: 18%">
<col style="width: 23%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th rowspan="2"></th>
<th rowspan="2">mean</th>
<th rowspan="2">standard deviation.</th>
</tr>
<tr class="odd">
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2">women</td>
<td rowspan="2">64.3 in</td>
<td rowspan="2">2.6 in</td>
</tr>
<tr class="even">
</tr>
<tr class="odd">
<td rowspan="2">men</td>
<td rowspan="2">70.0 in</td>
<td rowspan="2">2.8 in</td>
</tr>
<tr class="even">
</tr>
</tbody>
</table>
</div>
<p>Answer the following questions without using a computer or calculator (except for basic arithmetic).</p>
<div class="enumerate">
<ol type="a">
<li>If a woman is 68 inches tall, what is her z-score?</li>
<li>If a man is 74 inches tall, what is his z-score?</li>
<li>What is more unusual, a woman who is at least 68 inches tall or a man who is at least 74 inches tall?</li>
<li>Big Joe has decided to open a club for tall people. To join his club, you must be in the tallest 2.5% of people of your sex. How tall must a woman be to join Big Joe’s club?</li>
<li>How tall must a man be to join Big Joe’s club?</li>
</ol>
</div>
<!-- end enumerate -->
</div>
<!-- end problem -->
<div class="solution proof">
<div class="enumerate">
<span class="proof-title"><em>Solution</em>. </span>
<ol type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">68</span> <span class="sc">-</span> <span class="fl">64.3</span>)<span class="sc">/</span><span class="fl">2.6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.423077</code></pre>
</div>
</div>
<ol start="2" type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">74</span> <span class="sc">-</span> <span class="dv">70</span>) <span class="sc">/</span> <span class="fl">2.8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.428571</code></pre>
</div>
</div>
<ol start="3" type="a">
<li><p>It’s pretty close, but the z-score for the man is slightly larger, so it is slightly more unusual for a man to be that tall.</p></li>
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="fl">64.3</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fl">2.6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 69.5</code></pre>
</div>
</div>
<ol start="5" type="a">
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="dv">70</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fl">2.8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 75.6</code></pre>
</div>
</div>
</div>
<!-- end enumerate -->
</div>
<!-- end solution -->
<div id="exr-heights-more" class="problem theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.17 </strong></span>Use the information from <a href="#exr-heights">Exercise&nbsp;<span>4.16</span></a> to answer the following questions.</p>
<div class="enumerate">
<ol type="a">
<li>What proportion of women are 5’10” or taller?</li>
<li>What proportion of men are 6’4” or taller?</li>
<li>If a man is in the 75th percentile for height, how tall is he?</li>
<li>If a woman is in the 30th percentile for height, how tall is she?</li>
</ol>
</div>
<!-- end enumerate -->
</div>
<!-- end problem -->
<div class="solution proof">
<div class="enumerate">
<span class="proof-title"><em>Solution</em>. </span>
<ol>
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="dv">70</span>, <span class="at">mean =</span> <span class="fl">64.3</span>, <span class="at">sd =</span> <span class="fl">2.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01417865</code></pre>
</div>
</div>
<ol>
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="dv">76</span>, <span class="at">mean =</span> <span class="dv">70</span>, <span class="at">sd =</span> <span class="fl">2.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01606229</code></pre>
</div>
</div>
<ol>
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(.<span class="dv">75</span>, <span class="at">mean =</span> <span class="dv">70</span>, <span class="at">sd =</span> <span class="fl">2.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 71.88857</code></pre>
</div>
</div>
<ol>
<li></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb273"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(.<span class="dv">30</span>, <span class="at">mean =</span> <span class="fl">64.3</span>, <span class="at">sd =</span> <span class="fl">2.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 62.93656</code></pre>
</div>
</div>
</div>
<!-- end enumerate -->
</div>
<!-- end solution -->


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography" style="display: none">
<div id="ref-Morgan2011:WindSpeed" class="csl-entry" role="doc-biblioentry">
Morgan, Eugene C., Matthew Lackner, Richard M. Vogel, and Laurie G. Baise. 2011. <span>“Probability Distributions for Offshore Wind Speeds.”</span> <em>Energy Conversion and Management</em> 52 (1): 15–26. <a href="https://doi.org/10.1016/j.enconman.2010.06.015">https://doi.org/10.1016/j.enconman.2010.06.015</a>.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>There are important examples of random variables that are neither discrete nor continuous.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>R cleverly turns TRUE and FALSE into 1 and 0 when you use them in arithmetic expressions. The definition of <code>f()</code> makes use of this conversion to simplify specifying the cases.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Actually, we will require that <span class="math inline">\(\int_{\infty}^{\infty} |x| f(x) \; dx\)</span> converges.<br>
If this integral fails to converge, we will also say that the distribution has no mean.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Actually, we will require that <span class="math inline">\(\int_{\infty}^{\infty} |x| f(x) \; dx\)</span> converges and<br>
<span class="math inline">\(\int_{\infty}^{\infty} |x|^2 f(x) \; dx\)</span> converges.<br>
If these integrals (or the corresponding sums for discrete random variables) fail to converge, we will say that the distribution has no mean (or variance).<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>A more general version of the Beta distributions can do the same thing for quantities bounded by any two numbers. This more general family of distributions has four parameters.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Whether an individual shooter’s shots are independent or exhibit longer runs of “hot” and “cold” streaks that we would expect under independence has been investigated by many people. The general conclusion seems to be that the independence assumption matches reality pretty closely.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>If our distribution has more than 2 parameters, we will need higher moments, which we will not cover here.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>There are a few other families of distributions that have a prototypical member such that all other members are a linear transformation of the prototype. The exponential family is one such family.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03-probability.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Probability</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05-transformations.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Transformation and Combinations of Random Variables</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>